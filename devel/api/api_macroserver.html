

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>MacroServer API reference &mdash; sardana 3.0.2-alpha documentation</title>
  

  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  

  

  
        <link rel="index" title="Index"
              href="../../genindex.html"/>
        <link rel="search" title="Search" href="../../search.html"/>
    <link rel="top" title="sardana 3.0.2-alpha documentation" href="../../index.html"/>
        <link rel="up" title="Sardana API" href="api_sardana.html"/>
        <link rel="next" title="Pool API reference" href="api_pool.html"/>
        <link rel="prev" title="Measurement group API reference" href="api_measurementgroup.html"/> 

  
  <script src="../../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../../index.html" class="icon icon-home"> sardana
          

          
            
            <img src="../../_static/logo.png" class="logo" />
          
          </a>

          
            
            
              <div class="version">
                3.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
                <ul class="current">
<li class="toctree-l1"><a class="reference external" href="http://www.sardana-controls.org">Home Page</a></li>
<li class="toctree-l1"><a class="reference external" href="https://github.com/sardana-org/sardana">Project Page</a></li>
<li class="toctree-l1"><a class="reference external" href="http://pypi.python.org/pypi/sardana">Download from PyPI</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../../docs.html">Documentation</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../../users/index.html">User&#8217;s Guide</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../index.html">Developer&#8217;s Guide</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="../overview/index.html">Overview</a></li>
<li class="toctree-l3"><a class="reference internal" href="../howto_macros/index.html">Writing macros</a></li>
<li class="toctree-l3"><a class="reference internal" href="../howto_controllers/index.html">Writing controllers</a></li>
<li class="toctree-l3"><a class="reference internal" href="../howto_recorders.html">Writing recorders</a></li>
<li class="toctree-l3"><a class="reference internal" href="../howto_test/index.html">Sardana Testing</a></li>
<li class="toctree-l3 current"><a class="reference internal" href="api_sardana.html">API</a><ul class="current">
<li class="toctree-l4"><a class="reference internal" href="api_macro.html">Macro API</a></li>
<li class="toctree-l4"><a class="reference internal" href="api_controller.html">Controller API</a></li>
<li class="toctree-l4"><a class="reference internal" href="api_motor.html">Motor API</a></li>
<li class="toctree-l4"><a class="reference internal" href="api_IOR.html">I/O register</a></li>
<li class="toctree-l4"><a class="reference internal" href="api_countertimer.html">Counter/timer API</a></li>
<li class="toctree-l4"><a class="reference internal" href="api_0D.html">0D experiment channel API</a></li>
<li class="toctree-l4"><a class="reference internal" href="api_1D.html">1D experiment channel API</a></li>
<li class="toctree-l4"><a class="reference internal" href="api_2D.html">2D experiment channel API</a></li>
<li class="toctree-l4"><a class="reference internal" href="api_triggergate.html">Trigger/gate API</a></li>
<li class="toctree-l4"><a class="reference internal" href="api_pseudomotor.html">Pseudo motor API</a></li>
<li class="toctree-l4"><a class="reference internal" href="api_pseudocounter.html">Pseudo counter API</a></li>
<li class="toctree-l4"><a class="reference internal" href="api_measurementgroup.html">Measurement group API</a></li>
<li class="toctree-l4 current"><a class="current reference internal" href="#">MacroServer API</a></li>
<li class="toctree-l4"><a class="reference internal" href="api_pool.html">Pool API</a></li>
<li class="toctree-l4"><a class="reference internal" href="sardana/sardana.html">Library</a></li>
<li class="toctree-l4"><a class="reference internal" href="api_test.html">Test API</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../guide_migration.html">Migration guide</a></li>
<li class="toctree-l3"><a class="reference internal" href="../examples/examples.html">Examples</a></li>
<li class="toctree-l3"><a class="reference internal" href="../guide_coding.html">Development guidelines</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../sep/index.html">Sardana Enhancement Proposals</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../glossary.html">Glossary</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../other_versions.html">Docs for other Sardana versions</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference external" href="http://github.com/sardana-org/sardana-plugins">Plugins Catalogue</a></li>
<li class="toctree-l1"><a class="reference external" href="http://github.com/sardana-org/sardana/wiki">Wiki</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../../index.html">sardana</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          

 



<div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../../index.html">Docs</a> &raquo;</li>
      
          <li><a href="../../docs.html">Sardana 3.0 Documentation</a> &raquo;</li>
      
          <li><a href="../index.html">Developer&#8217;s Guide</a> &raquo;</li>
      
          <li><a href="api_sardana.html">Sardana API</a> &raquo;</li>
      
    <li>MacroServer API reference</li>
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="../../_sources/devel/api/api_macroserver.txt" rel="nofollow"> View page source</a>
          
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="macroserver-api-reference">
<span id="sardana-macroserver-api"></span><h1>MacroServer API reference<a class="headerlink" href="#macroserver-api-reference" title="Permalink to this headline">¶</a></h1>
<p>The MacroServer is one of the most important elements in sardana.</p>
<p>This chapter explains the generic macroserver <a class="reference internal" href="../../glossary.html#term-api"><span class="xref std std-term">API</span></a> in the context of
sardana. In sardana there are, in fact, two MacroServer <a class="reference internal" href="../../glossary.html#term-api"><span class="xref std std-term">API</span></a>s. To
better explain why, let&#8217;s consider the case were sardana server is running
as a Sardana Tango device server:</p>
<p>Every macroserver in sardana is represented in the sardana kernel as a
<a class="reference internal" href="sardana/macroserver/macroserver.html#sardana.macroserver.macroserver.MacroServer" title="sardana.macroserver.macroserver.MacroServer"><code class="xref py py-class docutils literal"><span class="pre">MacroServer</span></code></a>. The <a class="reference internal" href="sardana/macroserver/macroserver.html#sardana.macroserver.macroserver.MacroServer" title="sardana.macroserver.macroserver.MacroServer"><code class="xref py py-class docutils literal"><span class="pre">MacroServer</span></code></a> <a class="reference internal" href="../../glossary.html#term-api"><span class="xref std std-term">API</span></a> is not directly
accessible from outside the sardana server. This is a low level <a class="reference internal" href="../../glossary.html#term-api"><span class="xref std std-term">API</span></a>
that is only accessible to someone writing a server extension to sardana. At
the time of writing, the only available sardana server extension is Tango.</p>
<p>The second macroserver interface consists on the one provided by the server
extension, which is in this case the one provided by the Tango macroserver
device interface:
<a class="reference internal" href="sardana/tango/macroserver/MacroServer.html#sardana.tango.macroserver.MacroServer.MacroServer" title="sardana.tango.macroserver.MacroServer.MacroServer"><code class="xref py py-class docutils literal"><span class="pre">MacroServer</span></code></a>. The Tango
macroserver interface tries to mimic the as closely as possible the
<a class="reference internal" href="sardana/macroserver/macroserver.html#sardana.macroserver.macroserver.MacroServer" title="sardana.macroserver.macroserver.MacroServer"><code class="xref py py-class docutils literal"><span class="pre">MacroServer</span></code></a> <a class="reference internal" href="../../glossary.html#term-api"><span class="xref std std-term">API</span></a>.</p>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<dl class="last docutils">
<dt><a class="reference internal" href="../overview/overview_macroserver.html#sardana-macroserver-overview"><span class="std std-ref">Macro Server overview</span></a></dt>
<dd>the macroserver overview</dd>
<dt><a class="reference internal" href="sardana/tango/macroserver/MacroServer.html#sardana.tango.macroserver.MacroServer.MacroServer" title="sardana.tango.macroserver.MacroServer.MacroServer"><code class="xref py py-class docutils literal"><span class="pre">MacroServer</span></code></a></dt>
<dd>the macroserver tango device <a class="reference internal" href="../../glossary.html#term-api"><span class="xref std std-term">API</span></a></dd>
</dl>
</div>
<p>Each macroserver has the following attributes:</p>
<div class="section" id="pool-names">
<span id="sardana-macroserver-api-poolnames"></span><h2>pool names<a class="headerlink" href="#pool-names" title="Permalink to this headline">¶</a></h2>
<blockquote>
<div>MacroServer may connect to none, one or many Device Pools. The advantage
of connecting to device pools is the native access to the pool elements
e.g. motors, experimental channels, etc. and their possible use in the
macros. Most of the standard macros, for example scans, wants to
interface with them. MacroServer listens to the device pool elements
events so it is aware of new, modified and deleted elements.</div></blockquote>
</div>
<div class="section" id="environment-db">
<span id="sardana-macroserver-api-environmentdb"></span><h2>environment db<a class="headerlink" href="#environment-db" title="Permalink to this headline">¶</a></h2>
<blockquote>
<div><p>Macro environment is stored in an external database. Currently it is
implemented using the Python
<a class="reference external" href="https://docs.python.org/2.7/library/shelve.html#module-shelve">shelve</a>
module. The shelve file is stored on the file system and by default it
points to the OS temporary directory e.g. <code class="docutils literal"><span class="pre">/tmp</span></code> in case of Linux
which may be transitory. It is highly recommended to change this location.</p>
<p>Default value: <code class="docutils literal"><span class="pre">/tmp/tango/&lt;ds_exec_name&gt;/&lt;ds_inst_name&gt;/macroserver.properties</span></code></p>
</div></blockquote>
</div>
<div class="section" id="macro-path">
<span id="sardana-macroserver-api-macropath"></span><h2>macro path<a class="headerlink" href="#macro-path" title="Permalink to this headline">¶</a></h2>
<blockquote>
<div>MacroServer may load user macros and this are discoverable by scanning the
file system directories configured in macro path.</div></blockquote>
</div>
<div class="section" id="recorder-path">
<span id="sardana-macroserver-api-recorderpath"></span><h2>recorder path<a class="headerlink" href="#recorder-path" title="Permalink to this headline">¶</a></h2>
<blockquote>
<div>MacroServer may load user recorders and this are discoverable by scanning
the file system directories configured in recorder path.</div></blockquote>
</div>
<div class="section" id="python-path">
<span id="sardana-macroserver-api-pythonpath"></span><h2>python path<a class="headerlink" href="#python-path" title="Permalink to this headline">¶</a></h2>
<blockquote>
<div>Macros may need to access to third party Python modules. When these are
not available to the Python interpreter i.e. exported to the
<code class="docutils literal"><span class="pre">PYTHONPATH</span></code>, one can configure the file system directories where the
MacroServer should look for these modules.</div></blockquote>
</div>
<div class="section" id="max-parallel-macros">
<span id="sardana-macroserver-api-maxparallelmacros"></span><h2>max parallel macros<a class="headerlink" href="#max-parallel-macros" title="Permalink to this headline">¶</a></h2>
<blockquote>
<div><p>Multiple macros can run concurrently in the MacroServer on different
Doors. The maximum number of these threads is configurable.</p>
<p>Default value: 5</p>
</div></blockquote>
</div>
<div class="section" id="log-report-file-name">
<span id="sardana-macroserver-api-logreportfilename"></span><h2>log report file name<a class="headerlink" href="#log-report-file-name" title="Permalink to this headline">¶</a></h2>
<blockquote>
<div>Macros may report information to a file and its location is configurable.</div></blockquote>
</div>
<div class="section" id="log-report-format">
<span id="sardana-macroserver-api-logreportformat"></span><h2>log report format<a class="headerlink" href="#log-report-format" title="Permalink to this headline">¶</a></h2>
<blockquote>
<div><p>Macros may report information to a file and the format of this
information is configurable. It uses the
<a class="reference external" href="https://docs.python.org/2/library/logging.html#formatter-objects">Python logging format syntax</a>.</p>
<p>Defaul value: <code class="docutils literal"><span class="pre">%(levelname)-8s</span> <span class="pre">%(asctime)s:</span> <span class="pre">%(message)s</span></code></p>
</div></blockquote>
</div>
</div>


           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="api_pool.html" class="btn btn-neutral float-right" title="Pool API reference" accesskey="n">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="api_measurementgroup.html" class="btn btn-neutral" title="Measurement group API reference" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright Except where otherwise noted, content on this site is
licensed under a Creative Commons Attribution 3.0 License.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../../',
            VERSION:'3.0.2-alpha',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="../../_static/jquery.js"></script>
      <script type="text/javascript" src="../../_static/underscore.js"></script>
      <script type="text/javascript" src="../../_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="../../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>