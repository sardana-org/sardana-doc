

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>Writing recorders &mdash; sardana 3.0.4-alpha documentation</title>
  

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/graphviz.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Sardana Testing" href="howto_test/index.html" />
    <link rel="prev" title="How to write a pseudo counter controller" href="howto_controllers/howto_pseudocountercontroller.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home"> sardana
          

          
            
            <img src="../_static/logo.png" class="logo" alt="Logo"/>
          
          </a>

          
            
            
              <div class="version">
                3.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference external" href="http://www.sardana-controls.org">Home Page</a></li>
<li class="toctree-l1"><a class="reference external" href="https://github.com/sardana-org/sardana">Project Page</a></li>
<li class="toctree-l1"><a class="reference external" href="http://pypi.python.org/pypi/sardana">Download from PyPI</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../docs.html">Documentation</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../users/index.html">User’s Guide</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="index.html">Developer’s Guide</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="overview/index.html">Overview</a></li>
<li class="toctree-l3"><a class="reference internal" href="howto_macros/index.html">Writing macros</a></li>
<li class="toctree-l3"><a class="reference internal" href="howto_controllers/index.html">Writing controllers</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">Writing recorders</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#overview">Overview</a></li>
<li class="toctree-l4"><a class="reference internal" href="#what-is-a-recorder">What is a recorder?</a></li>
<li class="toctree-l4"><a class="reference internal" href="#type-of-recorders">Type of recorders</a></li>
<li class="toctree-l4"><a class="reference internal" href="#writing-a-custom-recorder">Writing a custom recorder</a></li>
<li class="toctree-l4"><a class="reference internal" href="#configuration">Configuration</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="howto_test/index.html">Sardana Testing</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/api_sardana.html">API</a></li>
<li class="toctree-l3"><a class="reference internal" href="guide_migration/index.html">Migration guide</a></li>
<li class="toctree-l3"><a class="reference internal" href="examples/examples.html">Examples</a></li>
<li class="toctree-l3"><a class="reference internal" href="guide_coding.html">Development guidelines</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../sep/index.html">Sardana Enhancement Proposals</a></li>
<li class="toctree-l2"><a class="reference internal" href="../glossary.html">Glossary</a></li>
<li class="toctree-l2"><a class="reference internal" href="../other_versions.html">Docs for other Sardana versions</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference external" href="http://github.com/sardana-org/sardana-plugins">Plugins Catalogue</a></li>
<li class="toctree-l1"><a class="reference external" href="http://github.com/sardana-org/sardana/wiki">Wiki</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">sardana</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="../docs.html">Sardana 3.0 Documentation</a> &raquo;</li>
        
          <li><a href="index.html">Developer’s Guide</a> &raquo;</li>
        
      <li>Writing recorders</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="../_sources/devel/howto_recorders.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="writing-recorders">
<span id="sardana-writing-recorders"></span><h1>Writing recorders<a class="headerlink" href="#writing-recorders" title="Permalink to this headline">¶</a></h1>
<div class="section" id="overview">
<h2>Overview<a class="headerlink" href="#overview" title="Permalink to this headline">¶</a></h2>
<p>Sardana macros may produce data and users are usually interested in storing
or visualizing it. Sardana delegates this work to the recorders.
A good example of the recorder usage are the scan macros developed with the
<a class="reference internal" href="howto_macros/scan_framework.html#sardana-macros-scanframework"><span class="std std-ref">Scan Framework</span></a>. Recorders are in charge of writing data to
its destinations, for example a file, the Spock output or to plot it on a graph.</p>
</div>
<div class="section" id="what-is-a-recorder">
<h2>What is a recorder?<a class="headerlink" href="#what-is-a-recorder" title="Permalink to this headline">¶</a></h2>
<p>Recorder class is a Sardana element managed by the MacroServer. It is
identified by its name, and is located in a recorder library - another Sardana
element which is also identified by its name. Recorders are developed as
Python classes, and recorder libraries are just Python modules aggregating these
classes.</p>
</div>
<div class="section" id="type-of-recorders">
<h2>Type of recorders<a class="headerlink" href="#type-of-recorders" title="Permalink to this headline">¶</a></h2>
<p>Sardana defines some standard recorders e.g. the Spock output recorder or the
SPEC file recorder. From the other hand users may define their custom recorders.
Sardana provides the following standard recorders (grouped by types):</p>
<ul class="simple">
<li><dl class="simple">
<dt>file [*]</dt><dd><ul>
<li><p>FIO_FileRecorder</p></li>
<li><p>NXscan_FileRecorder</p></li>
<li><p>SPEC_FileRecorder</p></li>
</ul>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>shared memory [*]</dt><dd><ul>
<li><p>SPSRecorder</p></li>
<li><p>ShmRecorder</p></li>
</ul>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>output</dt><dd><ul>
<li><p>JsonRecorder [*]</p></li>
<li><p>OutputRecorder</p></li>
</ul>
</dd>
</dl>
</li>
</ul>
<p>[*] Scan Framework provides mechanisms to enable and select this recorders using
the environment variables.</p>
</div>
<div class="section" id="writing-a-custom-recorder">
<h2>Writing a custom recorder<a class="headerlink" href="#writing-a-custom-recorder" title="Permalink to this headline">¶</a></h2>
<div class="admonition-todo admonition" id="id1">
<p class="admonition-title">Todo</p>
<p>finish chapter based on user’s input</p>
</div>
<p>This chapter provides the necessary information to write recorders in Sardana.</p>
<p>Before writing a new recorder you should check the <a class="reference external" href="https://github.com/sardana-org/sardana-plugins">Sardana plugins
catalogue</a>.
There’s a chance that somebody already wrote one that fits your needs.</p>
<p>If finally you decide to write a new one, below you can find some useful
information:</p>
<ul>
<li><p>Your recorder class would need to inherit from <code class="docutils literal notranslate"><span class="pre">DataRecorder</span></code>
(or <code class="docutils literal notranslate"><span class="pre">BaseFileRecorder</span></code> if you write data to a file) and
implement minimum the following methods:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">_startRecordList</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">_writeRecord</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">_endRecordList</span></code></p></li>
</ul>
<p>You can find some examples in <code class="docutils literal notranslate"><span class="pre">sardana.macroserver.recorders</span></code> module.</p>
</li>
<li><p>Recorder classes are used to instantiate recorder objects in a scan.
Every time a scan starts, in its preparation phase, a new recorder object
gets created. Reversely, at the end of the scan the recorder object gets
destroyed. If you need to keep a long lived objects in your recorder
you may consider using the <a class="reference internal" href="../glossary.html#term-singleton-pattern"><span class="xref std std-term">singleton pattern</span></a></p></li>
</ul>
</div>
<div class="section" id="configuration">
<h2>Configuration<a class="headerlink" href="#configuration" title="Permalink to this headline">¶</a></h2>
<p>Custom recorders may be added to the Sardana system by placing the recorder
library module in a directory which is specified by the MacroServer
<a class="reference internal" href="../users/configuration/macroserver.html#sardana-configuration-macroserver"><span class="std std-ref">RecorderPath</span></a> property.</p>
<p>In case of overriding recorders by name or by file extension (in case of the
file recorders), recorders located in the first paths are of higher priority
than the ones from the last paths.</p>
<p>Three types of overriding may occur:</p>
<dl class="simple">
<dt><strong>By recorder library name</strong></dt><dd><p>If Python modules with the same name are located in different directories,
the library located in the the higher priority directory will be loaded.</p>
</dd>
<dt><strong>By recorder name</strong></dt><dd><p>If two recorder classes with the same name appear in two different modules,
only the recorder from the library located in the higher
priority module will be loaded. If both modules are located in the same
directory, the behavior is undetermined.</p>
</dd>
<dt><strong>By file extension</strong></dt><dd><p>If two different recorders supporting the same file extension appear in two
different modules, the one from the higher priority path will be used
when selection is based on the extension (but both will be available for the
selection by name). If both of these recorders’ modules are located in the
same directory, the system will assign a list of recorders to a given
extension. Then the application is in charge of deciding which one to use.</p>
</dd>
</dl>
<p>As previously mentioned recorders are selectable by either the extension
(using the <a class="reference internal" href="../users/environment_variable_catalog.html#scanfile"><span class="std std-ref">ScanFile</span></a> environment variable) or the recorder name
(using the <a class="reference internal" href="../users/environment_variable_catalog.html#scanrecorder"><span class="std std-ref">ScanRecorder</span></a> environment variable).</p>
<p>During the MacroServer startup the extension to recorder map is
generated while loading the recorder libraries. This dynamically created map
may be overridden by editing the <a class="reference internal" href="../users/configuration/sardanacustomsettings.html#sardana.sardanacustomsettings.SCAN_RECORDER_MAP" title="sardana.sardanacustomsettings.SCAN_RECORDER_MAP"><code class="xref py py-data docutils literal notranslate"><span class="pre">SCAN_RECORDER_MAP</span></code></a>.</p>
</div>
</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="howto_test/index.html" class="btn btn-neutral float-right" title="Sardana Testing" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="howto_controllers/howto_pseudocountercontroller.html" class="btn btn-neutral float-left" title="How to write a pseudo counter controller" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright Except where otherwise noted, content on this site is
licensed under a Creative Commons Attribution 3.0 License.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>