

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Overview &mdash; sardana 3.0.2-alpha documentation</title>
  

  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  

  

  
        <link rel="index" title="Index"
              href="../genindex.html"/>
        <link rel="search" title="Search" href="../search.html"/>
    <link rel="top" title="sardana 3.0.2-alpha documentation" href="../index.html"/>
        <link rel="up" title="User’s Guide" href="index.html"/>
        <link rel="next" title="Getting started" href="getting_started/index.html"/>
        <link rel="prev" title="User’s Guide" href="index.html"/> 

  
  <script src="../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../index.html" class="icon icon-home"> sardana
          

          
            
            <img src="../_static/logo.png" class="logo" />
          
          </a>

          
            
            
              <div class="version">
                3.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
                <ul class="current">
<li class="toctree-l1"><a class="reference external" href="http://www.sardana-controls.org">Home Page</a></li>
<li class="toctree-l1"><a class="reference external" href="https://github.com/sardana-org/sardana">Project Page</a></li>
<li class="toctree-l1"><a class="reference external" href="http://pypi.python.org/pypi/sardana">Download from PyPI</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../docs.html">Documentation</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="index.html">User&#8217;s Guide</a><ul class="current">
<li class="toctree-l3 current"><a class="current reference internal" href="#">Overview</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#what-do-we-sell-to-our-users">What do we &#8220;sell&#8221; to our users</a></li>
<li class="toctree-l4"><a class="reference internal" href="#starting-a-procedure">Starting a procedure</a></li>
<li class="toctree-l4"><a class="reference internal" href="#taurus-as-a-toolkit-for-applications">Taurus as a toolkit for applications</a></li>
<li class="toctree-l4"><a class="reference internal" href="#how-to-write-your-own-procedure">How to write your own procedure</a></li>
<li class="toctree-l4"><a class="reference internal" href="#how-to-adapt-it-to-your-own-hardware">How to adapt it to your own hardware</a></li>
<li class="toctree-l4"><a class="reference internal" href="#symbolic-sketch">Symbolic Sketch</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="getting_started/index.html">Getting started</a></li>
<li class="toctree-l3"><a class="reference internal" href="spock.html">Spock</a></li>
<li class="toctree-l3"><a class="reference internal" href="taurus/index.html">Sardana-Taurus Widgets</a></li>
<li class="toctree-l3"><a class="reference internal" href="scan.html">Scans</a></li>
<li class="toctree-l3"><a class="reference internal" href="motion.html">Motion</a></li>
<li class="toctree-l3"><a class="reference internal" href="acquisition.html">Acquisition</a></li>
<li class="toctree-l3"><a class="reference internal" href="diffractometer.html">Diffractometer</a></li>
<li class="toctree-l3"><a class="reference internal" href="adding_elements.html">Adding real elements</a></li>
<li class="toctree-l3"><a class="reference internal" href="macro_hooks.html">Macro Hooks</a></li>
<li class="toctree-l3"><a class="reference internal" href="macro_environment.html">Macro Environment</a></li>
<li class="toctree-l3"><a class="reference internal" href="macro_logging_and_reports.html">Macro Logging and Reports</a></li>
<li class="toctree-l3"><a class="reference internal" href="environment_variable_catalog.html">Environment Variable Catalog</a></li>
<li class="toctree-l3"><a class="reference internal" href="standard_macro_catalog.html">Standard macro catalog</a></li>
<li class="toctree-l3"><a class="reference internal" href="configuration/index.html">Configuration</a></li>
<li class="toctree-l3"><a class="reference internal" href="screenshots.html">Screenshots</a></li>
<li class="toctree-l3"><a class="reference internal" href="faq.html">FAQ</a></li>
<li class="toctree-l3"><a class="reference external" href="https://github.com/sardana-org/sardana/issues?q=is:issue+is:open+label:doc:knownbug">Known Problems</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../devel/index.html">Developer&#8217;s Guide</a></li>
<li class="toctree-l2"><a class="reference internal" href="../sep/index.html">Sardana Enhancement Proposals</a></li>
<li class="toctree-l2"><a class="reference internal" href="../glossary.html">Glossary</a></li>
<li class="toctree-l2"><a class="reference internal" href="../other_versions.html">Docs for other Sardana versions</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference external" href="http://github.com/sardana-org/sardana-plugins">Plugins Catalogue</a></li>
<li class="toctree-l1"><a class="reference external" href="http://github.com/sardana-org/sardana/wiki">Wiki</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../index.html">sardana</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          

 



<div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../index.html">Docs</a> &raquo;</li>
      
          <li><a href="../docs.html">Sardana 3.0 Documentation</a> &raquo;</li>
      
          <li><a href="index.html">User&#8217;s Guide</a> &raquo;</li>
      
    <li>Overview</li>
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="../_sources/users/overview.txt" rel="nofollow"> View page source</a>
          
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="overview">
<span id="sardana-overview"></span><h1>Overview<a class="headerlink" href="#overview" title="Permalink to this headline">¶</a></h1>
<p>Sardana is the control program initially developed at <a class="reference external" href="http://www.cells.es/">ALBA</a>. Our mission
statement:</p>
<blockquote>
<div><cite>Produce a modular, high performance, robust, and generic user environment for control applications in large and small installations. Make Sardana the generic user environment distributed in the Tango project and the standard basis of collaborations in control.</cite></div></blockquote>
<p>Up to now, control applications in large installations have been notoriously
difficult to share. Inspired by the success of the <a class="reference external" href="http://www.tango-controls.org/">Tango</a> collaboration, <a class="reference external" href="http://www.cells.es/">ALBA</a>
decided to start the creation of a generic tool to enlarge the scope of the
<a class="reference external" href="http://www.tango-controls.org/">Tango</a> project to include a standard client program - or better a standard
generic user environment. From the beginning our aim has been to involve others
in this process. At this moment in time the user environment consists of a highly
configurable standard graphical user interface, a standard command line
interface understanding <a class="reference external" href="http://www.certif.com/">SPEC</a> commands, and a standard way to compose new
applications either by programming or with a graphical tool. It further
consists of a standard macro executer, standard set of macros, a standard range
of common hardware types (like motors, counters, cameras and so on) and a
configuration editor to set all this up. The origin of the Sardana name comes
from a Catalan dance to honor the region where the <a class="reference external" href="http://www.cells.es/">ALBA</a> synchrotron is build.
The toolkit to build Sardana has been C++, <a class="reference external" href="http://www.python.org/">Python</a>, <a class="reference external" href="http://qt.nokia.com/products/">Qt</a> and <a class="reference external" href="http://www.tango-controls.org/">Tango</a>. If you like
the tools you will love Sardana.</p>
<div class="section" id="what-do-we-sell-to-our-users">
<h2>What do we &#8220;sell&#8221; to our users<a class="headerlink" href="#what-do-we-sell-to-our-users" title="Permalink to this headline">¶</a></h2>
<p>Let’s start our excursion into the Sardana world by a word of caution. We will
talk a lot about technical possibilities and implementation details. Our users
will judge us on the ease of use of the final GUI, its robustness and the
features it offers. There are millions of ways to arrive at this end result.
Our claim is however that by doing it the <em>Sardana way</em> and developing the
application out of <em>lego</em> components in a collaborative environment we will
arrive at higher quality software with much higher efficiency.</p>
<p>The following screen shot of an early prototype of a specific beamline
application should serve as a reminder of this final goal.</p>
<a class="reference internal image-reference" href="../_images/snapshot01.png"><img alt="../_images/snapshot01.png" class="align-center" src="../_images/snapshot01.png" style="width: 500px;" /></a>
<p>Inside this application we have many features  common to other beamline control
applications or w some accelerator applications. The following screen shot
shows such a standard application which has been done without programming -
just by configuring the application. This illustrates one of the design
guidelines in Sardana: Always provide a generic interface which can be
specialized for an application.</p>
<a class="reference internal image-reference" href="../_images/snapshot02.png"><img alt="../_images/snapshot02.png" class="align-center" src="../_images/snapshot02.png" style="width: 500px;" /></a>
</div>
<div class="section" id="starting-a-procedure">
<h2>Starting a procedure<a class="headerlink" href="#starting-a-procedure" title="Permalink to this headline">¶</a></h2>
<p>At the heart of the Sardana system are standard reusable procedures. From past
experiences, the importance of standard procedures has been realized and has
influenced most of the major design decisions. To illustrate this point, please
let me walk you through different ways how to start such a procedure without
going into too many details. You might want to think of a <em>scan</em> as an example.
One way of starting a procedure is with a command line interface. Users
familiar with <a class="reference external" href="http://www.certif.com/">SPEC</a> will immediately recognize this way. In effect, inside
Sardana most of the standard <a class="reference external" href="http://www.certif.com/">SPEC</a> commands (including many diffractometer
geometries thanks to Frédéric Picca from the <a class="reference external" href="http://www.synchrotron-soleil.fr/">SOLEIL</a> synchrotron) are provided
as standard procedures and can be invoked in the same way.</p>
<a class="reference internal image-reference" href="../_images/snapshot03.png"><img alt="../_images/snapshot03.png" class="align-center" src="../_images/snapshot03.png" style="width: 500px;" /></a>
<p>Every procedure can also be started from a GUI. This does not need any
programming or configuration from the user of the system. When a new procedure
is created, it is automatically visible inside the GUI and command line tools.</p>
<a class="reference internal image-reference" href="../_images/snapshot04.png"><img alt="../_images/snapshot04.png" class="align-center" src="../_images/snapshot04.png" style="width: 500px;" /></a>
<p>This GUI interface will mainly be used for procedures which are rarely used and
where a specialized interface has not yet been developed. An example of how to
use the same procedure in order to carry out energy spread and emittance
measurements is presented in the following picture.</p>
<a class="reference internal image-reference" href="../_images/snapshot05.png"><img alt="../_images/snapshot05.png" class="align-center" src="../_images/snapshot05.png" style="width: 500px;" /></a>
<p>The standard <a class="reference external" href="http://qt.nokia.com/products/">Qt</a> designer can be used to create new graphical elements (widgets)
and connect them to the system for even greater flexibility. The following
screen shot shows the standard qt designer with some fancy widgets developed in
house.</p>
<a class="reference internal image-reference" href="../_images/snapshot06.png"><img alt="../_images/snapshot06.png" class="align-center" src="../_images/snapshot06.png" style="width: 500px;" /></a>
</div>
<div class="section" id="taurus-as-a-toolkit-for-applications">
<h2>Taurus as a toolkit for applications<a class="headerlink" href="#taurus-as-a-toolkit-for-applications" title="Permalink to this headline">¶</a></h2>
<p>The GUI toolkit for Sardana is called <a class="reference external" href="http://packages.python.org/taurus/">Taurus</a>. The graphical user interfaces in
this paper have been created with this toolkit. It can be used in conjunction
or independent from the rest of the system. It can be used to create custom
panels inside the generic GUI or to create stand alone applications. Again,
this approach of <em>take what you need</em> has been implemented to foster the widest
range of collaborations. Almost all applications in the <a class="reference external" href="http://www.cells.es/">ALBA</a> machine control
system have been created with this toolkit. Creating the applications out of
standard components has been proven to be extremely powerful. In the
<a class="reference internal" href="screenshots.html#sardana-screenshots-guis"><span class="std std-ref">Graphical user interface screen shots</span></a> chapter you can see some of the graphical user
interfaces used.</p>
</div>
<div class="section" id="how-to-write-your-own-procedure">
<h2>How to write your own procedure<a class="headerlink" href="#how-to-write-your-own-procedure" title="Permalink to this headline">¶</a></h2>
<p>Another example I would like to look into is how to write your own procedure.
The simplest possible way is to use an editor to assemble commands and execute
them. This batch files type of procedures are useful to automatically run
procedures over night and for similar simple applications. The following screen
shots show the procedure executer with this feature enabled.</p>
<a class="reference internal image-reference" href="../_images/snapshot08.png"><img alt="../_images/snapshot08.png" class="align-center" src="../_images/snapshot08.png" style="width: 500px;" /></a>
<p>To go further I would like to explain some internal details. All procedures are
executed in a central place (called the macro server). There can be more than
one macro server per system but for the following I assume the common case of a
unique macro server.  This macro server holds all the general procedures
centrally. It provides a controlled environment for these procedures. They can
be edited, run, debugged under its supervision. This allows for example to
automatically roll back changes made in case of problems, log access and grant
permissions. The procedures executed in the macro server provided by the
current Sardana system are <a class="reference external" href="http://www.python.org/">Python</a> functions or classes. Writing a procedure as
a function is more straightforward and recommended for the beginners. Writing it
is a class is a way to group the different methods which concerns this
procedure. As an example, in some procedures it could be possible to do very
specific things in case the user orders an emergency abort of the procedure.
The following example shows the procedure to move a motor.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sardana.macroserver.macro</span> <span class="k">import</span> <span class="n">macro</span><span class="p">,</span> <span class="n">Type</span>

<span class="nd">@macro</span><span class="p">([</span> <span class="p">[</span><span class="s2">&quot;moveable&quot;</span><span class="p">,</span> <span class="n">Type</span><span class="o">.</span><span class="n">Moveable</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="s2">&quot;moveable to move&quot;</span><span class="p">],</span>
         <span class="p">[</span><span class="s2">&quot;position&quot;</span><span class="p">,</span> <span class="n">Type</span><span class="o">.</span><span class="n">Float</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="s2">&quot;absolute position&quot;</span><span class="p">]</span> <span class="p">])</span>
<span class="k">def</span> <span class="nf">move</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">moveable</span><span class="p">,</span> <span class="n">position</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;This macro moves a moveable to the specified position&quot;&quot;&quot;</span>
    <span class="n">moveable</span><span class="o">.</span><span class="n">move</span><span class="p">(</span><span class="n">position</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">output</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%s</span><span class="s2"> is now at </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">moveable</span><span class="o">.</span><span class="n">getName</span><span class="p">(),</span> <span class="n">moveable</span><span class="o">.</span><span class="n">getPosition</span><span class="p">())</span>
</pre></div>
</div>
<p>As you can see in the example, the procedure must be documented and the input
parameters described. From this information, the graphical user interface is
constructed. It is also possible now to start the procedure from the command
line interface and use the tab key to automatically complete the input. The
actual action is actually carried out in the run method. The motor movement is
started and the procedure waits until it arrives at its destiny. The <a class="reference external" href="http://www.python.org/">Python</a>
classes should stay small and very simple. All complicated code can be put into
modules and tested separately from the system.</p>
</div>
<div class="section" id="how-to-adapt-it-to-your-own-hardware">
<h2>How to adapt it to your own hardware<a class="headerlink" href="#how-to-adapt-it-to-your-own-hardware" title="Permalink to this headline">¶</a></h2>
<p>As the system has been thought from the beginning to be used at different
institutes, no assumptions of the hardware used could be made. There exists
therefore a mechanism to adapt the Sardana system to your own hardware. This
adaptor also has another very important role to play. This is best explained
with the motor as example. We consider more or less everything which can be
changed in the system as a motor. The term which should have better been used to
describe this thing should have been therefore <em>movable</em>. A motor can be a
temperature of a temperature controller which can be changed, a motor from an
insertion device which needs a highly complicated protocol to be moved, or just
about anything. Sometimes we also consider calculated value like H,K,L, the
height of a table, and the gap of a slit to be a motor. All these different
<em>motors</em> can be scanned with the same generic procedures without having to
worry about on which elements it is working on. You can add one of these pseudo
motors by means of configuration. It is easily possible to add new types of
pseudo motors. This has only to be done once and the Sardana system already
provides a large variety of these types.</p>
<p>Please find in the following an example for adding a completely new type in the
case of a <em>slit</em>.</p>
<p>The actual information how to create a motor of type <em>slit</em> is kept in the two
methods calc_physical and calc_pseudo which can be used to do the
transformation between the different coordinate systems. Or to say it in the
language of Sardana between the pseudo motors gap and offset and the real
motors left blade and right blade.</p>
<p>Once again the information in the beginning allows the graphical user interface
to be created automatically once it is loaded into the system.</p>
</div>
<div class="section" id="symbolic-sketch">
<h2>Symbolic Sketch<a class="headerlink" href="#symbolic-sketch" title="Permalink to this headline">¶</a></h2>
<p>I would like to end this summary with a symbolic sketch of the different
subsystems in Sardana.</p>
<a class="reference internal image-reference" href="../_images/sardana_sketch.png"><img alt="../_images/sardana_sketch.png" class="align-center" src="../_images/sardana_sketch.png" style="width: 500px;" /></a>
<p>The user will normally not be concerned with these implementation details. It is
presented here to allow appreciating the modularity of the system.</p>
</div>
</div>


           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="getting_started/index.html" class="btn btn-neutral float-right" title="Getting started" accesskey="n">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="index.html" class="btn btn-neutral" title="User’s Guide" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright Except where otherwise noted, content on this site is
licensed under a Creative Commons Attribution 3.0 License.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../',
            VERSION:'3.0.2-alpha',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="../_static/jquery.js"></script>
      <script type="text/javascript" src="../_static/underscore.js"></script>
      <script type="text/javascript" src="../_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>