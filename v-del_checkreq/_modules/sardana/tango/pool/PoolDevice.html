

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>sardana.tango.pool.PoolDevice &mdash; sardana 3.0.0-alpha documentation</title>
  

  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../../../../_static/css/theme.css" type="text/css" />
  

  

  
        <link rel="index" title="Index"
              href="../../../../genindex.html"/>
        <link rel="search" title="Search" href="../../../../search.html"/>
    <link rel="top" title="sardana 3.0.0-alpha documentation" href="../../../../index.html"/>
        <link rel="up" title="Module code" href="../../../index.html"/> 

  
  <script src="../../../../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../../../../index.html" class="icon icon-home"> sardana
          

          
            
            <img src="../../../../_static/logo.png" class="logo" />
          
          </a>

          
            
            
              <div class="version">
                3.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
                <ul>
<li class="toctree-l1"><a class="reference external" href="http://www.sardana-controls.org">Home Page</a></li>
<li class="toctree-l1"><a class="reference external" href="https://github.com/sardana-org/sardana">Project Page</a></li>
<li class="toctree-l1"><a class="reference external" href="http://pypi.python.org/pypi/sardana">Download from PyPI</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../docs.html">Documentation</a></li>
<li class="toctree-l1"><a class="reference external" href="http://github.com/sardana-org/sardana-plugins">Plugins Catalogue</a></li>
<li class="toctree-l1"><a class="reference external" href="http://github.com/sardana-org/sardana/wiki">Wiki</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../../../../index.html">sardana</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          





<div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../../../../index.html">Docs</a> &raquo;</li>
      
          <li><a href="../../../index.html">Module code</a> &raquo;</li>
      
    <li>sardana.tango.pool.PoolDevice</li>
      <li class="wy-breadcrumbs-aside">
        
          
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <h1>Source code for sardana.tango.pool.PoolDevice</h1><div class="highlight"><pre>
<span></span><span class="ch">#!/usr/bin/env python</span>

<span class="c1">##############################################################################</span>
<span class="c1">##</span>
<span class="c1"># This file is part of Sardana</span>
<span class="c1">##</span>
<span class="c1"># http://www.sardana-controls.org/</span>
<span class="c1">##</span>
<span class="c1"># Copyright 2011 CELLS / ALBA Synchrotron, Bellaterra, Spain</span>
<span class="c1">##</span>
<span class="c1"># Sardana is free software: you can redistribute it and/or modify</span>
<span class="c1"># it under the terms of the GNU Lesser General Public License as published by</span>
<span class="c1"># the Free Software Foundation, either version 3 of the License, or</span>
<span class="c1"># (at your option) any later version.</span>
<span class="c1">##</span>
<span class="c1"># Sardana is distributed in the hope that it will be useful,</span>
<span class="c1"># but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
<span class="c1"># MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span>
<span class="c1"># GNU Lesser General Public License for more details.</span>
<span class="c1">##</span>
<span class="c1"># You should have received a copy of the GNU Lesser General Public License</span>
<span class="c1"># along with Sardana.  If not, see &lt;http://www.gnu.org/licenses/&gt;.</span>
<span class="c1">##</span>
<span class="c1">##############################################################################</span>

<span class="sd">&quot;&quot;&quot;Generic Tango Pool Device base classes&quot;&quot;&quot;</span>

<span class="n">__all__</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;PoolDevice&quot;</span><span class="p">,</span> <span class="s2">&quot;PoolDeviceClass&quot;</span><span class="p">,</span>
           <span class="s2">&quot;PoolElementDevice&quot;</span><span class="p">,</span> <span class="s2">&quot;PoolElementDeviceClass&quot;</span><span class="p">,</span>
           <span class="s2">&quot;PoolExpChannelDevice&quot;</span><span class="p">,</span> <span class="s2">&quot;PoolExpChannelDeviceClass&quot;</span><span class="p">,</span>
           <span class="s2">&quot;PoolGroupDevice&quot;</span><span class="p">,</span> <span class="s2">&quot;PoolGroupDeviceClass&quot;</span><span class="p">]</span>

<span class="n">__docformat__</span> <span class="o">=</span> <span class="s1">&#39;restructuredtext&#39;</span>

<span class="kn">import</span> <span class="nn">time</span>

<span class="kn">from</span> <span class="nn">PyTango</span> <span class="k">import</span> <span class="n">Util</span><span class="p">,</span> <span class="n">DevVoid</span><span class="p">,</span> <span class="n">DevLong64</span><span class="p">,</span> <span class="n">DevBoolean</span><span class="p">,</span> <span class="n">DevString</span><span class="p">,</span>\
    <span class="n">DevDouble</span><span class="p">,</span> <span class="n">DevEncoded</span><span class="p">,</span> <span class="n">DevVarStringArray</span><span class="p">,</span> <span class="n">DispLevel</span><span class="p">,</span> <span class="n">DevState</span><span class="p">,</span> <span class="n">SCALAR</span><span class="p">,</span> \
    <span class="n">SPECTRUM</span><span class="p">,</span> <span class="n">IMAGE</span><span class="p">,</span> <span class="n">READ_WRITE</span><span class="p">,</span> <span class="n">READ</span><span class="p">,</span> <span class="n">AttrData</span><span class="p">,</span> <span class="n">CmdArgType</span><span class="p">,</span> <span class="n">DevFailed</span><span class="p">,</span>\
    <span class="n">seqStr_2_obj</span><span class="p">,</span> <span class="n">Except</span><span class="p">,</span> <span class="n">ErrSeverity</span>

<span class="kn">from</span> <span class="nn">taurus.core.util.containers</span> <span class="k">import</span> <span class="n">CaselessDict</span>
<span class="kn">from</span> <span class="nn">taurus.core.util.codecs</span> <span class="k">import</span> <span class="n">CodecFactory</span>

<span class="kn">from</span> <span class="nn">sardana</span> <span class="k">import</span> <span class="n">InvalidId</span><span class="p">,</span> <span class="n">InvalidAxis</span><span class="p">,</span> <span class="n">ElementType</span>
<span class="kn">from</span> <span class="nn">sardana</span> <span class="k">import</span> <span class="n">sardanacustomsettings</span>
<span class="kn">from</span> <span class="nn">sardana.pool.poolmetacontroller</span> <span class="k">import</span> <span class="n">DataInfo</span>
<span class="kn">from</span> <span class="nn">sardana.tango.core.SardanaDevice</span> <span class="k">import</span> <span class="n">SardanaDevice</span><span class="p">,</span> <span class="n">SardanaDeviceClass</span>
<span class="kn">from</span> <span class="nn">sardana.tango.core.util</span> <span class="k">import</span> <span class="n">GenericScalarAttr</span><span class="p">,</span> <span class="n">GenericSpectrumAttr</span><span class="p">,</span> \
    <span class="n">GenericImageAttr</span><span class="p">,</span> <span class="n">to_tango_attr_info</span>


<div class="viewcode-block" id="PoolDevice"><a class="viewcode-back" href="../../../../devel/api/sardana/tango/pool/PoolDevice.html#sardana.tango.pool.PoolDevice.PoolDevice">[docs]</a><span class="k">class</span> <span class="nc">PoolDevice</span><span class="p">(</span><span class="n">SardanaDevice</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Base Tango Pool device class&quot;&quot;&quot;</span>

    <span class="c1">#: list of extreme error states</span>
    <span class="n">ExtremeErrorStates</span> <span class="o">=</span> <span class="n">DevState</span><span class="o">.</span><span class="n">FAULT</span><span class="p">,</span> <span class="n">DevState</span><span class="o">.</span><span class="n">UNKNOWN</span>

    <span class="c1">#: list of busy states</span>
    <span class="n">BusyStates</span> <span class="o">=</span> <span class="n">DevState</span><span class="o">.</span><span class="n">MOVING</span><span class="p">,</span> <span class="n">DevState</span><span class="o">.</span><span class="n">RUNNING</span>

    <span class="c1">#: Maximum number of retries in a busy state</span>
    <span class="n">BusyRetries</span> <span class="o">=</span> <span class="mi">3</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dclass</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Constructor&quot;&quot;&quot;</span>
        <span class="n">SardanaDevice</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dclass</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>

<div class="viewcode-block" id="PoolDevice.init"><a class="viewcode-back" href="../../../../devel/api/sardana/tango/pool/PoolDevice.html#sardana.tango.pool.PoolDevice.PoolDevice.init">[docs]</a>    <span class="k">def</span> <span class="nf">init</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;initialize the device once in the object lifetime. Override when</span>
<span class="sd">        necessary but **always** call the method from your super class</span>

<span class="sd">        :param :obj:`str` name: device name&quot;&quot;&quot;</span>
        <span class="n">SardanaDevice</span><span class="o">.</span><span class="n">init</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
        <span class="n">util</span> <span class="o">=</span> <span class="n">Util</span><span class="o">.</span><span class="n">instance</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_pool_device</span> <span class="o">=</span> <span class="n">util</span><span class="o">.</span><span class="n">get_device_list_by_class</span><span class="p">(</span><span class="s2">&quot;Pool&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_element</span> <span class="o">=</span> <span class="kc">None</span></div>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">pool_device</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;The tango pool device&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_pool_device</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">pool</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;The sardana pool object&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">pool_device</span><span class="o">.</span><span class="n">pool</span>

<div class="viewcode-block" id="PoolDevice.get_element"><a class="viewcode-back" href="../../../../devel/api/sardana/tango/pool/PoolDevice.html#sardana.tango.pool.PoolDevice.PoolDevice.get_element">[docs]</a>    <span class="k">def</span> <span class="nf">get_element</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns the underlying pool element object</span>

<span class="sd">        :return: the underlying pool element object</span>
<span class="sd">        :rtype: :class:`~sardana.pool.poolelement.PoolElement`&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_element</span></div>

<div class="viewcode-block" id="PoolDevice.set_element"><a class="viewcode-back" href="../../../../devel/api/sardana/tango/pool/PoolDevice.html#sardana.tango.pool.PoolDevice.PoolDevice.set_element">[docs]</a>    <span class="k">def</span> <span class="nf">set_element</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">element</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Associates this device with the sardana element</span>

<span class="sd">        :param element: the sardana element</span>
<span class="sd">        :type element: :class:`~sardana.pool.poolelement.PoolElement`&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_element</span> <span class="o">=</span> <span class="n">element</span></div>

    <span class="n">element</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">get_element</span><span class="p">,</span> <span class="n">set_element</span><span class="p">,</span>
                       <span class="n">doc</span><span class="o">=</span><span class="s2">&quot;The underlying sardana element&quot;</span><span class="p">)</span>

<div class="viewcode-block" id="PoolDevice.init_device"><a class="viewcode-back" href="../../../../devel/api/sardana/tango/pool/PoolDevice.html#sardana.tango.pool.PoolDevice.PoolDevice.init_device">[docs]</a>    <span class="k">def</span> <span class="nf">init_device</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Initialize the device. Called during startup after :meth:`init` and</span>
<span class="sd">        every time the tango ``Init`` command is executed.</span>
<span class="sd">        Override when necessary but **always** call the method from your super</span>
<span class="sd">        class&quot;&quot;&quot;</span>
        <span class="n">SardanaDevice</span><span class="o">.</span><span class="n">init_device</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></div>

<div class="viewcode-block" id="PoolDevice.delete_device"><a class="viewcode-back" href="../../../../devel/api/sardana/tango/pool/PoolDevice.html#sardana.tango.pool.PoolDevice.PoolDevice.delete_device">[docs]</a>    <span class="k">def</span> <span class="nf">delete_device</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Clean the device. Called during shutdown and every time the tango</span>
<span class="sd">        ``Init`` command is executed.</span>
<span class="sd">        Override when necessary but **always** call the method from your super</span>
<span class="sd">        class&quot;&quot;&quot;</span>
        <span class="n">SardanaDevice</span><span class="o">.</span><span class="n">delete_device</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></div>

<div class="viewcode-block" id="PoolDevice.Abort"><a class="viewcode-back" href="../../../../devel/api/sardana/tango/pool/PoolDevice.html#sardana.tango.pool.PoolDevice.PoolDevice.Abort">[docs]</a>    <span class="k">def</span> <span class="nf">Abort</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;The tango abort command. Aborts the active operation&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">element</span><span class="o">.</span><span class="n">abort</span><span class="p">()</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">element</span><span class="o">.</span><span class="n">get_state</span><span class="p">(</span><span class="n">cache</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">propagate</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;Abort: failed to read state&quot;</span><span class="p">)</span></div>

<div class="viewcode-block" id="PoolDevice.is_Abort_allowed"><a class="viewcode-back" href="../../../../devel/api/sardana/tango/pool/PoolDevice.html#sardana.tango.pool.PoolDevice.PoolDevice.is_Abort_allowed">[docs]</a>    <span class="k">def</span> <span class="nf">is_Abort_allowed</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns True if it is allowed to execute the tango abort command</span>

<span class="sd">        :return: True if it is allowed to execute the tango abort command or</span>
<span class="sd">                 False otherwise</span>
<span class="sd">        :rtype: bool&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_state</span><span class="p">()</span> <span class="o">!=</span> <span class="n">DevState</span><span class="o">.</span><span class="n">UNKNOWN</span></div>

<div class="viewcode-block" id="PoolDevice.Stop"><a class="viewcode-back" href="../../../../devel/api/sardana/tango/pool/PoolDevice.html#sardana.tango.pool.PoolDevice.PoolDevice.Stop">[docs]</a>    <span class="k">def</span> <span class="nf">Stop</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;The tango stop command. Stops the active operation&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">element</span><span class="o">.</span><span class="n">stop</span><span class="p">()</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">element</span><span class="o">.</span><span class="n">get_state</span><span class="p">(</span><span class="n">cache</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">propagate</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Stop: failed to read state&quot;</span><span class="p">)</span></div>

<div class="viewcode-block" id="PoolDevice.is_Stop_allowed"><a class="viewcode-back" href="../../../../devel/api/sardana/tango/pool/PoolDevice.html#sardana.tango.pool.PoolDevice.PoolDevice.is_Stop_allowed">[docs]</a>    <span class="k">def</span> <span class="nf">is_Stop_allowed</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns True if it is allowed to execute the tango stop command</span>

<span class="sd">        :return: True if it is allowed to execute the tango stop command or</span>
<span class="sd">                 False otherwise</span>
<span class="sd">        :rtype: bool&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_state</span><span class="p">()</span> <span class="o">!=</span> <span class="n">DevState</span><span class="o">.</span><span class="n">UNKNOWN</span></div>

    <span class="k">def</span> <span class="nf">_is_allowed</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">req_type</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Generic is_allowed&quot;&quot;&quot;</span>
<span class="c1">#        state = self.get_state()</span>
<span class="c1">#        if state in self.ExtremeErrorStates:</span>
<span class="c1">#            return False</span>
<span class="c1">#        if req_type == AttReqType.WRITE_REQ:</span>
<span class="c1">#            if state in self.BusyStates:</span>
<span class="c1">#                return False</span>
        <span class="k">return</span> <span class="kc">True</span>

<div class="viewcode-block" id="PoolDevice.get_dynamic_attributes"><a class="viewcode-back" href="../../../../devel/api/sardana/tango/pool/PoolDevice.html#sardana.tango.pool.PoolDevice.PoolDevice.get_dynamic_attributes">[docs]</a>    <span class="k">def</span> <span class="nf">get_dynamic_attributes</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns the standard dynamic and fully dynamic attributes for this</span>
<span class="sd">        device. The return is a tuple of two dictionaries:</span>

<span class="sd">        - standard attributes: caseless dictionary with key being the attribute</span>
<span class="sd">          name and value is a tuple of attribute name(str), tango information,</span>
<span class="sd">          attribute information</span>
<span class="sd">        - dynamic attributes: caseless dictionary with key being the attribute</span>
<span class="sd">          name and value is a tuple of attribute name(str), tango information,</span>
<span class="sd">          attribute information</span>

<span class="sd">        **tango information**</span>
<span class="sd">            seq&lt; :class:`~PyTango.CmdArgType`, :class:`~PyTango.AttrDataFormat`, :class:`~PyTango.AttrWriteType` &gt;</span>

<span class="sd">        **attribute information**</span>
<span class="sd">            attribute information as returned by the sardana controller</span>

<span class="sd">        :return: the standard dynamic and fully dynamic attributes</span>
<span class="sd">        :rtype: seq&lt; :class:`~taurus.core.util.CaselessDict`, :class:`~taurus.core.util.CaselessDict`\&gt;</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">CaselessDict</span><span class="p">(),</span> <span class="n">CaselessDict</span><span class="p">()</span></div>

<div class="viewcode-block" id="PoolDevice.initialize_dynamic_attributes"><a class="viewcode-back" href="../../../../devel/api/sardana/tango/pool/PoolDevice.html#sardana.tango.pool.PoolDevice.PoolDevice.initialize_dynamic_attributes">[docs]</a>    <span class="k">def</span> <span class="nf">initialize_dynamic_attributes</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Initializes this device dynamic attributes&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_attributes</span> <span class="o">=</span> <span class="n">attrs</span> <span class="o">=</span> <span class="n">CaselessDict</span><span class="p">()</span>

        <span class="n">attr_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_dynamic_attributes</span><span class="p">()</span>

        <span class="n">std_attrs</span><span class="p">,</span> <span class="n">dyn_attrs</span> <span class="o">=</span> <span class="n">attr_data</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">remove_unwanted_dynamic_attributes</span><span class="p">(</span><span class="n">std_attrs</span><span class="p">,</span> <span class="n">dyn_attrs</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">std_attrs</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">read</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="n">_read_DynamicAttribute</span>
            <span class="n">write</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="n">_write_DynamicAttribute</span>
            <span class="n">is_allowed</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="n">_is_DynamicAttribute_allowed</span>
            <span class="k">for</span> <span class="n">attr_name</span><span class="p">,</span> <span class="n">data_info</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">std_attrs</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
                <span class="n">attr_name</span><span class="p">,</span> <span class="n">data_info</span><span class="p">,</span> <span class="n">attr_info</span> <span class="o">=</span> <span class="n">data_info</span>
                <span class="n">attr</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_standard_attribute</span><span class="p">(</span><span class="n">attr_name</span><span class="p">,</span> <span class="n">data_info</span><span class="p">,</span>
                                                   <span class="n">attr_info</span><span class="p">,</span> <span class="n">read</span><span class="p">,</span>
                                                   <span class="n">write</span><span class="p">,</span> <span class="n">is_allowed</span><span class="p">)</span>
                <span class="n">attrs</span><span class="p">[</span><span class="n">attr</span><span class="o">.</span><span class="n">get_name</span><span class="p">()]</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="k">if</span> <span class="n">dyn_attrs</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">read</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="n">_read_DynamicAttribute</span>
            <span class="n">write</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="n">_write_DynamicAttribute</span>
            <span class="n">is_allowed</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="n">_is_DynamicAttribute_allowed</span>
            <span class="k">for</span> <span class="n">attr_name</span><span class="p">,</span> <span class="n">data_info</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">dyn_attrs</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
                <span class="n">attr_name</span><span class="p">,</span> <span class="n">data_info</span><span class="p">,</span> <span class="n">attr_info</span> <span class="o">=</span> <span class="n">data_info</span>
                <span class="n">attr</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_dynamic_attribute</span><span class="p">(</span><span class="n">attr_name</span><span class="p">,</span> <span class="n">data_info</span><span class="p">,</span>
                                                  <span class="n">attr_info</span><span class="p">,</span> <span class="n">read</span><span class="p">,</span>
                                                  <span class="n">write</span><span class="p">,</span> <span class="n">is_allowed</span><span class="p">)</span>
                <span class="n">attrs</span><span class="p">[</span><span class="n">attr</span><span class="o">.</span><span class="n">get_name</span><span class="p">()]</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">return</span> <span class="n">attrs</span></div>

<div class="viewcode-block" id="PoolDevice.remove_unwanted_dynamic_attributes"><a class="viewcode-back" href="../../../../devel/api/sardana/tango/pool/PoolDevice.html#sardana.tango.pool.PoolDevice.PoolDevice.remove_unwanted_dynamic_attributes">[docs]</a>    <span class="k">def</span> <span class="nf">remove_unwanted_dynamic_attributes</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">new_std_attrs</span><span class="p">,</span> <span class="n">new_dyn_attrs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Removes unwanted dynamic attributes from previous device creation&quot;&quot;&quot;</span>

        <span class="n">dev_class</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_device_class</span><span class="p">()</span>
        <span class="n">multi_attr</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_device_attr</span><span class="p">()</span>
        <span class="n">multi_class_attr</span> <span class="o">=</span> <span class="n">dev_class</span><span class="o">.</span><span class="n">get_class_attr</span><span class="p">()</span>
        <span class="n">static_attr_names</span> <span class="o">=</span> \
            <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">str</span><span class="o">.</span><span class="n">lower</span><span class="p">,</span> <span class="nb">list</span><span class="p">(</span><span class="n">dev_class</span><span class="o">.</span><span class="n">attr_list</span><span class="o">.</span><span class="n">keys</span><span class="p">())))</span>
        <span class="n">static_attr_names</span><span class="o">.</span><span class="n">extend</span><span class="p">((</span><span class="s1">&#39;state&#39;</span><span class="p">,</span> <span class="s1">&#39;status&#39;</span><span class="p">))</span>

        <span class="n">new_attrs</span> <span class="o">=</span> <span class="n">CaselessDict</span><span class="p">(</span><span class="n">new_std_attrs</span><span class="p">)</span>
        <span class="n">new_attrs</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">new_dyn_attrs</span><span class="p">)</span>

        <span class="n">device_attr_names</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">multi_attr</span><span class="o">.</span><span class="n">get_attr_nb</span><span class="p">()):</span>
            <span class="n">device_attr_names</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">multi_attr</span><span class="o">.</span><span class="n">get_attr_by_ind</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">.</span><span class="n">get_name</span><span class="p">())</span>

        <span class="k">for</span> <span class="n">attr_name</span> <span class="ow">in</span> <span class="n">device_attr_names</span><span class="p">:</span>
            <span class="n">attr_name_lower</span> <span class="o">=</span> <span class="n">attr_name</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">attr_name_lower</span> <span class="ow">in</span> <span class="n">static_attr_names</span><span class="p">:</span>
                <span class="k">continue</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">remove_attribute</span><span class="p">(</span><span class="n">attr_name</span><span class="p">)</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;Error removing dynamic attribute </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span>
                             <span class="n">attr_name_lower</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Details:&quot;</span><span class="p">,</span> <span class="n">exc_info</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

        <span class="n">klass_attr_names</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">klass_attrs</span> <span class="o">=</span> <span class="n">multi_class_attr</span><span class="o">.</span><span class="n">get_attr_list</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">ind</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">klass_attrs</span><span class="p">)):</span>
            <span class="n">klass_attr_names</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">klass_attrs</span><span class="p">[</span><span class="n">ind</span><span class="p">]</span><span class="o">.</span><span class="n">get_name</span><span class="p">())</span>

        <span class="k">for</span> <span class="n">attr_name</span> <span class="ow">in</span> <span class="n">klass_attr_names</span><span class="p">:</span>
            <span class="n">attr_name_lower</span> <span class="o">=</span> <span class="n">attr_name</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">attr_name_lower</span> <span class="ow">in</span> <span class="n">static_attr_names</span><span class="p">:</span>
                <span class="k">continue</span>
            <span class="c1"># if new dynamic attribute is in class attribute then delete it</span>
            <span class="c1"># from class attribute to be later on added again (eventually</span>
            <span class="c1"># with diffent data type or data format)</span>
            <span class="k">if</span> <span class="n">attr_name_lower</span> <span class="ow">in</span> <span class="n">new_attrs</span><span class="p">:</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">attr</span> <span class="o">=</span> <span class="n">multi_class_attr</span><span class="o">.</span><span class="n">get_attr</span><span class="p">(</span><span class="n">attr_name</span><span class="p">)</span>

                    <span class="n">old_type</span> <span class="o">=</span> <span class="n">CmdArgType</span><span class="p">(</span><span class="n">attr</span><span class="o">.</span><span class="n">get_type</span><span class="p">())</span>
                    <span class="n">old_format</span> <span class="o">=</span> <span class="n">attr</span><span class="o">.</span><span class="n">get_format</span><span class="p">()</span>
                    <span class="n">old_access</span> <span class="o">=</span> <span class="n">attr</span><span class="o">.</span><span class="n">get_writable</span><span class="p">()</span>

                    <span class="n">new_attr</span> <span class="o">=</span> <span class="n">new_attrs</span><span class="p">[</span><span class="n">attr_name</span><span class="p">]</span>
                    <span class="n">new_type</span><span class="p">,</span> <span class="n">new_format</span><span class="p">,</span> <span class="n">new_access</span> <span class="o">=</span> <span class="n">new_attr</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">][:</span><span class="mi">3</span><span class="p">]</span>
                    <span class="n">differ</span> <span class="o">=</span> <span class="n">new_type</span> <span class="o">!=</span> <span class="n">old_type</span> <span class="ow">or</span> \
                        <span class="n">new_format</span> <span class="o">!=</span> <span class="n">old_format</span> <span class="ow">or</span> \
                        <span class="n">new_access</span> <span class="o">!=</span> <span class="n">old_access</span>
                    <span class="k">if</span> <span class="n">differ</span><span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Replacing dynamic attribute </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">attr_name</span><span class="p">)</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;old type: </span><span class="si">%s</span><span class="s2">, new type: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span>
                                   <span class="n">old_type</span><span class="p">,</span> <span class="n">new_type</span><span class="p">)</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;old format: </span><span class="si">%s</span><span class="s2">, new format: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span>
                                   <span class="n">old_format</span><span class="p">,</span> <span class="n">new_format</span><span class="p">)</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;old access: </span><span class="si">%s</span><span class="s2">, new access: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span>
                                   <span class="n">old_access</span><span class="p">,</span> <span class="n">new_access</span><span class="p">)</span>
                        <span class="n">multi_class_attr</span><span class="o">.</span><span class="n">remove_attr</span><span class="p">(</span><span class="n">attr</span><span class="o">.</span><span class="n">get_name</span><span class="p">(),</span>
                                                     <span class="n">attr</span><span class="o">.</span><span class="n">get_cl_name</span><span class="p">())</span>
                <span class="k">except</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;Error removing dynamic attribute </span><span class="si">%s</span><span class="s2"> from &quot;</span>
                                 <span class="s2">&quot; device class&quot;</span><span class="p">,</span> <span class="n">attr_name</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Details:&quot;</span><span class="p">,</span> <span class="n">exc_info</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span></div>

<div class="viewcode-block" id="PoolDevice.add_dynamic_attribute"><a class="viewcode-back" href="../../../../devel/api/sardana/tango/pool/PoolDevice.html#sardana.tango.pool.PoolDevice.PoolDevice.add_dynamic_attribute">[docs]</a>    <span class="k">def</span> <span class="nf">add_dynamic_attribute</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">attr_name</span><span class="p">,</span> <span class="n">data_info</span><span class="p">,</span> <span class="n">attr_info</span><span class="p">,</span> <span class="n">read</span><span class="p">,</span>
                              <span class="n">write</span><span class="p">,</span> <span class="n">is_allowed</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Adds a single dynamic attribute</span>

<span class="sd">        :param :obj:`str` attr_name: the attribute name</span>
<span class="sd">        :param data_info: tango attribute information</span>
<span class="sd">        :type data_info: seq&lt; :class:`~PyTango.CmdArgType`, :class:`~PyTango.AttrDataFormat`, :class:`~PyTango.AttrWriteType` &gt;</span>
<span class="sd">        :param attr_info: attribute information</span>
<span class="sd">        :param read: read method for the attribute</span>
<span class="sd">        :param write: write method for the attribute</span>
<span class="sd">        :param is_allowed: is allowed method&quot;&quot;&quot;</span>
        <span class="n">tg_type</span><span class="p">,</span> <span class="n">tg_format</span><span class="p">,</span> <span class="n">tg_access</span> <span class="o">=</span> <span class="n">data_info</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

        <span class="k">if</span> <span class="n">tg_access</span> <span class="o">==</span> <span class="n">READ</span><span class="p">:</span>
            <span class="n">write</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="n">tg_format</span> <span class="o">==</span> <span class="n">SCALAR</span><span class="p">:</span>
            <span class="n">attr</span> <span class="o">=</span> <span class="n">GenericScalarAttr</span><span class="p">(</span><span class="n">attr_name</span><span class="p">,</span> <span class="n">tg_type</span><span class="p">,</span> <span class="n">tg_access</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">tg_format</span> <span class="o">==</span> <span class="n">SPECTRUM</span><span class="p">:</span>
            <span class="n">dim_x</span> <span class="o">=</span> <span class="n">attr_info</span><span class="o">.</span><span class="n">maxdimsize</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">attr</span> <span class="o">=</span> <span class="n">GenericSpectrumAttr</span><span class="p">(</span><span class="n">attr_name</span><span class="p">,</span> <span class="n">tg_type</span><span class="p">,</span> <span class="n">tg_access</span><span class="p">,</span>
                                       <span class="n">dim_x</span><span class="o">=</span><span class="n">dim_x</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">tg_format</span> <span class="o">==</span> <span class="n">IMAGE</span><span class="p">:</span>
            <span class="n">dim_x</span><span class="p">,</span> <span class="n">dim_y</span> <span class="o">=</span> <span class="n">attr_info</span><span class="o">.</span><span class="n">maxdimsize</span>
            <span class="n">attr</span> <span class="o">=</span> <span class="n">GenericImageAttr</span><span class="p">(</span><span class="n">attr_name</span><span class="p">,</span> <span class="n">tg_type</span><span class="p">,</span> <span class="n">tg_access</span><span class="p">,</span>
                                    <span class="n">dim_x</span><span class="o">=</span><span class="n">dim_x</span><span class="p">,</span> <span class="n">dim_y</span><span class="o">=</span><span class="n">dim_y</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">tg_access</span> <span class="o">==</span> <span class="n">READ_WRITE</span> <span class="ow">and</span> <span class="n">tg_format</span> <span class="o">==</span> <span class="n">SCALAR</span><span class="p">:</span>
            <span class="n">memorized</span> <span class="o">=</span> <span class="n">attr_info</span><span class="o">.</span><span class="n">memorized</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">memorized</span> <span class="o">==</span> <span class="s1">&#39;true&#39;</span><span class="p">:</span>
                <span class="n">attr</span><span class="o">.</span><span class="n">set_memorized</span><span class="p">()</span>
                <span class="n">attr</span><span class="o">.</span><span class="n">set_memorized_init</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">memorized</span> <span class="o">==</span> <span class="s1">&#39;true_without_hard_applied&#39;</span><span class="p">:</span>
                <span class="n">attr</span><span class="o">.</span><span class="n">set_memorized</span><span class="p">()</span>
                <span class="n">attr</span><span class="o">.</span><span class="n">set_memorized_init</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">attr</span><span class="o">.</span><span class="n">set_disp_level</span><span class="p">(</span><span class="n">DispLevel</span><span class="o">.</span><span class="n">EXPERT</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_attribute</span><span class="p">(</span><span class="n">attr</span><span class="p">,</span> <span class="n">read</span><span class="p">,</span> <span class="n">write</span><span class="p">,</span> <span class="n">is_allowed</span><span class="p">)</span></div>

<div class="viewcode-block" id="PoolDevice.add_standard_attribute"><a class="viewcode-back" href="../../../../devel/api/sardana/tango/pool/PoolDevice.html#sardana.tango.pool.PoolDevice.PoolDevice.add_standard_attribute">[docs]</a>    <span class="k">def</span> <span class="nf">add_standard_attribute</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">attr_name</span><span class="p">,</span> <span class="n">data_info</span><span class="p">,</span> <span class="n">attr_info</span><span class="p">,</span> <span class="n">read</span><span class="p">,</span>
                               <span class="n">write</span><span class="p">,</span> <span class="n">is_allowed</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Adds a single standard dynamic attribute</span>

<span class="sd">        :param :obj:`str` attr_name: the attribute name</span>
<span class="sd">        :param data_info: tango attribute information</span>
<span class="sd">        :type data_info: seq&lt; :class:`~PyTango.CmdArgType`, :class:`~PyTango.AttrDataFormat`, :class:`~PyTango.AttrWriteType` &gt;</span>
<span class="sd">        :param attr_info: attribute information</span>
<span class="sd">        :param read: read method for the attribute</span>
<span class="sd">        :param write: write method for the attribute</span>
<span class="sd">        :param is_allowed: is allowed method&quot;&quot;&quot;</span>
        <span class="n">dev_class</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_device_class</span><span class="p">()</span>
        <span class="n">attr_data</span> <span class="o">=</span> <span class="n">AttrData</span><span class="p">(</span><span class="n">attr_name</span><span class="p">,</span> <span class="n">dev_class</span><span class="o">.</span><span class="n">get_name</span><span class="p">(),</span> <span class="n">data_info</span><span class="p">)</span>
        <span class="n">attr</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_attribute</span><span class="p">(</span><span class="n">attr_data</span><span class="p">,</span> <span class="n">read</span><span class="p">,</span> <span class="n">write</span><span class="p">,</span> <span class="n">is_allowed</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">attr</span></div>

<div class="viewcode-block" id="PoolDevice.read_DynamicAttribute"><a class="viewcode-back" href="../../../../devel/api/sardana/tango/pool/PoolDevice.html#sardana.tango.pool.PoolDevice.PoolDevice.read_DynamicAttribute">[docs]</a>    <span class="k">def</span> <span class="nf">read_DynamicAttribute</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">attr</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Generic read dynamic attribute.</span>
<span class="sd">        Default implementation raises :exc:`NotImplementedError`</span>

<span class="sd">        :param attr: attribute to be read</span>
<span class="sd">        :type attr: :class:`~PyTango.Attribute`</span>

<span class="sd">        :raises: :exc:`NotImplementedError`&quot;&quot;&quot;</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span></div>

<div class="viewcode-block" id="PoolDevice.write_DynamicAttribute"><a class="viewcode-back" href="../../../../devel/api/sardana/tango/pool/PoolDevice.html#sardana.tango.pool.PoolDevice.PoolDevice.write_DynamicAttribute">[docs]</a>    <span class="k">def</span> <span class="nf">write_DynamicAttribute</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">attr</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Generic write dynamic attribute.</span>
<span class="sd">        Default implementation raises :exc:`NotImplementedError`</span>

<span class="sd">        :param attr: attribute to be written</span>
<span class="sd">        :type attr: :class:`~PyTango.Attribute`</span>

<span class="sd">        :raises: :exc:`NotImplementedError`&quot;&quot;&quot;</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span></div>

<div class="viewcode-block" id="PoolDevice.is_DynamicAttribute_allowed"><a class="viewcode-back" href="../../../../devel/api/sardana/tango/pool/PoolDevice.html#sardana.tango.pool.PoolDevice.PoolDevice.is_DynamicAttribute_allowed">[docs]</a>    <span class="k">def</span> <span class="nf">is_DynamicAttribute_allowed</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">req_type</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Generic is dynamic attribute allowed.</span>
<span class="sd">        Default implementation calls :meth:`_is_allowed`</span>

<span class="sd">        :param req_type: request type</span>
<span class="sd">        :type attr: :class:`~PyTango.AttrRequestType`&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_allowed</span><span class="p">(</span><span class="n">req_type</span><span class="p">)</span></div>

    <span class="k">def</span> <span class="nf">_read_DynamicAttribute</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">attr</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Generic internal read dynamic attribute.</span>
<span class="sd">        Checks if this object has a &#39;read_&#39;+&lt;attr_name&gt; method and calls it.</span>
<span class="sd">        If not calls :meth:`read_DynamicAttribute`.</span>

<span class="sd">        :param attr: attribute to be read</span>
<span class="sd">        :type attr: :class:`~PyTango.Attribute`&quot;&quot;&quot;</span>
        <span class="n">name</span> <span class="o">=</span> <span class="n">attr</span><span class="o">.</span><span class="n">get_name</span><span class="p">()</span>

        <span class="n">read_name</span> <span class="o">=</span> <span class="s2">&quot;read_&quot;</span> <span class="o">+</span> <span class="n">name</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">read_name</span><span class="p">):</span>
            <span class="n">read</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">read_name</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">read</span><span class="p">(</span><span class="n">attr</span><span class="p">)</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">read_DynamicAttribute</span><span class="p">(</span><span class="n">attr</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_write_DynamicAttribute</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">attr</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Generic internal write dynamic attribute.</span>
<span class="sd">        Checks if this object has a &#39;write_&#39;+&lt;attr_name&gt; method and calls it.</span>
<span class="sd">        If not calls :meth:`write_DynamicAttribute`.</span>

<span class="sd">        :param attr: attribute to be written</span>
<span class="sd">        :type attr: :class:`~PyTango.Attribute`&quot;&quot;&quot;</span>
        <span class="n">name</span> <span class="o">=</span> <span class="n">attr</span><span class="o">.</span><span class="n">get_name</span><span class="p">()</span>
        <span class="n">write_name</span> <span class="o">=</span> <span class="s2">&quot;write_&quot;</span> <span class="o">+</span> <span class="n">name</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">write_name</span><span class="p">):</span>
            <span class="n">write</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">write_name</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">write</span><span class="p">(</span><span class="n">attr</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">write_DynamicAttribute</span><span class="p">(</span><span class="n">attr</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_is_DynamicAttribute_allowed</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">req_type</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Generic is dynamic attribute allowed.</span>
<span class="sd">        Default implementation calls :meth:`is_DynamicAttribute_allowed`</span>

<span class="sd">        :param req_type: request type</span>
<span class="sd">        :type attr: :class:`~PyTango.AttrRequestType`&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_DynamicAttribute_allowed</span><span class="p">(</span><span class="n">req_type</span><span class="p">)</span>

<div class="viewcode-block" id="PoolDevice.dev_state"><a class="viewcode-back" href="../../../../devel/api/sardana/tango/pool/PoolDevice.html#sardana.tango.pool.PoolDevice.PoolDevice.dev_state">[docs]</a>    <span class="k">def</span> <span class="nf">dev_state</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Calculates and returns the device state. Called by Tango on a read</span>
<span class="sd">        state request.</span>

<span class="sd">        :return: the device state</span>
<span class="sd">        :rtype: :class:`~PyTango.DevState`&quot;&quot;&quot;</span>
        <span class="n">element</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">element</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">use_cache</span> <span class="o">=</span> <span class="n">element</span><span class="o">.</span><span class="n">is_in_operation</span><span class="p">()</span> <span class="ow">and</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">Force_HW_Read</span>
            <span class="n">ctrl_state</span> <span class="o">=</span> <span class="n">element</span><span class="o">.</span><span class="n">get_state</span><span class="p">(</span><span class="n">cache</span><span class="o">=</span><span class="n">use_cache</span><span class="p">,</span> <span class="n">propagate</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
            <span class="n">state</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">calculate_tango_state</span><span class="p">(</span><span class="n">ctrl_state</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">state</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;Exception trying to return state&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Details:&quot;</span><span class="p">,</span> <span class="n">exc_info</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">DevState</span><span class="o">.</span><span class="n">FAULT</span></div>

<div class="viewcode-block" id="PoolDevice.dev_status"><a class="viewcode-back" href="../../../../devel/api/sardana/tango/pool/PoolDevice.html#sardana.tango.pool.PoolDevice.PoolDevice.dev_status">[docs]</a>    <span class="k">def</span> <span class="nf">dev_status</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Calculates and returns the device status. Called by Tango on a read</span>
<span class="sd">        status request.</span>

<span class="sd">        :return: the device status</span>
<span class="sd">        :rtype: :obj:`str`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">element</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">element</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">use_cache</span> <span class="o">=</span> <span class="n">element</span><span class="o">.</span><span class="n">is_in_operation</span><span class="p">()</span> <span class="ow">and</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">Force_HW_Read</span>
            <span class="n">ctrl_status</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">element</span><span class="o">.</span><span class="n">get_status</span><span class="p">(</span><span class="n">cache</span><span class="o">=</span><span class="n">use_cache</span><span class="p">,</span> <span class="n">propagate</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
            <span class="n">status</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">calculate_tango_status</span><span class="p">(</span><span class="n">ctrl_status</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">status</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">msg</span> <span class="o">=</span> <span class="s2">&quot;Exception trying to return status: </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Details:&quot;</span><span class="p">,</span> <span class="n">exc_info</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">msg</span></div>

<div class="viewcode-block" id="PoolDevice.wait_for_operation"><a class="viewcode-back" href="../../../../devel/api/sardana/tango/pool/PoolDevice.html#sardana.tango.pool.PoolDevice.PoolDevice.wait_for_operation">[docs]</a>    <span class="k">def</span> <span class="nf">wait_for_operation</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Waits for an operation to finish. It uses the maxumum number of</span>
<span class="sd">        retries. Sleeps 0.01s between retries.</span>

<span class="sd">        :raises: :exc:`Exception` in case of a timeout&quot;&quot;&quot;</span>
        <span class="n">element</span><span class="p">,</span> <span class="n">n</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">element</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">BusyRetries</span>
        <span class="k">while</span> <span class="n">element</span><span class="o">.</span><span class="n">is_in_operation</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">n</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;Wait for operation timedout&quot;</span><span class="p">)</span>
            <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.01</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;waited for operation&quot;</span><span class="p">)</span>
            <span class="n">n</span> <span class="o">=</span> <span class="n">n</span> <span class="o">-</span> <span class="mi">1</span></div>

<div class="viewcode-block" id="PoolDevice.Restore"><a class="viewcode-back" href="../../../../devel/api/sardana/tango/pool/PoolDevice.html#sardana.tango.pool.PoolDevice.PoolDevice.Restore">[docs]</a>    <span class="k">def</span> <span class="nf">Restore</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Restore tango command. Restores the attributes to their former glory.</span>
<span class="sd">        This applies to memorized writable attributes which have a set point</span>
<span class="sd">        stored in the database&quot;&quot;&quot;</span>
        <span class="n">restore_attributes</span><span class="p">,</span> <span class="n">db_values</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_restore_data</span><span class="p">()</span>
        <span class="n">multi_attribute</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_device_attr</span><span class="p">()</span>

        <span class="k">for</span> <span class="n">attr_name</span> <span class="ow">in</span> <span class="n">restore_attributes</span><span class="p">:</span>
            <span class="n">props</span> <span class="o">=</span> <span class="n">db_values</span><span class="p">[</span><span class="n">attr_name</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">props</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="ow">not</span> <span class="s2">&quot;__value&quot;</span> <span class="ow">in</span> <span class="n">props</span><span class="p">:</span>
                <span class="k">continue</span>
            <span class="n">attribute</span> <span class="o">=</span> <span class="n">multi_attribute</span><span class="o">.</span><span class="n">get_w_attr_by_name</span><span class="p">(</span><span class="n">attr_name</span><span class="p">)</span>
            <span class="n">write_meth_name</span> <span class="o">=</span> <span class="s2">&quot;write_&quot;</span> <span class="o">+</span> <span class="n">attr_name</span>
            <span class="n">write_meth</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">write_meth_name</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">write_meth</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;Could not recover </span><span class="si">%s</span><span class="s2">: </span><span class="si">%s</span><span class="s2"> does not exist&quot;</span><span class="p">,</span>
                             <span class="n">attr_name</span><span class="p">,</span> <span class="n">write_meth_name</span><span class="p">)</span>
                <span class="k">continue</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">restore_attribute</span><span class="p">(</span><span class="n">attribute</span><span class="p">,</span> <span class="n">write_meth</span><span class="p">,</span> <span class="n">props</span><span class="p">[</span><span class="s1">&#39;__value&#39;</span><span class="p">])</span></div>

<div class="viewcode-block" id="PoolDevice.get_restore_data"><a class="viewcode-back" href="../../../../devel/api/sardana/tango/pool/PoolDevice.html#sardana.tango.pool.PoolDevice.PoolDevice.get_restore_data">[docs]</a>    <span class="k">def</span> <span class="nf">get_restore_data</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">restore_attributes</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_attributes_to_restore</span><span class="p">()</span>
        <span class="n">db</span> <span class="o">=</span> <span class="n">Util</span><span class="o">.</span><span class="n">instance</span><span class="p">()</span><span class="o">.</span><span class="n">get_database</span><span class="p">()</span>
        <span class="n">db_values</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">get_device_attribute_property</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_name</span><span class="p">(),</span>
                                                     <span class="n">restore_attributes</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">restore_attributes</span><span class="p">,</span> <span class="n">db_values</span></div>

<div class="viewcode-block" id="PoolDevice.get_attributes_to_restore"><a class="viewcode-back" href="../../../../devel/api/sardana/tango/pool/PoolDevice.html#sardana.tango.pool.PoolDevice.PoolDevice.get_attributes_to_restore">[docs]</a>    <span class="k">def</span> <span class="nf">get_attributes_to_restore</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">std_attrs</span><span class="p">,</span> <span class="n">dyn_attrs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_dynamic_attributes</span><span class="p">()</span>
        <span class="n">multi_attribute</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_device_attr</span><span class="p">()</span>

        <span class="n">restore</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">attr_name</span> <span class="ow">in</span> <span class="n">std_attrs</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">attribute</span> <span class="o">=</span> <span class="n">multi_attribute</span><span class="o">.</span><span class="n">get_w_attr_by_name</span><span class="p">(</span><span class="n">attr_name</span><span class="p">)</span>
            <span class="k">except</span> <span class="n">DevFailed</span><span class="p">:</span>
                <span class="k">continue</span>
            <span class="n">restore</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">attribute</span><span class="o">.</span><span class="n">get_name</span><span class="p">())</span>
        <span class="k">for</span> <span class="n">attr_name</span> <span class="ow">in</span> <span class="n">dyn_attrs</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">attribute</span> <span class="o">=</span> <span class="n">multi_attribute</span><span class="o">.</span><span class="n">get_w_attr_by_name</span><span class="p">(</span><span class="n">attr_name</span><span class="p">)</span>
            <span class="k">except</span> <span class="n">DevFailed</span><span class="p">:</span>
                <span class="k">continue</span>
            <span class="n">restore</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">attribute</span><span class="o">.</span><span class="n">get_name</span><span class="p">())</span>
        <span class="k">return</span> <span class="n">restore</span></div>

    <span class="k">def</span> <span class="nf">_get_attribute_value_from_db_value</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">attribute</span><span class="p">,</span> <span class="n">db_value</span><span class="p">):</span>
        <span class="n">value</span> <span class="o">=</span> <span class="n">seqStr_2_obj</span><span class="p">(</span><span class="n">db_value</span><span class="p">,</span> <span class="n">attribute</span><span class="o">.</span><span class="n">get_data_type</span><span class="p">(),</span>
                             <span class="n">attribute</span><span class="o">.</span><span class="n">get_data_format</span><span class="p">())</span>
        <span class="k">return</span> <span class="n">value</span>

<div class="viewcode-block" id="PoolDevice.restore_attribute"><a class="viewcode-back" href="../../../../devel/api/sardana/tango/pool/PoolDevice.html#sardana.tango.pool.PoolDevice.PoolDevice.restore_attribute">[docs]</a>    <span class="k">def</span> <span class="nf">restore_attribute</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">attribute</span><span class="p">,</span> <span class="n">write_meth</span><span class="p">,</span> <span class="n">db_value</span><span class="p">):</span>
        <span class="n">value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_attribute_value_from_db_value</span><span class="p">(</span><span class="n">attribute</span><span class="p">,</span> <span class="n">db_value</span><span class="p">)</span>
        <span class="n">attr_name</span> <span class="o">=</span> <span class="n">attribute</span><span class="o">.</span><span class="n">get_name</span><span class="p">()</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">attribute</span><span class="o">.</span><span class="n">set_write_value</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Restoring </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">attr_name</span><span class="p">)</span>
            <span class="n">write_meth</span><span class="p">(</span><span class="n">attribute</span><span class="p">)</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;Could not recover </span><span class="si">%s</span><span class="s2">: Error in write&quot;</span><span class="p">,</span> <span class="n">attr_name</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Details:&quot;</span><span class="p">,</span> <span class="n">exc_info</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span></div></div>


<div class="viewcode-block" id="PoolDeviceClass"><a class="viewcode-back" href="../../../../devel/api/sardana/tango/pool/PoolDevice.html#sardana.tango.pool.PoolDevice.PoolDeviceClass">[docs]</a><span class="k">class</span> <span class="nc">PoolDeviceClass</span><span class="p">(</span><span class="n">SardanaDeviceClass</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Base Tango Pool Device Class class&quot;&quot;&quot;</span>

    <span class="c1">#:</span>
    <span class="c1">#: Sardana device class properties definition</span>
    <span class="c1">#:</span>
    <span class="c1">#: .. seealso:: :ref:`server`</span>
    <span class="c1">#:</span>
    <span class="n">class_property_list</span> <span class="o">=</span> <span class="n">SardanaDeviceClass</span><span class="o">.</span><span class="n">class_property_list</span>

    <span class="c1">#:</span>
    <span class="c1">#: Sardana device properties definition</span>
    <span class="c1">#:</span>
    <span class="c1">#: .. seealso:: :ref:`server`</span>
    <span class="c1">#:</span>
    <span class="n">device_property_list</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;Id&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">DevLong64</span><span class="p">,</span> <span class="s2">&quot;Internal ID&quot;</span><span class="p">,</span> <span class="n">InvalidId</span><span class="p">],</span>
        <span class="s1">&#39;Force_HW_Read&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">DevBoolean</span><span class="p">,</span> <span class="s2">&quot;Force a hardware read of value even &quot;</span>
                          <span class="s2">&quot;when in operation (motion/acquisition&quot;</span><span class="p">,</span>
                          <span class="kc">False</span><span class="p">],</span>
    <span class="p">}</span>
    <span class="n">device_property_list</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">SardanaDeviceClass</span><span class="o">.</span><span class="n">device_property_list</span><span class="p">)</span>

    <span class="c1">#:</span>
    <span class="c1">#: Sardana device command definition</span>
    <span class="c1">#:</span>
    <span class="c1">#: .. seealso:: :ref:`server`</span>
    <span class="c1">#:</span>
    <span class="n">cmd_list</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;Stop&#39;</span><span class="p">:</span> <span class="p">[[</span><span class="n">DevVoid</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">],</span> <span class="p">[</span><span class="n">DevVoid</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">]],</span>
        <span class="s1">&#39;Abort&#39;</span><span class="p">:</span> <span class="p">[[</span><span class="n">DevVoid</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">],</span> <span class="p">[</span><span class="n">DevVoid</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">]],</span>
        <span class="s1">&#39;Restore&#39;</span><span class="p">:</span> <span class="p">[[</span><span class="n">DevVoid</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">],</span> <span class="p">[</span><span class="n">DevVoid</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">]],</span>
    <span class="p">}</span>
    <span class="n">cmd_list</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">SardanaDeviceClass</span><span class="o">.</span><span class="n">cmd_list</span><span class="p">)</span>

    <span class="c1">#:</span>
    <span class="c1">#: Sardana device attribute definition</span>
    <span class="c1">#:</span>
    <span class="c1">#: .. seealso:: :ref:`server`</span>
    <span class="c1">#:</span>
    <span class="n">attr_list</span> <span class="o">=</span> <span class="p">{</span>
    <span class="p">}</span>
    <span class="n">attr_list</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">SardanaDeviceClass</span><span class="o">.</span><span class="n">attr_list</span><span class="p">)</span>

    <span class="n">standard_attr_list</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="k">def</span> <span class="nf">_get_class_properties</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">ret</span> <span class="o">=</span> <span class="n">SardanaDeviceClass</span><span class="o">.</span><span class="n">_get_class_properties</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="n">ret</span><span class="p">[</span><span class="s1">&#39;Description&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Generic Pool device class&quot;</span>
        <span class="n">ret</span><span class="p">[</span><span class="s1">&#39;InheritedFrom&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;SardanaDevice&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">ret</span></div>


<div class="viewcode-block" id="PoolElementDevice"><a class="viewcode-back" href="../../../../devel/api/sardana/tango/pool/PoolDevice.html#sardana.tango.pool.PoolDevice.PoolElementDevice">[docs]</a><span class="k">class</span> <span class="nc">PoolElementDevice</span><span class="p">(</span><span class="n">PoolDevice</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Base Tango Pool Element Device class&quot;&quot;&quot;</span>

<div class="viewcode-block" id="PoolElementDevice.init_device"><a class="viewcode-back" href="../../../../devel/api/sardana/tango/pool/PoolDevice.html#sardana.tango.pool.PoolDevice.PoolElementDevice.init_device">[docs]</a>    <span class="k">def</span> <span class="nf">init_device</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Initialize the device. Called during startup after :meth:`init` and</span>
<span class="sd">        every time the tango ``Init`` command is executed.</span>
<span class="sd">        Override when necessary but **always** call the method from your super</span>
<span class="sd">        class&quot;&quot;&quot;</span>
        <span class="n">PoolDevice</span><span class="o">.</span><span class="n">init_device</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">instrument</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ctrl</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">instrument_id</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Instrument_id</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">instrument_id</span> <span class="o">!=</span> <span class="n">InvalidId</span><span class="p">:</span>
                <span class="n">instrument</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pool</span><span class="o">.</span><span class="n">get_element_by_id</span><span class="p">(</span><span class="n">instrument_id</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">instrument</span> <span class="o">=</span> <span class="n">instrument</span>
        <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
            <span class="k">pass</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">ctrl_id</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Ctrl_id</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">ctrl_id</span> <span class="o">!=</span> <span class="n">InvalidId</span><span class="p">:</span>
                <span class="n">ctrl</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pool</span><span class="o">.</span><span class="n">get_element_by_id</span><span class="p">(</span><span class="n">ctrl_id</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">ctrl</span> <span class="o">=</span> <span class="n">ctrl</span>
        <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
            <span class="k">pass</span></div>

<div class="viewcode-block" id="PoolElementDevice.read_Instrument"><a class="viewcode-back" href="../../../../devel/api/sardana/tango/pool/PoolDevice.html#sardana.tango.pool.PoolDevice.PoolElementDevice.read_Instrument">[docs]</a>    <span class="k">def</span> <span class="nf">read_Instrument</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">attr</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Read the value of the ``Instrument`` tango attribute.</span>
<span class="sd">        Returns the instrument full name or empty string if this element doesn&#39;t</span>
<span class="sd">        belong to any instrument</span>

<span class="sd">        :param attr: tango instrument attribute</span>
<span class="sd">        :type attr: :class:`~PyTango.Attribute`&quot;&quot;&quot;</span>
        <span class="n">instrument</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">element</span><span class="o">.</span><span class="n">instrument</span>
        <span class="k">if</span> <span class="n">instrument</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">attr</span><span class="o">.</span><span class="n">set_value</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">attr</span><span class="o">.</span><span class="n">set_value</span><span class="p">(</span><span class="n">instrument</span><span class="o">.</span><span class="n">full_name</span><span class="p">)</span></div>

<div class="viewcode-block" id="PoolElementDevice.write_Instrument"><a class="viewcode-back" href="../../../../devel/api/sardana/tango/pool/PoolDevice.html#sardana.tango.pool.PoolDevice.PoolElementDevice.write_Instrument">[docs]</a>    <span class="k">def</span> <span class="nf">write_Instrument</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">attr</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Write the value of the ``Instrument`` tango attribute.</span>
<span class="sd">        Sets a new instrument full name or empty string if this element doesn&#39;t</span>
<span class="sd">        belong to any instrument.</span>
<span class="sd">        The instrument **must** have been previously created.</span>

<span class="sd">        :param attr: tango instrument attribute</span>
<span class="sd">        :type attr: :class:`~PyTango.Attribute`&quot;&quot;&quot;</span>
        <span class="n">name</span> <span class="o">=</span> <span class="n">attr</span><span class="o">.</span><span class="n">get_write_value</span><span class="p">()</span>
        <span class="n">instrument</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="n">name</span><span class="p">:</span>
            <span class="n">instrument</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pool</span><span class="o">.</span><span class="n">get_element</span><span class="p">(</span><span class="n">full_name</span><span class="o">=</span><span class="n">name</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">instrument</span><span class="o">.</span><span class="n">get_type</span><span class="p">()</span> <span class="o">!=</span> <span class="n">ElementType</span><span class="o">.</span><span class="n">Instrument</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%s</span><span class="s2"> is not an instrument&quot;</span> <span class="o">%</span> <span class="n">name</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">element</span><span class="o">.</span><span class="n">instrument</span> <span class="o">=</span> <span class="n">instrument</span>
        <span class="n">db</span> <span class="o">=</span> <span class="n">Util</span><span class="o">.</span><span class="n">instance</span><span class="p">()</span><span class="o">.</span><span class="n">get_database</span><span class="p">()</span>
        <span class="n">db</span><span class="o">.</span><span class="n">put_device_property</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">get_name</span><span class="p">(),</span> <span class="p">{</span><span class="s2">&quot;Instrument_id&quot;</span><span class="p">:</span> <span class="n">instrument</span><span class="o">.</span><span class="n">id</span><span class="p">})</span></div>

<div class="viewcode-block" id="PoolElementDevice.get_dynamic_attributes"><a class="viewcode-back" href="../../../../devel/api/sardana/tango/pool/PoolDevice.html#sardana.tango.pool.PoolDevice.PoolElementDevice.get_dynamic_attributes">[docs]</a>    <span class="k">def</span> <span class="nf">get_dynamic_attributes</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Override of :class:`PoolDevice.get_dynamic_attributes`.</span>
<span class="sd">        Returns the standard dynamic and fully dynamic attributes for this</span>
<span class="sd">        device. The return is a tuple of two dictionaries:</span>

<span class="sd">        - standard attributes: caseless dictionary with key being the attribute</span>
<span class="sd">          name and value is a tuple of attribute name(str), tango information,</span>
<span class="sd">          attribute information</span>
<span class="sd">        - dynamic attributes: caseless dictionary with key being the attribute</span>
<span class="sd">          name and value is a tuple of attribute name(str), tango information,</span>
<span class="sd">          attribute information</span>

<span class="sd">        **tango information**</span>
<span class="sd">            seq&lt; :class:`~PyTango.CmdArgType`, :class:`~PyTango.AttrDataFormat`, :class:`~PyTango.AttrWriteType` &gt;</span>

<span class="sd">        **attribute information**</span>
<span class="sd">            attribute information as returned by the sardana controller</span>

<span class="sd">        :return: the standard dynamic and fully dynamic attributes</span>
<span class="sd">        :rtype: seq&lt; :class:`~taurus.core.util.CaselessDict`, :class:`~taurus.core.util.CaselessDict`\&gt;</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;_dynamic_attributes_cache&quot;</span><span class="p">):</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_standard_attributes_cache</span><span class="p">,</span> \
                   <span class="bp">self</span><span class="o">.</span><span class="n">_dynamic_attributes_cache</span>
        <span class="n">std_attrs</span><span class="p">,</span> <span class="n">dyn_attrs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_dynamic_attributes</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_standard_attributes_cache</span> <span class="o">=</span> <span class="n">std_attrs</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_dynamic_attributes_cache</span> <span class="o">=</span> <span class="n">dyn_attrs</span>
        <span class="k">return</span> <span class="n">std_attrs</span><span class="p">,</span> <span class="n">dyn_attrs</span></div>

    <span class="k">def</span> <span class="nf">_get_dynamic_attributes</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">ctrl</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ctrl</span>
        <span class="k">if</span> <span class="n">ctrl</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;no controller: dynamic attributes NOT created&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">PoolDevice</span><span class="o">.</span><span class="n">get_dynamic_attributes</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">ctrl</span><span class="o">.</span><span class="n">is_online</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;controller offline: dynamic attributes NOT created&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">PoolDevice</span><span class="o">.</span><span class="n">get_dynamic_attributes</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

        <span class="n">dyn_attrs</span> <span class="o">=</span> <span class="n">CaselessDict</span><span class="p">()</span>
        <span class="n">std_attrs</span> <span class="o">=</span> <span class="n">CaselessDict</span><span class="p">()</span>
        <span class="n">dev_class</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_device_class</span><span class="p">()</span>
        <span class="n">axis_attrs</span> <span class="o">=</span> <span class="n">ctrl</span><span class="o">.</span><span class="n">get_axis_attributes</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">element</span><span class="o">.</span><span class="n">axis</span><span class="p">)</span>

        <span class="n">std_attrs_lower</span> <span class="o">=</span> <span class="p">[</span><span class="n">attr</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
                           <span class="k">for</span> <span class="n">attr</span> <span class="ow">in</span> <span class="n">dev_class</span><span class="o">.</span><span class="n">standard_attr_list</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">attr_name</span><span class="p">,</span> <span class="n">attr_info</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">axis_attrs</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
            <span class="n">attr_name_lower</span> <span class="o">=</span> <span class="n">attr_name</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">attr_name_lower</span> <span class="ow">in</span> <span class="n">std_attrs_lower</span><span class="p">:</span>
                <span class="n">data_info</span> <span class="o">=</span> <span class="n">DataInfo</span><span class="o">.</span><span class="n">toDataInfo</span><span class="p">(</span><span class="n">attr_name</span><span class="p">,</span> <span class="n">attr_info</span><span class="p">)</span>
                <span class="n">tg_info</span> <span class="o">=</span> <span class="n">dev_class</span><span class="o">.</span><span class="n">standard_attr_list</span><span class="p">[</span><span class="n">attr_name</span><span class="p">]</span>
                <span class="n">std_attrs</span><span class="p">[</span><span class="n">attr_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">attr_name</span><span class="p">,</span> <span class="n">tg_info</span><span class="p">,</span> <span class="n">data_info</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">data_info</span> <span class="o">=</span> <span class="n">DataInfo</span><span class="o">.</span><span class="n">toDataInfo</span><span class="p">(</span><span class="n">attr_name</span><span class="p">,</span> <span class="n">attr_info</span><span class="p">)</span>
                <span class="n">name</span><span class="p">,</span> <span class="n">tg_info</span> <span class="o">=</span> <span class="n">to_tango_attr_info</span><span class="p">(</span><span class="n">attr_name</span><span class="p">,</span> <span class="n">data_info</span><span class="p">)</span>
                <span class="n">dyn_attrs</span><span class="p">[</span><span class="n">attr_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">name</span><span class="p">,</span> <span class="n">tg_info</span><span class="p">,</span> <span class="n">data_info</span>
        <span class="k">return</span> <span class="n">std_attrs</span><span class="p">,</span> <span class="n">dyn_attrs</span>

<div class="viewcode-block" id="PoolElementDevice.read_DynamicAttribute"><a class="viewcode-back" href="../../../../devel/api/sardana/tango/pool/PoolDevice.html#sardana.tango.pool.PoolDevice.PoolElementDevice.read_DynamicAttribute">[docs]</a>    <span class="k">def</span> <span class="nf">read_DynamicAttribute</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">attr</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Read a generic dynamic attribute. Calls the controller of this</span>
<span class="sd">        element to get the dynamic attribute value</span>

<span class="sd">        :param attr: tango attribute</span>
<span class="sd">        :type attr: :class:`~PyTango.Attribute`&quot;&quot;&quot;</span>
        <span class="n">name</span> <span class="o">=</span> <span class="n">attr</span><span class="o">.</span><span class="n">get_name</span><span class="p">()</span>
        <span class="n">ctrl</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ctrl</span>
        <span class="k">if</span> <span class="n">ctrl</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;Cannot read </span><span class="si">%s</span><span class="s2">. Controller not build!&quot;</span> <span class="o">%</span> <span class="n">name</span><span class="p">)</span>
        <span class="n">v</span> <span class="o">=</span> <span class="n">ctrl</span><span class="o">.</span><span class="n">get_axis_attr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">element</span><span class="o">.</span><span class="n">axis</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">v</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
                <span class="s2">&quot;Cannot read </span><span class="si">%s</span><span class="s2">. Controller returns None&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">name</span><span class="p">,))</span>
        <span class="n">attr</span><span class="o">.</span><span class="n">set_value</span><span class="p">(</span><span class="n">v</span><span class="p">)</span></div>

<div class="viewcode-block" id="PoolElementDevice.write_DynamicAttribute"><a class="viewcode-back" href="../../../../devel/api/sardana/tango/pool/PoolDevice.html#sardana.tango.pool.PoolDevice.PoolElementDevice.write_DynamicAttribute">[docs]</a>    <span class="k">def</span> <span class="nf">write_DynamicAttribute</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">attr</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Write a generic dynamic attribute. Calls the controller of this</span>
<span class="sd">        element to get the dynamic attribute value</span>

<span class="sd">        :param attr: tango attribute</span>
<span class="sd">        :type attr: :class:`~PyTango.Attribute`&quot;&quot;&quot;</span>
        <span class="n">name</span> <span class="o">=</span> <span class="n">attr</span><span class="o">.</span><span class="n">get_name</span><span class="p">()</span>
        <span class="n">value</span> <span class="o">=</span> <span class="n">attr</span><span class="o">.</span><span class="n">get_write_value</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;writing dynamic attribute </span><span class="si">%s</span><span class="s2"> with value </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
        <span class="n">ctrl</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ctrl</span>
        <span class="k">if</span> <span class="n">ctrl</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;Cannot write </span><span class="si">%s</span><span class="s2">. Controller not build!&quot;</span> <span class="o">%</span> <span class="n">name</span><span class="p">)</span>
        <span class="n">ctrl</span><span class="o">.</span><span class="n">set_axis_attr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">element</span><span class="o">.</span><span class="n">axis</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span></div>

<div class="viewcode-block" id="PoolElementDevice.read_SimulationMode"><a class="viewcode-back" href="../../../../devel/api/sardana/tango/pool/PoolDevice.html#sardana.tango.pool.PoolDevice.PoolElementDevice.read_SimulationMode">[docs]</a>    <span class="k">def</span> <span class="nf">read_SimulationMode</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">attr</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Read the current simulation mode.</span>

<span class="sd">        :param attr: tango attribute</span>
<span class="sd">        :type attr: :class:`~PyTango.Attribute`&quot;&quot;&quot;</span>
        <span class="n">attr</span><span class="o">.</span><span class="n">set_value</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">element</span><span class="o">.</span><span class="n">simulation_mode</span><span class="p">)</span></div>

<div class="viewcode-block" id="PoolElementDevice.write_SimulationMode"><a class="viewcode-back" href="../../../../devel/api/sardana/tango/pool/PoolDevice.html#sardana.tango.pool.PoolDevice.PoolElementDevice.write_SimulationMode">[docs]</a>    <span class="k">def</span> <span class="nf">write_SimulationMode</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">attr</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Sets the simulation mode.</span>

<span class="sd">        :param attr: tango attribute</span>
<span class="sd">        :type attr: :class:`~PyTango.Attribute`&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">element</span><span class="o">.</span><span class="n">simulation_mode</span> <span class="o">=</span> <span class="n">attr</span><span class="o">.</span><span class="n">get_write_value</span><span class="p">()</span></div></div>


<div class="viewcode-block" id="PoolElementDeviceClass"><a class="viewcode-back" href="../../../../devel/api/sardana/tango/pool/PoolDevice.html#sardana.tango.pool.PoolDevice.PoolElementDeviceClass">[docs]</a><span class="k">class</span> <span class="nc">PoolElementDeviceClass</span><span class="p">(</span><span class="n">PoolDeviceClass</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Base Tango Pool Element Device Class class&quot;&quot;&quot;</span>

    <span class="c1">#:</span>
    <span class="c1">#: Sardana device properties definition</span>
    <span class="c1">#:</span>
    <span class="c1">#: .. seealso:: :ref:`server`</span>
    <span class="c1">#:</span>
    <span class="n">device_property_list</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;Axis&quot;</span><span class="p">:</span> <span class="p">[</span><span class="n">DevLong64</span><span class="p">,</span> <span class="s2">&quot;Axis in the controller&quot;</span><span class="p">,</span> <span class="p">[</span><span class="n">InvalidAxis</span><span class="p">]],</span>
        <span class="s2">&quot;Ctrl_id&quot;</span><span class="p">:</span> <span class="p">[</span><span class="n">DevLong64</span><span class="p">,</span> <span class="s2">&quot;Controller ID&quot;</span><span class="p">,</span> <span class="p">[</span><span class="n">InvalidId</span><span class="p">]],</span>
        <span class="s2">&quot;Instrument_id&quot;</span><span class="p">:</span> <span class="p">[</span><span class="n">DevLong64</span><span class="p">,</span> <span class="s2">&quot;Controller ID&quot;</span><span class="p">,</span> <span class="p">[</span><span class="n">InvalidId</span><span class="p">]],</span>
    <span class="p">}</span>
    <span class="n">device_property_list</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">PoolDeviceClass</span><span class="o">.</span><span class="n">device_property_list</span><span class="p">)</span>

    <span class="c1">#:</span>
    <span class="c1">#: Sardana device attribute definition</span>
    <span class="c1">#:</span>
    <span class="c1">#: .. seealso:: :ref:`server`</span>
    <span class="c1">#:</span>
    <span class="n">attr_list</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;Instrument&#39;</span><span class="p">:</span>    <span class="p">[[</span><span class="n">DevString</span><span class="p">,</span> <span class="n">SCALAR</span><span class="p">,</span> <span class="n">READ_WRITE</span><span class="p">],</span>
                          <span class="p">{</span><span class="s1">&#39;label&#39;</span><span class="p">:</span> <span class="s2">&quot;Instrument&quot;</span><span class="p">,</span>
                           <span class="s1">&#39;Display level&#39;</span><span class="p">:</span> <span class="n">DispLevel</span><span class="o">.</span><span class="n">EXPERT</span><span class="p">}],</span>
        <span class="s1">&#39;SimulationMode&#39;</span><span class="p">:</span> <span class="p">[[</span><span class="n">DevBoolean</span><span class="p">,</span> <span class="n">SCALAR</span><span class="p">,</span> <span class="n">READ_WRITE</span><span class="p">],</span>
                           <span class="p">{</span><span class="s1">&#39;label&#39;</span><span class="p">:</span> <span class="s2">&quot;Simulation mode&quot;</span><span class="p">}],</span>
    <span class="p">}</span>
    <span class="n">attr_list</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">PoolDeviceClass</span><span class="o">.</span><span class="n">attr_list</span><span class="p">)</span>

    <span class="n">cmd_list</span> <span class="o">=</span> <span class="p">{</span>
    <span class="p">}</span>
    <span class="n">cmd_list</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">PoolDeviceClass</span><span class="o">.</span><span class="n">cmd_list</span><span class="p">)</span>

<div class="viewcode-block" id="PoolElementDeviceClass.get_standard_attr_info"><a class="viewcode-back" href="../../../../devel/api/sardana/tango/pool/PoolDevice.html#sardana.tango.pool.PoolDevice.PoolElementDeviceClass.get_standard_attr_info">[docs]</a>    <span class="k">def</span> <span class="nf">get_standard_attr_info</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">attr</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns information about the standard attribute</span>

<span class="sd">        :param :obj:`str` attr: attribute name</span>
<span class="sd">        :return: a sequence of tango data_type, data format&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">standard_attr_list</span><span class="p">[</span><span class="n">attr</span><span class="p">]</span></div>

    <span class="k">def</span> <span class="nf">_get_class_properties</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">ret</span> <span class="o">=</span> <span class="n">PoolDeviceClass</span><span class="o">.</span><span class="n">_get_class_properties</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="n">ret</span><span class="p">[</span><span class="s1">&#39;Description&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Generic Pool element device class&quot;</span>
        <span class="n">ret</span><span class="p">[</span><span class="s1">&#39;InheritedFrom&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;PoolDevice&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">ret</span></div>


<div class="viewcode-block" id="PoolGroupDevice"><a class="viewcode-back" href="../../../../devel/api/sardana/tango/pool/PoolDevice.html#sardana.tango.pool.PoolDevice.PoolGroupDevice">[docs]</a><span class="k">class</span> <span class="nc">PoolGroupDevice</span><span class="p">(</span><span class="n">PoolDevice</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Base Tango Pool Group Device class&quot;&quot;&quot;</span>

<div class="viewcode-block" id="PoolGroupDevice.read_ElementList"><a class="viewcode-back" href="../../../../devel/api/sardana/tango/pool/PoolDevice.html#sardana.tango.pool.PoolDevice.PoolGroupDevice.read_ElementList">[docs]</a>    <span class="k">def</span> <span class="nf">read_ElementList</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">attr</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Read the element list.</span>

<span class="sd">        :param attr: tango attribute</span>
<span class="sd">        :type attr: :class:`~PyTango.Attribute`&quot;&quot;&quot;</span>
        <span class="n">attr</span><span class="o">.</span><span class="n">set_value</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_element_names</span><span class="p">())</span></div>

<div class="viewcode-block" id="PoolGroupDevice.get_element_names"><a class="viewcode-back" href="../../../../devel/api/sardana/tango/pool/PoolDevice.html#sardana.tango.pool.PoolDevice.PoolGroupDevice.get_element_names">[docs]</a>    <span class="k">def</span> <span class="nf">get_element_names</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns the list of element names.</span>

<span class="sd">        :return: a list of attribute names&quot;&quot;&quot;</span>
        <span class="n">elements</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">element</span><span class="o">.</span><span class="n">get_user_elements</span><span class="p">()</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">element</span><span class="o">.</span><span class="n">name</span> <span class="k">for</span> <span class="n">element</span> <span class="ow">in</span> <span class="n">elements</span><span class="p">]</span></div>

<div class="viewcode-block" id="PoolGroupDevice.elements_changed"><a class="viewcode-back" href="../../../../devel/api/sardana/tango/pool/PoolDevice.html#sardana.tango.pool.PoolDevice.PoolGroupDevice.elements_changed">[docs]</a>    <span class="k">def</span> <span class="nf">elements_changed</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">evt_src</span><span class="p">,</span> <span class="n">evt_type</span><span class="p">,</span> <span class="n">evt_value</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Callback for when the elements of this group changed&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">push_change_event</span><span class="p">(</span><span class="s2">&quot;ElementList&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_element_names</span><span class="p">())</span></div></div>


<div class="viewcode-block" id="PoolGroupDeviceClass"><a class="viewcode-back" href="../../../../devel/api/sardana/tango/pool/PoolDevice.html#sardana.tango.pool.PoolDevice.PoolGroupDeviceClass">[docs]</a><span class="k">class</span> <span class="nc">PoolGroupDeviceClass</span><span class="p">(</span><span class="n">PoolDeviceClass</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Base Tango Pool Group Device Class class&quot;&quot;&quot;</span>

    <span class="c1">#:</span>
    <span class="c1">#: Sardana device properties definition</span>
    <span class="c1">#:</span>
    <span class="c1">#: .. seealso:: :ref:`server`</span>
    <span class="c1">#:</span>
    <span class="n">device_property_list</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;Elements&quot;</span><span class="p">:</span>    <span class="p">[</span><span class="n">DevVarStringArray</span><span class="p">,</span> <span class="s2">&quot;elements in the group&quot;</span><span class="p">,</span> <span class="p">[]],</span>
    <span class="p">}</span>
    <span class="n">device_property_list</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">PoolDeviceClass</span><span class="o">.</span><span class="n">device_property_list</span><span class="p">)</span>

    <span class="c1">#:</span>
    <span class="c1">#: Sardana device command definition</span>
    <span class="c1">#:</span>
    <span class="c1">#: .. seealso:: :ref:`server`</span>
    <span class="c1">#:</span>
    <span class="n">cmd_list</span> <span class="o">=</span> <span class="p">{</span>
    <span class="p">}</span>
    <span class="n">cmd_list</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">PoolDeviceClass</span><span class="o">.</span><span class="n">cmd_list</span><span class="p">)</span>

    <span class="c1">#:</span>
    <span class="c1">#: Sardana device attribute definition</span>
    <span class="c1">#:</span>
    <span class="c1">#: .. seealso:: :ref:`server`</span>
    <span class="c1">#:</span>
    <span class="n">attr_list</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;ElementList&#39;</span><span class="p">:</span> <span class="p">[[</span><span class="n">DevString</span><span class="p">,</span> <span class="n">SPECTRUM</span><span class="p">,</span> <span class="n">READ</span><span class="p">,</span> <span class="mi">4096</span><span class="p">]],</span>
    <span class="p">}</span>
    <span class="n">attr_list</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">PoolDeviceClass</span><span class="o">.</span><span class="n">attr_list</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_get_class_properties</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">ret</span> <span class="o">=</span> <span class="n">PoolDeviceClass</span><span class="o">.</span><span class="n">_get_class_properties</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="n">ret</span><span class="p">[</span><span class="s1">&#39;Description&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Generic Pool group device class&quot;</span>
        <span class="n">ret</span><span class="p">[</span><span class="s1">&#39;InheritedFrom&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;PoolDevice&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">ret</span></div>


<span class="k">class</span> <span class="nc">PoolExpChannelDevice</span><span class="p">(</span><span class="n">PoolElementDevice</span><span class="p">):</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dclass</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Constructor&quot;&quot;&quot;</span>
        <span class="n">PoolElementDevice</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dclass</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
        <span class="n">codec_name</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">sardanacustomsettings</span><span class="p">,</span> <span class="s2">&quot;VALUE_BUFFER_CODEC&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_value_buffer_codec</span> <span class="o">=</span> <span class="n">CodecFactory</span><span class="p">()</span><span class="o">.</span><span class="n">getCodec</span><span class="p">(</span><span class="n">codec_name</span><span class="p">)</span>
        <span class="n">codec_name</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">sardanacustomsettings</span><span class="p">,</span> <span class="s2">&quot;VALUE_REF_BUFFER_CODEC&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_value_ref_buffer_codec</span> <span class="o">=</span> <span class="n">CodecFactory</span><span class="p">()</span><span class="o">.</span><span class="n">getCodec</span><span class="p">(</span><span class="n">codec_name</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_encode_value_chunk</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value_chunk</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Prepare value chunk to be passed via communication channel.</span>

<span class="sd">        :param value_chunk: value chunk</span>
<span class="sd">        :type value_chunk: seq&lt;SardanaValue&gt;</span>

<span class="sd">        :return: json string representing value chunk</span>
<span class="sd">        :rtype: str&quot;&quot;&quot;</span>
        <span class="n">index</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">value</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">sdn_value</span> <span class="ow">in</span> <span class="n">value_chunk</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">index</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">idx</span><span class="p">)</span>
            <span class="n">value</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">sdn_value</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
        <span class="n">data</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="n">index</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="n">value</span><span class="p">)</span>
        <span class="n">encoded_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_value_buffer_codec</span><span class="o">.</span><span class="n">encode</span><span class="p">((</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">data</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">encoded_data</span>

    <span class="k">def</span> <span class="nf">_encode_value_ref_chunk</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value_ref_chunk</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Prepare value ref chunk to be passed via communication channel.</span>

<span class="sd">        :param value_ref_chunk: value ref chunk</span>
<span class="sd">        :type value_ref_ chunk: seq&lt;SardanaValue&gt;</span>

<span class="sd">        :return: json string representing value chunk</span>
<span class="sd">        :rtype: str</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">index</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">value_ref</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">sdn_value</span> <span class="ow">in</span> <span class="n">value_ref_chunk</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">index</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">idx</span><span class="p">)</span>
            <span class="n">value_ref</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">sdn_value</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
        <span class="n">data</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="n">index</span><span class="p">,</span> <span class="n">value_ref</span><span class="o">=</span><span class="n">value_ref</span><span class="p">)</span>
        <span class="n">encoded_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_value_ref_buffer_codec</span><span class="o">.</span><span class="n">encode</span><span class="p">((</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">data</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">encoded_data</span>

    <span class="k">def</span> <span class="nf">initialize_dynamic_attributes</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">attrs</span> <span class="o">=</span> <span class="n">PoolElementDevice</span><span class="o">.</span><span class="n">initialize_dynamic_attributes</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

        <span class="n">non_detect_evts</span> <span class="o">=</span> <span class="s2">&quot;integrationtime&quot;</span><span class="p">,</span>

        <span class="k">for</span> <span class="n">attr_name</span> <span class="ow">in</span> <span class="n">non_detect_evts</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">attr_name</span> <span class="ow">in</span> <span class="n">attrs</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">set_change_event</span><span class="p">(</span><span class="n">attr_name</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">attrs</span>

    <span class="k">def</span> <span class="nf">read_ValueBuffer</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">_</span><span class="p">):</span>
        <span class="n">desc</span> <span class="o">=</span> <span class="s2">&quot;ValueBuffer attribute is not foreseen for reading. It is &quot;</span> \
               <span class="s2">&quot;used only as the communication channel for the continuous &quot;</span> \
               <span class="s2">&quot;acquisitions.&quot;</span>
        <span class="n">Except</span><span class="o">.</span><span class="n">throw_exception</span><span class="p">(</span><span class="s2">&quot;UnsupportedFeature&quot;</span><span class="p">,</span>
                               <span class="n">desc</span><span class="p">,</span>
                               <span class="s2">&quot;PoolExpChannelDevice.read_ValueBuffer&quot;</span><span class="p">,</span>
                               <span class="n">ErrSeverity</span><span class="o">.</span><span class="n">WARN</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">read_ValueRefBuffer</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">_</span><span class="p">):</span>
        <span class="n">desc</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;ValueRefBuffer attribute is not foreseen for reading. &quot;</span>
                <span class="s2">&quot;It is used only as the communication channel for the &quot;</span>
                <span class="s2">&quot;continuous acquisitions.&quot;</span><span class="p">)</span>
        <span class="n">Except</span><span class="o">.</span><span class="n">throw_exception</span><span class="p">(</span><span class="s2">&quot;UnsupportedFeature&quot;</span><span class="p">,</span>
                               <span class="n">desc</span><span class="p">,</span>
                               <span class="s2">&quot;PoolExpChannelDevice.read_ValueRefBuffer&quot;</span><span class="p">,</span>
                               <span class="n">ErrSeverity</span><span class="o">.</span><span class="n">WARN</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">read_IntegrationTime</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">attr</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Reads the integration time.</span>

<span class="sd">        :param attr: tango attribute</span>
<span class="sd">        :type attr: :class:`~PyTango.Attribute`&quot;&quot;&quot;</span>
        <span class="n">attr</span><span class="o">.</span><span class="n">set_value</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">element</span><span class="o">.</span><span class="n">integration_time</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">write_IntegrationTime</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">attr</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Sets the integration time.</span>

<span class="sd">        :param attr: tango attribute</span>
<span class="sd">        :type attr: :class:`~PyTango.Attribute`&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">element</span><span class="o">.</span><span class="n">integration_time</span> <span class="o">=</span> <span class="n">attr</span><span class="o">.</span><span class="n">get_write_value</span><span class="p">()</span>


<span class="k">class</span> <span class="nc">PoolExpChannelDeviceClass</span><span class="p">(</span><span class="n">PoolElementDeviceClass</span><span class="p">):</span>

    <span class="c1">#:</span>
    <span class="c1">#: Sardana device attribute definition</span>
    <span class="c1">#:</span>
    <span class="c1">#: .. seealso:: :ref:`server`</span>
    <span class="c1">#:</span>
    <span class="n">attr_list</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;IntegrationTime&#39;</span><span class="p">:</span> <span class="p">[[</span><span class="n">DevDouble</span><span class="p">,</span> <span class="n">SCALAR</span><span class="p">,</span> <span class="n">READ_WRITE</span><span class="p">]]</span>
    <span class="p">}</span>
    <span class="n">attr_list</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">PoolElementDeviceClass</span><span class="o">.</span><span class="n">attr_list</span><span class="p">)</span>

    <span class="n">standard_attr_list</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;ValueBuffer&#39;</span><span class="p">:</span> <span class="p">[[</span><span class="n">DevEncoded</span><span class="p">,</span> <span class="n">SCALAR</span><span class="p">,</span> <span class="n">READ</span><span class="p">]]</span>
    <span class="p">}</span>
    <span class="n">standard_attr_list</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">PoolElementDeviceClass</span><span class="o">.</span><span class="n">standard_attr_list</span><span class="p">)</span>


<span class="k">class</span> <span class="nc">PoolTimerableDevice</span><span class="p">(</span><span class="n">PoolExpChannelDevice</span><span class="p">):</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dclass</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Constructor&quot;&quot;&quot;</span>
        <span class="n">PoolExpChannelDevice</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dclass</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">initialize_dynamic_attributes</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">attrs</span> <span class="o">=</span> <span class="n">PoolExpChannelDevice</span><span class="o">.</span><span class="n">initialize_dynamic_attributes</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

        <span class="n">detect_evts</span> <span class="o">=</span> <span class="s2">&quot;timer&quot;</span><span class="p">,</span>

        <span class="k">for</span> <span class="n">attr_name</span> <span class="ow">in</span> <span class="n">detect_evts</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">attr_name</span> <span class="ow">in</span> <span class="n">attrs</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">set_change_event</span><span class="p">(</span><span class="n">attr_name</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">attrs</span>

    <span class="k">def</span> <span class="nf">read_Timer</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">attr</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Reads the timer for this channel.</span>

<span class="sd">        :param attr: tango attribute</span>
<span class="sd">        :type attr: :class:`~PyTango.Attribute`&quot;&quot;&quot;</span>
        <span class="n">timer</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">element</span><span class="o">.</span><span class="n">timer</span>
        <span class="k">if</span> <span class="n">timer</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">timer</span> <span class="o">=</span> <span class="s1">&#39;None&#39;</span>
        <span class="n">attr</span><span class="o">.</span><span class="n">set_value</span><span class="p">(</span><span class="n">timer</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">write_Timer</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">attr</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Sets the timer for this channel.</span>

<span class="sd">        :param attr: tango attribute</span>
<span class="sd">        :type attr: :class:`~PyTango.Attribute`&quot;&quot;&quot;</span>
        <span class="n">timer</span> <span class="o">=</span> <span class="n">attr</span><span class="o">.</span><span class="n">get_write_value</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">timer</span> <span class="o">==</span> <span class="s1">&#39;None&#39;</span><span class="p">:</span>
            <span class="n">timer</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">element</span><span class="o">.</span><span class="n">timer</span> <span class="o">=</span> <span class="n">timer</span>


<span class="k">class</span> <span class="nc">PoolTimerableDeviceClass</span><span class="p">(</span><span class="n">PoolExpChannelDeviceClass</span><span class="p">):</span>

    <span class="c1">#:</span>
    <span class="c1">#: Sardana device attribute definition</span>
    <span class="c1">#:</span>
    <span class="c1">#: .. seealso:: :ref:`server`</span>
    <span class="c1">#:</span>

    <span class="c1">#    Attribute definitions</span>
    <span class="n">attr_list</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;Timer&#39;</span><span class="p">:</span> <span class="p">[[</span><span class="n">DevString</span><span class="p">,</span> <span class="n">SCALAR</span><span class="p">,</span> <span class="n">READ_WRITE</span><span class="p">],</span>
                  <span class="p">{</span><span class="s1">&#39;Memorized&#39;</span><span class="p">:</span> <span class="s2">&quot;true&quot;</span><span class="p">,</span> <span class="p">}]</span>
    <span class="p">}</span>
    <span class="n">attr_list</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">PoolExpChannelDeviceClass</span><span class="o">.</span><span class="n">attr_list</span><span class="p">)</span>

    <span class="n">standard_attr_list</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">standard_attr_list</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">PoolExpChannelDeviceClass</span><span class="o">.</span><span class="n">standard_attr_list</span><span class="p">)</span>
</pre></div>

           </div>
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright Except where otherwise noted, content on this site is
licensed under a Creative Commons Attribution 3.0 License.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../../../../',
            VERSION:'3.0.0-alpha',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="../../../../_static/jquery.js"></script>
      <script type="text/javascript" src="../../../../_static/underscore.js"></script>
      <script type="text/javascript" src="../../../../_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="../../../../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>