

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>sardana.taurus.core.tango.sardana.pool &mdash; sardana 3.0.2-alpha documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../../../../../../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../../../../../" src="../../../../../../_static/documentation_options.js"></script>
        <script src="../../../../../../_static/jquery.js"></script>
        <script src="../../../../../../_static/underscore.js"></script>
        <script src="../../../../../../_static/doctools.js"></script>
        <script src="../../../../../../_static/language_data.js"></script>
    
    <script type="text/javascript" src="../../../../../../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../../../../../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../../../../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../../../../../_static/graphviz.css" type="text/css" />
    <link rel="index" title="Index" href="../../../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../../../search.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../../../../../index.html" class="icon icon-home"> sardana
          

          
            
            <img src="../../../../../../_static/logo.png" class="logo" alt="Logo"/>
          
          </a>

          
            
            
              <div class="version">
                3.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul>
<li class="toctree-l1"><a class="reference external" href="http://www.sardana-controls.org">Home Page</a></li>
<li class="toctree-l1"><a class="reference external" href="https://github.com/sardana-org/sardana">Project Page</a></li>
<li class="toctree-l1"><a class="reference external" href="http://pypi.python.org/pypi/sardana">Download from PyPI</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../../docs.html">Documentation</a></li>
<li class="toctree-l1"><a class="reference external" href="http://github.com/sardana-org/sardana-plugins">Plugins Catalogue</a></li>
<li class="toctree-l1"><a class="reference external" href="http://github.com/sardana-org/sardana/wiki">Wiki</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../../../../index.html">sardana</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../../../../../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../../../../../index.html">Module code</a> &raquo;</li>
        
          <li><a href="../sardana.html">sardana.taurus.core.tango.sardana</a> &raquo;</li>
        
      <li>sardana.taurus.core.tango.sardana.pool</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <h1>Source code for sardana.taurus.core.tango.sardana.pool</h1><div class="highlight"><pre>
<span></span><span class="ch">#!/usr/bin/env python</span>

<span class="c1">##############################################################################</span>
<span class="c1">##</span>
<span class="c1"># This file is part of Sardana</span>
<span class="c1">##</span>
<span class="c1"># http://www.sardana-controls.org/</span>
<span class="c1">##</span>
<span class="c1"># Copyright 2011 CELLS / ALBA Synchrotron, Bellaterra, Spain</span>
<span class="c1">##</span>
<span class="c1"># Sardana is free software: you can redistribute it and/or modify</span>
<span class="c1"># it under the terms of the GNU Lesser General Public License as published by</span>
<span class="c1"># the Free Software Foundation, either version 3 of the License, or</span>
<span class="c1"># (at your option) any later version.</span>
<span class="c1">##</span>
<span class="c1"># Sardana is distributed in the hope that it will be useful,</span>
<span class="c1"># but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
<span class="c1"># MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span>
<span class="c1"># GNU Lesser General Public License for more details.</span>
<span class="c1">##</span>
<span class="c1"># You should have received a copy of the GNU Lesser General Public License</span>
<span class="c1"># along with Sardana.  If not, see &lt;http://www.gnu.org/licenses/&gt;.</span>
<span class="c1">##</span>
<span class="c1">##############################################################################</span>

<span class="sd">&quot;&quot;&quot;The device pool submodule.</span>
<span class="sd">It contains specific part of sardana device pool&quot;&quot;&quot;</span>


<span class="n">__all__</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;InterruptException&quot;</span><span class="p">,</span> <span class="s2">&quot;StopException&quot;</span><span class="p">,</span> <span class="s2">&quot;AbortException&quot;</span><span class="p">,</span>
           <span class="s2">&quot;ReleaseException&quot;</span><span class="p">,</span>
           <span class="s2">&quot;BaseElement&quot;</span><span class="p">,</span> <span class="s2">&quot;ControllerClass&quot;</span><span class="p">,</span> <span class="s2">&quot;ControllerLibrary&quot;</span><span class="p">,</span>
           <span class="s2">&quot;PoolElement&quot;</span><span class="p">,</span> <span class="s2">&quot;Controller&quot;</span><span class="p">,</span> <span class="s2">&quot;ComChannel&quot;</span><span class="p">,</span> <span class="s2">&quot;ExpChannel&quot;</span><span class="p">,</span>
           <span class="s2">&quot;CTExpChannel&quot;</span><span class="p">,</span> <span class="s2">&quot;ZeroDExpChannel&quot;</span><span class="p">,</span> <span class="s2">&quot;OneDExpChannel&quot;</span><span class="p">,</span>
           <span class="s2">&quot;TwoDExpChannel&quot;</span><span class="p">,</span> <span class="s2">&quot;PseudoCounter&quot;</span><span class="p">,</span> <span class="s2">&quot;Motor&quot;</span><span class="p">,</span> <span class="s2">&quot;PseudoMotor&quot;</span><span class="p">,</span>
           <span class="s2">&quot;MotorGroup&quot;</span><span class="p">,</span> <span class="s2">&quot;TriggerGate&quot;</span><span class="p">,</span>
           <span class="s2">&quot;MeasurementGroup&quot;</span><span class="p">,</span> <span class="s2">&quot;IORegister&quot;</span><span class="p">,</span> <span class="s2">&quot;Instrument&quot;</span><span class="p">,</span> <span class="s2">&quot;Pool&quot;</span><span class="p">,</span>
           <span class="s2">&quot;registerExtensions&quot;</span><span class="p">,</span> <span class="s2">&quot;getChannelConfigs&quot;</span><span class="p">]</span>

<span class="n">__docformat__</span> <span class="o">=</span> <span class="s1">&#39;restructuredtext&#39;</span>

<span class="kn">import</span> <span class="nn">copy</span>
<span class="kn">import</span> <span class="nn">operator</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">import</span> <span class="nn">time</span>
<span class="kn">import</span> <span class="nn">traceback</span>
<span class="kn">import</span> <span class="nn">weakref</span>
<span class="kn">import</span> <span class="nn">json</span>
<span class="kn">from</span> <span class="nn">datetime</span> <span class="kn">import</span> <span class="n">datetime</span>
<span class="kn">import</span> <span class="nn">numpy</span>
<span class="kn">import</span> <span class="nn">threading</span>
<span class="kn">import</span> <span class="nn">PyTango</span>
<span class="kn">import</span> <span class="nn">collections</span>

<span class="kn">from</span> <span class="nn">PyTango</span> <span class="kn">import</span> <span class="n">DevState</span><span class="p">,</span> <span class="n">AttrDataFormat</span><span class="p">,</span> <span class="n">AttrQuality</span><span class="p">,</span> <span class="n">DevFailed</span><span class="p">,</span> \
    <span class="n">DeviceProxy</span><span class="p">,</span> <span class="n">AttributeProxy</span>
<span class="kn">from</span> <span class="nn">taurus</span> <span class="kn">import</span> <span class="n">Factory</span><span class="p">,</span> <span class="n">Device</span>
<span class="kn">from</span> <span class="nn">taurus.core.taurusbasetypes</span> <span class="kn">import</span> <span class="n">TaurusEventType</span>

<span class="kn">from</span> <span class="nn">taurus.core.tango.tangovalidator</span> <span class="kn">import</span> <span class="n">TangoAttributeNameValidator</span><span class="p">,</span> \
    <span class="n">TangoDeviceNameValidator</span>
<span class="kn">from</span> <span class="nn">taurus.core.util.log</span> <span class="kn">import</span> <span class="n">Logger</span>
<span class="kn">from</span> <span class="nn">taurus.core.util.codecs</span> <span class="kn">import</span> <span class="n">CodecFactory</span>
<span class="kn">from</span> <span class="nn">taurus.core.util.containers</span> <span class="kn">import</span> <span class="n">CaselessDict</span>
<span class="kn">from</span> <span class="nn">taurus.core.util.event</span> <span class="kn">import</span> <span class="n">EventGenerator</span><span class="p">,</span> <span class="n">AttributeEventWait</span><span class="p">,</span> \
    <span class="n">AttributeEventIterator</span>
<span class="kn">from</span> <span class="nn">taurus.core.tango</span> <span class="kn">import</span> <span class="n">TangoDevice</span><span class="p">,</span> <span class="n">FROM_TANGO_TO_STR_TYPE</span>

<span class="kn">from</span> <span class="nn">sardana</span> <span class="kn">import</span> <span class="n">sardanacustomsettings</span>
<span class="kn">from</span> <span class="nn">.sardana</span> <span class="kn">import</span> <span class="n">BaseSardanaElementContainer</span><span class="p">,</span> <span class="n">BaseSardanaElement</span>
<span class="kn">from</span> <span class="nn">.motion</span> <span class="kn">import</span> <span class="n">Moveable</span><span class="p">,</span> <span class="n">MoveableSource</span>

<span class="kn">from</span> <span class="nn">sardana.pool</span> <span class="kn">import</span> <span class="n">AcqSynchType</span>
<span class="kn">from</span> <span class="nn">sardana.taurus.core.tango.sardana</span> <span class="kn">import</span> <span class="n">PlotType</span>

<span class="n">Ready</span> <span class="o">=</span> <span class="n">Standby</span> <span class="o">=</span> <span class="n">DevState</span><span class="o">.</span><span class="n">ON</span>
<span class="n">Counting</span> <span class="o">=</span> <span class="n">Acquiring</span> <span class="o">=</span> <span class="n">Moving</span> <span class="o">=</span> <span class="n">DevState</span><span class="o">.</span><span class="n">MOVING</span>
<span class="n">Alarm</span> <span class="o">=</span> <span class="n">DevState</span><span class="o">.</span><span class="n">ALARM</span>
<span class="n">Fault</span> <span class="o">=</span> <span class="n">DevState</span><span class="o">.</span><span class="n">FAULT</span>

<span class="n">CHANGE_EVT_TYPES</span> <span class="o">=</span> <span class="n">TaurusEventType</span><span class="o">.</span><span class="n">Change</span><span class="p">,</span> <span class="n">TaurusEventType</span><span class="o">.</span><span class="n">Periodic</span>

<span class="n">MOVEABLE_TYPES</span> <span class="o">=</span> <span class="s1">&#39;Motor&#39;</span><span class="p">,</span> <span class="s1">&#39;PseudoMotor&#39;</span><span class="p">,</span> <span class="s1">&#39;MotorGroup&#39;</span>

<span class="n">QUALITY</span> <span class="o">=</span> <span class="p">{</span>
    <span class="n">AttrQuality</span><span class="o">.</span><span class="n">ATTR_VALID</span><span class="p">:</span> <span class="s1">&#39;VALID&#39;</span><span class="p">,</span>
    <span class="n">AttrQuality</span><span class="o">.</span><span class="n">ATTR_INVALID</span><span class="p">:</span> <span class="s1">&#39;INVALID&#39;</span><span class="p">,</span>
    <span class="n">AttrQuality</span><span class="o">.</span><span class="n">ATTR_CHANGING</span><span class="p">:</span> <span class="s1">&#39;CHANGING&#39;</span><span class="p">,</span>
    <span class="n">AttrQuality</span><span class="o">.</span><span class="n">ATTR_WARNING</span><span class="p">:</span> <span class="s1">&#39;WARNING&#39;</span><span class="p">,</span>
    <span class="n">AttrQuality</span><span class="o">.</span><span class="n">ATTR_ALARM</span><span class="p">:</span> <span class="s1">&#39;ALARM&#39;</span><span class="p">,</span>
    <span class="kc">None</span><span class="p">:</span> <span class="s1">&#39;UNKNOWN&#39;</span>
<span class="p">}</span>


<span class="k">def</span> <span class="nf">_is_referable</span><span class="p">(</span><span class="n">channel</span><span class="p">):</span>
    <span class="c1"># Equivalent to ExpChannel.isReferable.</span>
    <span class="c1"># Use DeviceProxy instead of taurus to avoid crashes in Py3</span>
    <span class="c1"># See: tango-controls/pytango#292</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">channel</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
        <span class="n">channel</span> <span class="o">=</span> <span class="n">DeviceProxy</span><span class="p">(</span><span class="n">channel</span><span class="p">)</span>
    <span class="k">return</span> <span class="s2">&quot;valueref&quot;</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">str</span><span class="o">.</span><span class="n">lower</span><span class="p">,</span> <span class="n">channel</span><span class="o">.</span><span class="n">get_attribute_list</span><span class="p">()))</span>


<span class="k">class</span> <span class="nc">InterruptException</span><span class="p">(</span><span class="ne">Exception</span><span class="p">):</span>
    <span class="k">pass</span>


<span class="k">class</span> <span class="nc">StopException</span><span class="p">(</span><span class="n">InterruptException</span><span class="p">):</span>
    <span class="k">pass</span>


<span class="k">class</span> <span class="nc">AbortException</span><span class="p">(</span><span class="n">InterruptException</span><span class="p">):</span>
    <span class="k">pass</span>


<span class="k">class</span> <span class="nc">ReleaseException</span><span class="p">(</span><span class="n">InterruptException</span><span class="p">):</span>
    <span class="k">pass</span>


<div class="viewcode-block" id="BaseElement"><a class="viewcode-back" href="../../../../../../devel/api/sardana/taurus/core/tango/sardana/pool.html#sardana.taurus.core.tango.sardana.pool.BaseElement">[docs]</a><span class="k">class</span> <span class="nc">BaseElement</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; The base class for elements in the Pool (Pool itself, Motor,</span>
<span class="sd">    ControllerClass, ExpChannel all should inherit from this class directly or</span>
<span class="sd">    indirectly)</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">pd</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getPoolData</span><span class="p">()</span>
        <span class="k">return</span> <span class="s2">&quot;</span><span class="si">{0}</span><span class="s2">(</span><span class="si">{1}</span><span class="s2">)&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">pd</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">],</span> <span class="n">pd</span><span class="p">[</span><span class="s1">&#39;full_name&#39;</span><span class="p">])</span>

    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">getName</span><span class="p">()</span>

<div class="viewcode-block" id="BaseElement.serialize"><a class="viewcode-back" href="../../../../../../devel/api/sardana/taurus/core/tango/sardana/pool.html#sardana.taurus.core.tango.sardana.pool.BaseElement.serialize">[docs]</a>    <span class="k">def</span> <span class="nf">serialize</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">getPoolData</span><span class="p">()</span></div>

<div class="viewcode-block" id="BaseElement.str"><a class="viewcode-back" href="../../../../../../devel/api/sardana/taurus/core/tango/sardana/pool.html#sardana.taurus.core.tango.sardana.pool.BaseElement.str">[docs]</a>    <span class="k">def</span> <span class="nf">str</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns a sequence of strings representing the object in</span>
<span class="sd">        &#39;consistent&#39; way.</span>
<span class="sd">        Default is to return &lt;name&gt;, &lt;controller name&gt;, &lt;axis&gt;</span>

<span class="sd">        :param n: the number of elements in the tuple.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">n</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">CodecFactory</span><span class="o">.</span><span class="n">encode</span><span class="p">((</span><span class="s1">&#39;json&#39;</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">serialize</span><span class="p">())</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_str_tuple</span><span class="p">[:</span><span class="n">n</span><span class="p">]</span></div>

    <span class="k">def</span> <span class="fm">__lt__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">o</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">getPoolData</span><span class="p">()[</span><span class="s1">&#39;full_name&#39;</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">o</span><span class="o">.</span><span class="n">getPoolData</span><span class="p">()[</span><span class="s1">&#39;full_name&#39;</span><span class="p">]</span>

<div class="viewcode-block" id="BaseElement.getName"><a class="viewcode-back" href="../../../../../../devel/api/sardana/taurus/core/tango/sardana/pool.html#sardana.taurus.core.tango.sardana.pool.BaseElement.getName">[docs]</a>    <span class="k">def</span> <span class="nf">getName</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">getPoolData</span><span class="p">()[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span></div>

<div class="viewcode-block" id="BaseElement.getPoolObj"><a class="viewcode-back" href="../../../../../../devel/api/sardana/taurus/core/tango/sardana/pool.html#sardana.taurus.core.tango.sardana.pool.BaseElement.getPoolObj">[docs]</a>    <span class="k">def</span> <span class="nf">getPoolObj</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get reference to this object&#39;s Pool.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_pool_obj</span></div>

<div class="viewcode-block" id="BaseElement.getPoolData"><a class="viewcode-back" href="../../../../../../devel/api/sardana/taurus/core/tango/sardana/pool.html#sardana.taurus.core.tango.sardana.pool.BaseElement.getPoolData">[docs]</a>    <span class="k">def</span> <span class="nf">getPoolData</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get reference to this object&#39;s Pool data.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_pool_data</span></div></div>


<div class="viewcode-block" id="ControllerClass"><a class="viewcode-back" href="../../../../../../devel/api/sardana/taurus/core/tango/sardana/pool.html#sardana.taurus.core.tango.sardana.pool.ControllerClass">[docs]</a><span class="k">class</span> <span class="nc">ControllerClass</span><span class="p">(</span><span class="n">BaseElement</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="vm">__dict__</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">kw</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">path</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">f_name</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">file_name</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lib_name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ext</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">splitext</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">f_name</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">pd</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getPoolData</span><span class="p">()</span>
        <span class="k">return</span> <span class="s2">&quot;ControllerClass(</span><span class="si">{0}</span><span class="s2">)&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">pd</span><span class="p">[</span><span class="s1">&#39;full_name&#39;</span><span class="p">])</span>

<div class="viewcode-block" id="ControllerClass.getSimpleFileName"><a class="viewcode-back" href="../../../../../../devel/api/sardana/taurus/core/tango/sardana/pool.html#sardana.taurus.core.tango.sardana.pool.ControllerClass.getSimpleFileName">[docs]</a>    <span class="k">def</span> <span class="nf">getSimpleFileName</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">f_name</span></div>

<div class="viewcode-block" id="ControllerClass.getFileName"><a class="viewcode-back" href="../../../../../../devel/api/sardana/taurus/core/tango/sardana/pool.html#sardana.taurus.core.tango.sardana.pool.ControllerClass.getFileName">[docs]</a>    <span class="k">def</span> <span class="nf">getFileName</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">file_name</span></div>

<div class="viewcode-block" id="ControllerClass.getClassName"><a class="viewcode-back" href="../../../../../../devel/api/sardana/taurus/core/tango/sardana/pool.html#sardana.taurus.core.tango.sardana.pool.ControllerClass.getClassName">[docs]</a>    <span class="k">def</span> <span class="nf">getClassName</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">getName</span><span class="p">()</span></div>

<div class="viewcode-block" id="ControllerClass.getType"><a class="viewcode-back" href="../../../../../../devel/api/sardana/taurus/core/tango/sardana/pool.html#sardana.taurus.core.tango.sardana.pool.ControllerClass.getType">[docs]</a>    <span class="k">def</span> <span class="nf">getType</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">getTypes</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span></div>

<div class="viewcode-block" id="ControllerClass.getTypes"><a class="viewcode-back" href="../../../../../../devel/api/sardana/taurus/core/tango/sardana/pool.html#sardana.taurus.core.tango.sardana.pool.ControllerClass.getTypes">[docs]</a>    <span class="k">def</span> <span class="nf">getTypes</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">types</span></div>

<div class="viewcode-block" id="ControllerClass.getLib"><a class="viewcode-back" href="../../../../../../devel/api/sardana/taurus/core/tango/sardana/pool.html#sardana.taurus.core.tango.sardana.pool.ControllerClass.getLib">[docs]</a>    <span class="k">def</span> <span class="nf">getLib</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">f_name</span></div>

<div class="viewcode-block" id="ControllerClass.getGender"><a class="viewcode-back" href="../../../../../../devel/api/sardana/taurus/core/tango/sardana/pool.html#sardana.taurus.core.tango.sardana.pool.ControllerClass.getGender">[docs]</a>    <span class="k">def</span> <span class="nf">getGender</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">gender</span></div>

<div class="viewcode-block" id="ControllerClass.getModel"><a class="viewcode-back" href="../../../../../../devel/api/sardana/taurus/core/tango/sardana/pool.html#sardana.taurus.core.tango.sardana.pool.ControllerClass.getModel">[docs]</a>    <span class="k">def</span> <span class="nf">getModel</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span></div>

<div class="viewcode-block" id="ControllerClass.getOrganization"><a class="viewcode-back" href="../../../../../../devel/api/sardana/taurus/core/tango/sardana/pool.html#sardana.taurus.core.tango.sardana.pool.ControllerClass.getOrganization">[docs]</a>    <span class="k">def</span> <span class="nf">getOrganization</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">organization</span></div>

    <span class="k">def</span> <span class="fm">__lt__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">o</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">getType</span><span class="p">()</span> <span class="o">!=</span> <span class="n">o</span><span class="o">.</span><span class="n">getType</span><span class="p">():</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">getType</span><span class="p">()</span> <span class="o">&lt;</span> <span class="n">o</span><span class="o">.</span><span class="n">getType</span><span class="p">()</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">getGender</span><span class="p">()</span> <span class="o">!=</span> <span class="n">o</span><span class="o">.</span><span class="n">getGender</span><span class="p">():</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">getGender</span><span class="p">()</span> <span class="o">&lt;</span> <span class="n">o</span><span class="o">.</span><span class="n">getGender</span><span class="p">()</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">getClassName</span><span class="p">()</span> <span class="o">&lt;</span> <span class="n">o</span><span class="o">.</span><span class="n">getClassName</span><span class="p">()</span></div>


<span class="k">class</span> <span class="nc">ControllerLibrary</span><span class="p">(</span><span class="n">BaseElement</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="vm">__dict__</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">kw</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">getType</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">getTypes</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>

    <span class="k">def</span> <span class="nf">getTypes</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">type</span>


<span class="k">class</span> <span class="nc">TangoAttributeEG</span><span class="p">(</span><span class="n">Logger</span><span class="p">,</span> <span class="n">EventGenerator</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;An event generator for a &#39;State&#39; attribute&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">attr</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_attr</span> <span class="o">=</span> <span class="n">attr</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">call__init__</span><span class="p">(</span><span class="n">Logger</span><span class="p">,</span> <span class="s1">&#39;EG&#39;</span><span class="p">,</span> <span class="n">attr</span><span class="p">)</span>
        <span class="n">event_name</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%s</span><span class="s1"> EG&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">attr</span><span class="o">.</span><span class="n">getParentObj</span><span class="p">()</span><span class="o">.</span><span class="n">getNormalName</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">call__init__</span><span class="p">(</span><span class="n">EventGenerator</span><span class="p">,</span> <span class="n">event_name</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_attr</span><span class="o">.</span><span class="n">addListener</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">getAttribute</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_attr</span>

    <span class="k">def</span> <span class="nf">eventReceived</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">evt_src</span><span class="p">,</span> <span class="n">evt_type</span><span class="p">,</span> <span class="n">evt_value</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Event handler from Taurus&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">evt_type</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">CHANGE_EVT_TYPES</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="k">if</span> <span class="n">evt_value</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">v</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">v</span> <span class="o">=</span> <span class="n">evt_value</span><span class="o">.</span><span class="n">rvalue</span>
            <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="s2">&quot;magnitude&quot;</span><span class="p">):</span>
                <span class="n">v</span> <span class="o">=</span> <span class="n">v</span><span class="o">.</span><span class="n">magnitude</span>
        <span class="n">EventGenerator</span><span class="o">.</span><span class="n">fireEvent</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">read</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">force</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">last_val</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_attr</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">cache</span><span class="o">=</span><span class="ow">not</span> <span class="n">force</span><span class="p">)</span><span class="o">.</span><span class="n">rvalue</span>
            <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">last_val</span><span class="p">,</span> <span class="s2">&quot;magnitude&quot;</span><span class="p">):</span>
                <span class="n">last_val</span> <span class="o">=</span> <span class="n">last_val</span><span class="o">.</span><span class="n">magnitude</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">last_val</span> <span class="o">=</span> <span class="n">last_val</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;Read error&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Details:&quot;</span><span class="p">,</span> <span class="n">exc_info</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">last_val</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">return</span> <span class="n">EventGenerator</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">readValue</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">force</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="n">r</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">force</span><span class="o">=</span><span class="n">force</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">r</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="c1"># do a retry</span>
            <span class="n">r</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">force</span><span class="o">=</span><span class="n">force</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">r</span>

    <span class="k">def</span> <span class="nf">write</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_attr</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">with_read</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__getattr__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_attr</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">reservedOperation</span><span class="p">(</span><span class="n">fn</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">new_fn</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="bp">self</span> <span class="o">=</span> <span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">wr</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getReservedWR</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">wr</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">wr</span><span class="p">()</span><span class="o">.</span><span class="n">isStopped</span><span class="p">():</span>
                <span class="k">raise</span> <span class="n">StopException</span><span class="p">(</span><span class="s2">&quot;stopped before calling </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">fn</span><span class="o">.</span><span class="vm">__name__</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">wr</span><span class="p">()</span><span class="o">.</span><span class="n">isAborted</span><span class="p">():</span>
                <span class="k">raise</span> <span class="n">AbortException</span><span class="p">(</span><span class="s2">&quot;aborted before calling </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">fn</span><span class="o">.</span><span class="vm">__name__</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">fn</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Exception occurred in reserved operation:&quot;</span>
                  <span class="s2">&quot; clearing events...&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_clearEventWait</span><span class="p">()</span>
            <span class="k">raise</span>

    <span class="k">return</span> <span class="n">new_fn</span>


<span class="k">def</span> <span class="nf">get_pool_for_device</span><span class="p">(</span><span class="n">db</span><span class="p">,</span> <span class="n">device</span><span class="p">):</span>
    <span class="n">server_devs</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">get_device_class_list</span><span class="p">(</span><span class="n">device</span><span class="o">.</span><span class="n">info</span><span class="p">()</span><span class="o">.</span><span class="n">server_id</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">dev_name</span><span class="p">,</span> <span class="n">klass_name</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">server_devs</span><span class="p">[</span><span class="mi">0</span><span class="p">::</span><span class="mi">2</span><span class="p">],</span> <span class="n">server_devs</span><span class="p">[</span><span class="mi">1</span><span class="p">::</span><span class="mi">2</span><span class="p">]):</span>
        <span class="k">if</span> <span class="n">klass_name</span> <span class="o">==</span> <span class="s2">&quot;Pool&quot;</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">Device</span><span class="p">(</span><span class="n">dev_name</span><span class="p">)</span>


<div class="viewcode-block" id="PoolElement"><a class="viewcode-back" href="../../../../../../devel/api/sardana/taurus/core/tango/sardana/pool.html#sardana.taurus.core.tango.sardana.pool.PoolElement">[docs]</a><span class="k">class</span> <span class="nc">PoolElement</span><span class="p">(</span><span class="n">BaseElement</span><span class="p">,</span> <span class="n">TangoDevice</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Base class for a Pool element device.&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;PoolElement initialization.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_reserved</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_evt_wait</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__go_start_time</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__go_end_time</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__go_time</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_total_go_time</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">call__init__</span><span class="p">(</span><span class="n">TangoDevice</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

        <span class="c1"># dict&lt;string, TangoAttributeEG&gt;</span>
        <span class="c1"># key : the attribute name</span>
        <span class="c1"># value : the corresponding TangoAttributeEG</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_attrEG</span> <span class="o">=</span> <span class="n">CaselessDict</span><span class="p">()</span>

        <span class="c1"># force the creation of a state attribute</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">getStateEG</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">_find_pool_obj</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">pool</span> <span class="o">=</span> <span class="n">get_pool_for_device</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">getParentObj</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">getDeviceProxy</span><span class="p">())</span>
        <span class="k">return</span> <span class="n">pool</span>

    <span class="k">def</span> <span class="nf">_find_pool_data</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">pool</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_find_pool_obj</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">pool</span><span class="o">.</span><span class="n">getElementInfo</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">getFullName</span><span class="p">())</span><span class="o">.</span><span class="n">_data</span>

    <span class="c1"># Override BaseElement.getPoolObj because the reference to pool object may</span>
    <span class="c1"># not be filled. This reference is filled when the element is obtained</span>
    <span class="c1"># using Pool.getObject. If one obtain the element directly using Taurus</span>
    <span class="c1"># e.g. mot = taurus.Device(&lt;mot_name&gt;) it won&#39;t be filled. In this case</span>
    <span class="c1"># look for the pool object using the database information.</span>
<div class="viewcode-block" id="PoolElement.getPoolObj"><a class="viewcode-back" href="../../../../../../devel/api/sardana/taurus/core/tango/sardana/pool.html#sardana.taurus.core.tango.sardana.pool.PoolElement.getPoolObj">[docs]</a>    <span class="k">def</span> <span class="nf">getPoolObj</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_pool_obj</span>
        <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_pool_obj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_find_pool_obj</span><span class="p">()</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_pool_obj</span></div>

    <span class="c1"># Override BaseElement.getPoolData because the reference to pool data may</span>
    <span class="c1"># not be filled. This reference is filled when the element is obtained</span>
    <span class="c1"># using Pool.getPoolData. If one obtain the element directly using Taurus</span>
    <span class="c1"># e.g. mot = taurus.Device(&lt;mot_name&gt;) it won&#39;t be filled. In this case</span>
    <span class="c1"># look for the pool object and its data using the database information.</span>
<div class="viewcode-block" id="PoolElement.getPoolData"><a class="viewcode-back" href="../../../../../../devel/api/sardana/taurus/core/tango/sardana/pool.html#sardana.taurus.core.tango.sardana.pool.PoolElement.getPoolData">[docs]</a>    <span class="k">def</span> <span class="nf">getPoolData</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_pool_data</span>
        <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_pool_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_find_pool_data</span><span class="p">()</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_pool_data</span></div>

<div class="viewcode-block" id="PoolElement.cleanUp"><a class="viewcode-back" href="../../../../../../devel/api/sardana/taurus/core/tango/sardana/pool.html#sardana.taurus.core.tango.sardana.pool.PoolElement.cleanUp">[docs]</a>    <span class="k">def</span> <span class="nf">cleanUp</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">TangoDevice</span><span class="o">.</span><span class="n">cleanUp</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_reserved</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">f</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">factory</span><span class="p">()</span>

        <span class="n">attr_map</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_attrEG</span>
        <span class="k">for</span> <span class="n">attr_name</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">attr_map</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
            <span class="n">attrEG</span> <span class="o">=</span> <span class="n">attr_map</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">attr_name</span><span class="p">)</span>
            <span class="n">attr</span> <span class="o">=</span> <span class="n">attrEG</span><span class="o">.</span><span class="n">getAttribute</span><span class="p">()</span>
            <span class="n">attrEG</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="n">f</span><span class="o">.</span><span class="n">removeExistingAttribute</span><span class="p">(</span><span class="n">attr</span><span class="p">)</span></div>

<div class="viewcode-block" id="PoolElement.reserve"><a class="viewcode-back" href="../../../../../../devel/api/sardana/taurus/core/tango/sardana/pool.html#sardana.taurus.core.tango.sardana.pool.PoolElement.reserve">[docs]</a>    <span class="k">def</span> <span class="nf">reserve</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">obj</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_reserved</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="k">return</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_reserved</span> <span class="o">=</span> <span class="n">weakref</span><span class="o">.</span><span class="n">ref</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_unreserveCB</span><span class="p">)</span></div>

    <span class="k">def</span> <span class="nf">_unreserveCB</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">unreserve</span><span class="p">()</span>

<div class="viewcode-block" id="PoolElement.unreserve"><a class="viewcode-back" href="../../../../../../devel/api/sardana/taurus/core/tango/sardana/pool.html#sardana.taurus.core.tango.sardana.pool.PoolElement.unreserve">[docs]</a>    <span class="k">def</span> <span class="nf">unreserve</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_reserved</span> <span class="o">=</span> <span class="kc">None</span></div>

<div class="viewcode-block" id="PoolElement.isReserved"><a class="viewcode-back" href="../../../../../../devel/api/sardana/taurus/core/tango/sardana/pool.html#sardana.taurus.core.tango.sardana.pool.PoolElement.isReserved">[docs]</a>    <span class="k">def</span> <span class="nf">isReserved</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">obj</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_reserved</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">o</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_reserved</span><span class="p">()</span>
            <span class="k">return</span> <span class="n">o</span> <span class="o">==</span> <span class="n">obj</span></div>

<div class="viewcode-block" id="PoolElement.getReservedWR"><a class="viewcode-back" href="../../../../../../devel/api/sardana/taurus/core/tango/sardana/pool.html#sardana.taurus.core.tango.sardana.pool.PoolElement.getReservedWR">[docs]</a>    <span class="k">def</span> <span class="nf">getReservedWR</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_reserved</span></div>

<div class="viewcode-block" id="PoolElement.getReserved"><a class="viewcode-back" href="../../../../../../devel/api/sardana/taurus/core/tango/sardana/pool.html#sardana.taurus.core.tango.sardana.pool.PoolElement.getReserved">[docs]</a>    <span class="k">def</span> <span class="nf">getReserved</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_reserved</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_reserved</span><span class="p">()</span></div>

<div class="viewcode-block" id="PoolElement.dump_attributes"><a class="viewcode-back" href="../../../../../../devel/api/sardana/taurus/core/tango/sardana/pool.html#sardana.taurus.core.tango.sardana.pool.PoolElement.dump_attributes">[docs]</a>    <span class="k">def</span> <span class="nf">dump_attributes</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">attr_names</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_attribute_list</span><span class="p">()</span>
        <span class="n">req_id</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">read_attributes_asynch</span><span class="p">(</span><span class="n">attr_names</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">read_attributes_reply</span><span class="p">(</span><span class="n">req_id</span><span class="p">,</span> <span class="mi">2000</span><span class="p">)</span></div>

    <span class="k">def</span> <span class="nf">_getAttrValue</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">force</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="n">attrEG</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_getAttrEG</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">attrEG</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span>
        <span class="k">return</span> <span class="n">attrEG</span><span class="o">.</span><span class="n">readValue</span><span class="p">(</span><span class="n">force</span><span class="o">=</span><span class="n">force</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_getAttrEG</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
        <span class="n">attrEG</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getAttrEG</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">attrEG</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">attrEG</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_createAttribute</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">attrEG</span>

    <span class="k">def</span> <span class="nf">_createAttribute</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
        <span class="n">attrObj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getAttribute</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">attrObj</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;Unable to create attribute </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">name</span><span class="p">)</span>
            <span class="k">return</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span>
        <span class="n">attrEG</span> <span class="o">=</span> <span class="n">TangoAttributeEG</span><span class="p">(</span><span class="n">attrObj</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_attrEG</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">attrEG</span>
        <span class="k">return</span> <span class="n">attrEG</span>

    <span class="k">def</span> <span class="nf">_getEventWait</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_evt_wait</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="c1"># create an object that waits for attribute events.</span>
            <span class="c1"># each time we use it we have to connect and disconnect to an</span>
            <span class="c1"># attribute</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_evt_wait</span> <span class="o">=</span> <span class="n">AttributeEventWait</span><span class="p">()</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_evt_wait</span>

    <span class="k">def</span> <span class="nf">_clearEventWait</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_evt_wait</span> <span class="o">=</span> <span class="kc">None</span>

<div class="viewcode-block" id="PoolElement.getStateEG"><a class="viewcode-back" href="../../../../../../devel/api/sardana/taurus/core/tango/sardana/pool.html#sardana.taurus.core.tango.sardana.pool.PoolElement.getStateEG">[docs]</a>    <span class="k">def</span> <span class="nf">getStateEG</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_getAttrEG</span><span class="p">(</span><span class="s1">&#39;state&#39;</span><span class="p">)</span></div>

<div class="viewcode-block" id="PoolElement.getControllerName"><a class="viewcode-back" href="../../../../../../devel/api/sardana/taurus/core/tango/sardana/pool.html#sardana.taurus.core.tango.sardana.pool.PoolElement.getControllerName">[docs]</a>    <span class="k">def</span> <span class="nf">getControllerName</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">getControllerObj</span><span class="p">()</span><span class="o">.</span><span class="n">name</span></div>

<div class="viewcode-block" id="PoolElement.getControllerObj"><a class="viewcode-back" href="../../../../../../devel/api/sardana/taurus/core/tango/sardana/pool.html#sardana.taurus.core.tango.sardana.pool.PoolElement.getControllerObj">[docs]</a>    <span class="k">def</span> <span class="nf">getControllerObj</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">full_ctrl_name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getPoolData</span><span class="p">()[</span><span class="s1">&#39;controller&#39;</span><span class="p">]</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">getPoolObj</span><span class="p">()</span><span class="o">.</span><span class="n">getObj</span><span class="p">(</span><span class="n">full_ctrl_name</span><span class="p">,</span> <span class="s2">&quot;Controller&quot;</span><span class="p">)</span></div>

<div class="viewcode-block" id="PoolElement.getAxis"><a class="viewcode-back" href="../../../../../../devel/api/sardana/taurus/core/tango/sardana/pool.html#sardana.taurus.core.tango.sardana.pool.PoolElement.getAxis">[docs]</a>    <span class="k">def</span> <span class="nf">getAxis</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">getPoolData</span><span class="p">()[</span><span class="s1">&#39;axis&#39;</span><span class="p">]</span></div>

<div class="viewcode-block" id="PoolElement.getType"><a class="viewcode-back" href="../../../../../../devel/api/sardana/taurus/core/tango/sardana/pool.html#sardana.taurus.core.tango.sardana.pool.PoolElement.getType">[docs]</a>    <span class="k">def</span> <span class="nf">getType</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">getPoolData</span><span class="p">()[</span><span class="s1">&#39;type&#39;</span><span class="p">]</span></div>

<div class="viewcode-block" id="PoolElement.waitReady"><a class="viewcode-back" href="../../../../../../devel/api/sardana/taurus/core/tango/sardana/pool.html#sardana.taurus.core.tango.sardana.pool.PoolElement.waitReady">[docs]</a>    <span class="k">def</span> <span class="nf">waitReady</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">getStateEG</span><span class="p">()</span><span class="o">.</span><span class="n">waitEvent</span><span class="p">(</span><span class="n">Moving</span><span class="p">,</span> <span class="n">equal</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                                           <span class="n">timeout</span><span class="o">=</span><span class="n">timeout</span><span class="p">)</span></div>

<div class="viewcode-block" id="PoolElement.getAttrEG"><a class="viewcode-back" href="../../../../../../devel/api/sardana/taurus/core/tango/sardana/pool.html#sardana.taurus.core.tango.sardana.pool.PoolElement.getAttrEG">[docs]</a>    <span class="k">def</span> <span class="nf">getAttrEG</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns the TangoAttributeEG object&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_attrEG</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">name</span><span class="p">)</span></div>

<div class="viewcode-block" id="PoolElement.getAttrObj"><a class="viewcode-back" href="../../../../../../devel/api/sardana/taurus/core/tango/sardana/pool.html#sardana.taurus.core.tango.sardana.pool.PoolElement.getAttrObj">[docs]</a>    <span class="k">def</span> <span class="nf">getAttrObj</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns the taurus.core.tangoattribute.TangoAttribute object&quot;&quot;&quot;</span>
        <span class="n">attrEG</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_attrEG</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">attrEG</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span>
        <span class="k">return</span> <span class="n">attrEG</span><span class="o">.</span><span class="n">getAttribute</span><span class="p">()</span></div>

<div class="viewcode-block" id="PoolElement.getInstrumentObj"><a class="viewcode-back" href="../../../../../../devel/api/sardana/taurus/core/tango/sardana/pool.html#sardana.taurus.core.tango.sardana.pool.PoolElement.getInstrumentObj">[docs]</a>    <span class="k">def</span> <span class="nf">getInstrumentObj</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_getAttrEG</span><span class="p">(</span><span class="s1">&#39;instrument&#39;</span><span class="p">)</span></div>

<div class="viewcode-block" id="PoolElement.getInstrumentName"><a class="viewcode-back" href="../../../../../../devel/api/sardana/taurus/core/tango/sardana/pool.html#sardana.taurus.core.tango.sardana.pool.PoolElement.getInstrumentName">[docs]</a>    <span class="k">def</span> <span class="nf">getInstrumentName</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">force</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="n">instr_name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_getAttrValue</span><span class="p">(</span><span class="s1">&#39;instrument&#39;</span><span class="p">,</span> <span class="n">force</span><span class="o">=</span><span class="n">force</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">instr_name</span><span class="p">:</span>
            <span class="k">return</span> <span class="s1">&#39;&#39;</span>
        <span class="c1"># instr_name = instr_name[:instr_name.index(&#39;(&#39;)]</span>
        <span class="k">return</span> <span class="n">instr_name</span></div>

<div class="viewcode-block" id="PoolElement.setInstrumentName"><a class="viewcode-back" href="../../../../../../devel/api/sardana/taurus/core/tango/sardana/pool.html#sardana.taurus.core.tango.sardana.pool.PoolElement.setInstrumentName">[docs]</a>    <span class="k">def</span> <span class="nf">setInstrumentName</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">instr_name</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">getInstrumentObj</span><span class="p">()</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">instr_name</span><span class="p">)</span></div>

<div class="viewcode-block" id="PoolElement.getInstrument"><a class="viewcode-back" href="../../../../../../devel/api/sardana/taurus/core/tango/sardana/pool.html#sardana.taurus.core.tango.sardana.pool.PoolElement.getInstrument">[docs]</a>    <span class="k">def</span> <span class="nf">getInstrument</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">instr_name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getInstrumentName</span><span class="p">()</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">instr_name</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">getPoolObj</span><span class="p">()</span><span class="o">.</span><span class="n">getObj</span><span class="p">(</span><span class="s2">&quot;Instrument&quot;</span><span class="p">,</span> <span class="n">instr_name</span><span class="p">)</span></div>

<div class="viewcode-block" id="PoolElement.start"><a class="viewcode-back" href="../../../../../../devel/api/sardana/taurus/core/tango/sardana/pool.html#sardana.taurus.core.tango.sardana.pool.PoolElement.start">[docs]</a>    <span class="nd">@reservedOperation</span>
    <span class="k">def</span> <span class="nf">start</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="n">evt_wait</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_getEventWait</span><span class="p">()</span>
        <span class="n">evt_wait</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">getAttribute</span><span class="p">(</span><span class="s2">&quot;state&quot;</span><span class="p">))</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">evt_wait</span><span class="o">.</span><span class="n">waitEvent</span><span class="p">(</span><span class="n">DevState</span><span class="o">.</span><span class="n">MOVING</span><span class="p">,</span> <span class="n">equal</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__go_time</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__go_start_time</span> <span class="o">=</span> <span class="n">ts1</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_start</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
            <span class="n">ts2</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
            <span class="n">evt_wait</span><span class="o">.</span><span class="n">waitEvent</span><span class="p">(</span><span class="n">DevState</span><span class="o">.</span><span class="n">MOVING</span><span class="p">,</span> <span class="n">after</span><span class="o">=</span><span class="n">ts1</span><span class="p">)</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="n">evt_wait</span><span class="o">.</span><span class="n">disconnect</span><span class="p">()</span>
            <span class="k">raise</span>
        <span class="n">ts2</span> <span class="o">=</span> <span class="n">evt_wait</span><span class="o">.</span><span class="n">getRecordedEvents</span><span class="p">()</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">DevState</span><span class="o">.</span><span class="n">MOVING</span><span class="p">,</span> <span class="n">ts2</span><span class="p">)</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">ts2</span><span class="p">,)</span></div>

<div class="viewcode-block" id="PoolElement.waitFinish"><a class="viewcode-back" href="../../../../../../devel/api/sardana/taurus/core/tango/sardana/pool.html#sardana.taurus.core.tango.sardana.pool.PoolElement.waitFinish">[docs]</a>    <span class="k">def</span> <span class="nf">waitFinish</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="nb">id</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Wait for the operation to finish</span>

<span class="sd">        :param timeout: optional timeout (seconds)</span>
<span class="sd">        :type timeout: float</span>
<span class="sd">        :param id: id of the opertation returned by start</span>
<span class="sd">        :type id: tuple(float)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">timeout</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="c1"># 0.1 s of timeout with infinite retries facilitates aborting</span>
            <span class="c1"># by raising exceptions from a different threads</span>
            <span class="n">timeout</span> <span class="o">=</span> <span class="mf">0.1</span>
            <span class="n">retries</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># Due to taurus-org/taurus #573 we need to divide the timeout</span>
            <span class="c1"># in two intervals</span>
            <span class="n">timeout</span> <span class="o">=</span> <span class="n">timeout</span> <span class="o">/</span> <span class="mi">2</span>
            <span class="n">retries</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="k">if</span> <span class="nb">id</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="nb">id</span> <span class="o">=</span> <span class="nb">id</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">evt_wait</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_getEventWait</span><span class="p">()</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">evt_wait</span><span class="o">.</span><span class="n">waitEvent</span><span class="p">(</span><span class="n">DevState</span><span class="o">.</span><span class="n">MOVING</span><span class="p">,</span> <span class="n">after</span><span class="o">=</span><span class="nb">id</span><span class="p">,</span> <span class="n">equal</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                               <span class="n">timeout</span><span class="o">=</span><span class="n">timeout</span><span class="p">,</span> <span class="n">retries</span><span class="o">=</span><span class="n">retries</span><span class="p">)</span>
        <span class="k">finally</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__go_end_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__go_time</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__go_end_time</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">__go_start_time</span>
            <span class="n">evt_wait</span><span class="o">.</span><span class="n">disconnect</span><span class="p">()</span></div>

<div class="viewcode-block" id="PoolElement.go"><a class="viewcode-back" href="../../../../../../devel/api/sardana/taurus/core/tango/sardana/pool.html#sardana.taurus.core.tango.sardana.pool.PoolElement.go">[docs]</a>    <span class="nd">@reservedOperation</span>
    <span class="k">def</span> <span class="nf">go</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_total_go_time</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">start_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
        <span class="n">eid</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">start</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">timeout</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;timeout&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">waitFinish</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">eid</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="n">timeout</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_total_go_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start_time</span></div>

<div class="viewcode-block" id="PoolElement.getLastGoTime"><a class="viewcode-back" href="../../../../../../devel/api/sardana/taurus/core/tango/sardana/pool.html#sardana.taurus.core.tango.sardana.pool.PoolElement.getLastGoTime">[docs]</a>    <span class="k">def</span> <span class="nf">getLastGoTime</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns the time it took for last go operation&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__go_time</span></div>

<div class="viewcode-block" id="PoolElement.getTotalLastGoTime"><a class="viewcode-back" href="../../../../../../devel/api/sardana/taurus/core/tango/sardana/pool.html#sardana.taurus.core.tango.sardana.pool.PoolElement.getTotalLastGoTime">[docs]</a>    <span class="k">def</span> <span class="nf">getTotalLastGoTime</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns the time it took for last go operation, including dead time</span>
<span class="sd">        to prepare, wait for events, etc&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_total_go_time</span></div>

<div class="viewcode-block" id="PoolElement.abort"><a class="viewcode-back" href="../../../../../../devel/api/sardana/taurus/core/tango/sardana/pool.html#sardana.taurus.core.tango.sardana.pool.PoolElement.abort">[docs]</a>    <span class="k">def</span> <span class="nf">abort</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">wait_ready</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="n">state</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getStateEG</span><span class="p">()</span>
        <span class="n">state</span><span class="o">.</span><span class="n">lock</span><span class="p">()</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">command_inout</span><span class="p">(</span><span class="s2">&quot;Abort&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">wait_ready</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">waitReady</span><span class="p">(</span><span class="n">timeout</span><span class="o">=</span><span class="n">timeout</span><span class="p">)</span>
        <span class="k">finally</span><span class="p">:</span>
            <span class="n">state</span><span class="o">.</span><span class="n">unlock</span><span class="p">()</span></div>

<div class="viewcode-block" id="PoolElement.stop"><a class="viewcode-back" href="../../../../../../devel/api/sardana/taurus/core/tango/sardana/pool.html#sardana.taurus.core.tango.sardana.pool.PoolElement.stop">[docs]</a>    <span class="k">def</span> <span class="nf">stop</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">wait_ready</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="n">state</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getStateEG</span><span class="p">()</span>
        <span class="n">state</span><span class="o">.</span><span class="n">lock</span><span class="p">()</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">command_inout</span><span class="p">(</span><span class="s2">&quot;Stop&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">wait_ready</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">waitReady</span><span class="p">(</span><span class="n">timeout</span><span class="o">=</span><span class="n">timeout</span><span class="p">)</span>
        <span class="k">finally</span><span class="p">:</span>
            <span class="n">state</span><span class="o">.</span><span class="n">unlock</span><span class="p">()</span></div>

<div class="viewcode-block" id="PoolElement.information"><a class="viewcode-back" href="../../../../../../devel/api/sardana/taurus/core/tango/sardana/pool.html#sardana.taurus.core.tango.sardana.pool.PoolElement.information">[docs]</a>    <span class="k">def</span> <span class="nf">information</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tab</span><span class="o">=</span><span class="s1">&#39;    &#39;</span><span class="p">):</span>
        <span class="n">msg</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_information</span><span class="p">(</span><span class="n">tab</span><span class="o">=</span><span class="n">tab</span><span class="p">)</span>
        <span class="k">return</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span></div>

    <span class="k">def</span> <span class="nf">_information</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tab</span><span class="o">=</span><span class="s1">&#39;    &#39;</span><span class="p">):</span>
        <span class="n">indent</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="n">tab</span> <span class="o">+</span> <span class="mi">10</span> <span class="o">*</span> <span class="s1">&#39; &#39;</span>
        <span class="n">msg</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">getName</span><span class="p">()</span> <span class="o">+</span> <span class="s2">&quot;:&quot;</span><span class="p">]</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">t</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
            <span class="n">state_time</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">fromtimestamp</span><span class="p">(</span><span class="n">t</span><span class="p">)</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s2">&quot;%H:%M:%S.</span><span class="si">%f</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="c1"># TODO: use expiration_period=float(&quot;inf&quot;) to always use event</span>
            <span class="c1">#  value (taurus-org/taurus#1105)</span>
            <span class="n">state</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">stateObj</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
            <span class="n">state_time</span> <span class="o">=</span> <span class="n">state</span><span class="o">.</span><span class="n">time</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s2">&quot;%H:%M:%S.</span><span class="si">%f</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="c1"># state_value is DevState enumeration (IntEnum)</span>
            <span class="n">state</span> <span class="o">=</span> <span class="n">state</span><span class="o">.</span><span class="n">rvalue</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">capitalize</span><span class="p">()</span>
        <span class="k">except</span> <span class="n">DevFailed</span> <span class="k">as</span> <span class="n">df</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">args</span><span class="p">):</span>
                <span class="n">state</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">desc</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">e_info</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">exc_info</span><span class="p">()[:</span><span class="mi">2</span><span class="p">]</span>
                <span class="n">state</span> <span class="o">=</span> <span class="n">traceback</span><span class="o">.</span><span class="n">format_exception_only</span><span class="p">(</span><span class="o">*</span><span class="n">e_info</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span>
        <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
            <span class="n">e_info</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">exc_info</span><span class="p">()[:</span><span class="mi">2</span><span class="p">]</span>
            <span class="n">state</span> <span class="o">=</span> <span class="n">traceback</span><span class="o">.</span><span class="n">format_exception_only</span><span class="p">(</span><span class="o">*</span><span class="n">e_info</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span>
        <span class="n">msg</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tab</span> <span class="o">+</span> <span class="s2">&quot;   State: &quot;</span> <span class="o">+</span> <span class="n">state</span> <span class="o">+</span> <span class="s2">&quot; (</span><span class="si">{}</span><span class="s2">)&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">state_time</span><span class="p">))</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">t</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
            <span class="n">status_time</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">fromtimestamp</span><span class="p">(</span><span class="n">t</span><span class="p">)</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s2">&quot;%H:%M:%S.</span><span class="si">%f</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="c1"># TODO: ideally status should come from the event and no extra</span>
            <span class="c1">#  readout should be made</span>
            <span class="n">status</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">read_attribute</span><span class="p">(</span><span class="s2">&quot;status&quot;</span><span class="p">)</span>
            <span class="n">status_time</span> <span class="o">=</span> <span class="n">status</span><span class="o">.</span><span class="n">time</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s2">&quot;%H:%M:%S.</span><span class="si">%f</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="n">status</span> <span class="o">=</span> <span class="n">status</span><span class="o">.</span><span class="n">value</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">indent</span><span class="p">)</span>
        <span class="k">except</span> <span class="n">DevFailed</span> <span class="k">as</span> <span class="n">df</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">args</span><span class="p">):</span>
                <span class="n">status</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">desc</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">e_info</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">exc_info</span><span class="p">()[:</span><span class="mi">2</span><span class="p">]</span>
                <span class="n">status</span> <span class="o">=</span> <span class="n">traceback</span><span class="o">.</span><span class="n">format_exception_only</span><span class="p">(</span><span class="o">*</span><span class="n">e_info</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span>
        <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
            <span class="n">e_info</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">exc_info</span><span class="p">()[:</span><span class="mi">2</span><span class="p">]</span>
            <span class="n">status</span> <span class="o">=</span> <span class="n">traceback</span><span class="o">.</span><span class="n">format_exception_only</span><span class="p">(</span><span class="o">*</span><span class="n">e_info</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span>
        <span class="n">msg</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tab</span> <span class="o">+</span> <span class="s2">&quot;  Status: &quot;</span> <span class="o">+</span> <span class="n">status</span> <span class="o">+</span> <span class="s2">&quot; (</span><span class="si">{}</span><span class="s2">)&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">status_time</span><span class="p">))</span>

        <span class="k">return</span> <span class="n">msg</span></div>


<div class="viewcode-block" id="Controller"><a class="viewcode-back" href="../../../../../../devel/api/sardana/taurus/core/tango/sardana/pool.html#sardana.taurus.core.tango.sardana.pool.Controller">[docs]</a><span class="k">class</span> <span class="nc">Controller</span><span class="p">(</span><span class="n">PoolElement</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Class encapsulating Controller functionality.&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;PoolElement initialization.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">call__init__</span><span class="p">(</span><span class="n">PoolElement</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">)</span>

<div class="viewcode-block" id="Controller.getModuleName"><a class="viewcode-back" href="../../../../../../devel/api/sardana/taurus/core/tango/sardana/pool.html#sardana.taurus.core.tango.sardana.pool.Controller.getModuleName">[docs]</a>    <span class="k">def</span> <span class="nf">getModuleName</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">getPoolData</span><span class="p">()[</span><span class="s1">&#39;module&#39;</span><span class="p">]</span></div>

<div class="viewcode-block" id="Controller.getClassName"><a class="viewcode-back" href="../../../../../../devel/api/sardana/taurus/core/tango/sardana/pool.html#sardana.taurus.core.tango.sardana.pool.Controller.getClassName">[docs]</a>    <span class="k">def</span> <span class="nf">getClassName</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">getPoolData</span><span class="p">()[</span><span class="s1">&#39;klass&#39;</span><span class="p">]</span></div>

<div class="viewcode-block" id="Controller.getTypes"><a class="viewcode-back" href="../../../../../../devel/api/sardana/taurus/core/tango/sardana/pool.html#sardana.taurus.core.tango.sardana.pool.Controller.getTypes">[docs]</a>    <span class="k">def</span> <span class="nf">getTypes</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">getPoolData</span><span class="p">()[</span><span class="s1">&#39;types&#39;</span><span class="p">]</span></div>

<div class="viewcode-block" id="Controller.getMainType"><a class="viewcode-back" href="../../../../../../devel/api/sardana/taurus/core/tango/sardana/pool.html#sardana.taurus.core.tango.sardana.pool.Controller.getMainType">[docs]</a>    <span class="k">def</span> <span class="nf">getMainType</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">getPoolData</span><span class="p">()[</span><span class="s1">&#39;main_type&#39;</span><span class="p">]</span></div>

<div class="viewcode-block" id="Controller.addElement"><a class="viewcode-back" href="../../../../../../devel/api/sardana/taurus/core/tango/sardana/pool.html#sardana.taurus.core.tango.sardana.pool.Controller.addElement">[docs]</a>    <span class="k">def</span> <span class="nf">addElement</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">elem</span><span class="p">):</span>
        <span class="n">axis</span> <span class="o">=</span> <span class="n">elem</span><span class="o">.</span><span class="n">getAxis</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_elems</span><span class="p">[</span><span class="n">axis</span><span class="p">]</span> <span class="o">=</span> <span class="n">elem</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_last_axis</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_last_axis</span><span class="p">,</span> <span class="n">axis</span><span class="p">)</span></div>

<div class="viewcode-block" id="Controller.removeElement"><a class="viewcode-back" href="../../../../../../devel/api/sardana/taurus/core/tango/sardana/pool.html#sardana.taurus.core.tango.sardana.pool.Controller.removeElement">[docs]</a>    <span class="k">def</span> <span class="nf">removeElement</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">elem</span><span class="p">):</span>
        <span class="n">axis</span> <span class="o">=</span> <span class="n">elem</span><span class="o">.</span><span class="n">getAxis</span><span class="p">()</span>
        <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">_elems</span><span class="p">[</span><span class="n">elem</span><span class="o">.</span><span class="n">getAxis</span><span class="p">()]</span>
        <span class="k">if</span> <span class="n">axis</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">_last_axis</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_last_axis</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_elems</span><span class="p">)</span></div>

<div class="viewcode-block" id="Controller.getElementByAxis"><a class="viewcode-back" href="../../../../../../devel/api/sardana/taurus/core/tango/sardana/pool.html#sardana.taurus.core.tango.sardana.pool.Controller.getElementByAxis">[docs]</a>    <span class="k">def</span> <span class="nf">getElementByAxis</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">axis</span><span class="p">):</span>
        <span class="n">pool</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getPoolObj</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">elem</span> <span class="ow">in</span> \
                <span class="nb">list</span><span class="p">(</span><span class="n">pool</span><span class="o">.</span><span class="n">getElementsOfType</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">getMainType</span><span class="p">())</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">elem</span><span class="o">.</span><span class="n">controller</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getFullName</span><span class="p">()</span> <span class="ow">or</span>
                    <span class="n">elem</span><span class="o">.</span><span class="n">getAxis</span><span class="p">()</span> <span class="o">!=</span> <span class="n">axis</span><span class="p">):</span>
                <span class="k">continue</span>
            <span class="k">return</span> <span class="n">elem</span></div>

<div class="viewcode-block" id="Controller.getElementByName"><a class="viewcode-back" href="../../../../../../devel/api/sardana/taurus/core/tango/sardana/pool.html#sardana.taurus.core.tango.sardana.pool.Controller.getElementByName">[docs]</a>    <span class="k">def</span> <span class="nf">getElementByName</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
        <span class="n">pool</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getPoolObj</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">elem</span> <span class="ow">in</span> \
                <span class="nb">list</span><span class="p">(</span><span class="n">pool</span><span class="o">.</span><span class="n">getElementsOfType</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">getMainType</span><span class="p">())</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">elem</span><span class="o">.</span><span class="n">controller</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getFullName</span><span class="p">()</span> <span class="ow">or</span>
                    <span class="n">elem</span><span class="o">.</span><span class="n">getName</span><span class="p">()</span> <span class="o">!=</span> <span class="n">name</span><span class="p">):</span>
                <span class="k">continue</span>
            <span class="k">return</span> <span class="n">elem</span></div>

<div class="viewcode-block" id="Controller.getUsedAxes"><a class="viewcode-back" href="../../../../../../devel/api/sardana/taurus/core/tango/sardana/pool.html#sardana.taurus.core.tango.sardana.pool.Controller.getUsedAxes">[docs]</a>    <span class="k">def</span> <span class="nf">getUsedAxes</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return axes in use by this controller</span>

<span class="sd">        :return: list of axes</span>
<span class="sd">        :rtype: list&lt;int&gt;</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">pool</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getPoolObj</span><span class="p">()</span>
        <span class="n">axes</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">elem</span> <span class="ow">in</span> \
                <span class="nb">list</span><span class="p">(</span><span class="n">pool</span><span class="o">.</span><span class="n">getElementsOfType</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">getMainType</span><span class="p">())</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
            <span class="k">if</span> <span class="n">elem</span><span class="o">.</span><span class="n">controller</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getFullName</span><span class="p">():</span>
                <span class="k">continue</span>
            <span class="n">axes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">elem</span><span class="o">.</span><span class="n">getAxis</span><span class="p">())</span>
        <span class="k">return</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">axes</span><span class="p">)</span></div>

<div class="viewcode-block" id="Controller.getLastUsedAxis"><a class="viewcode-back" href="../../../../../../devel/api/sardana/taurus/core/tango/sardana/pool.html#sardana.taurus.core.tango.sardana.pool.Controller.getLastUsedAxis">[docs]</a>    <span class="k">def</span> <span class="nf">getLastUsedAxis</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return the last used axis (the highest axis) in this controller</span>

<span class="sd">        :return: last used axis</span>
<span class="sd">        :rtype: int or None</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">used_axes</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getUsedAxes</span><span class="p">()</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">used_axes</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span>
        <span class="k">return</span> <span class="nb">max</span><span class="p">(</span><span class="n">used_axes</span><span class="p">)</span></div>

    <span class="k">def</span> <span class="fm">__lt__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">o</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">getName</span><span class="p">()</span> <span class="o">&lt;</span> <span class="n">o</span><span class="o">.</span><span class="n">getName</span><span class="p">()</span></div>


<span class="k">class</span> <span class="nc">ComChannel</span><span class="p">(</span><span class="n">PoolElement</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Class encapsulating CommunicationChannel functionality.&quot;&quot;&quot;</span>
    <span class="k">pass</span>


<div class="viewcode-block" id="ExpChannel"><a class="viewcode-back" href="../../../../../../devel/api/sardana/taurus/core/tango/sardana/pool.html#sardana.taurus.core.tango.sardana.pool.ExpChannel">[docs]</a><span class="k">class</span> <span class="nc">ExpChannel</span><span class="p">(</span><span class="n">PoolElement</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Class encapsulating ExpChannel functionality.&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;ExpChannel initialization.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">call__init__</span><span class="p">(</span><span class="n">PoolElement</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_last_integ_time</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_last_value_ref_pattern</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_last_value_ref_enabled</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_value_buffer</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_value_buffer_cb</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">codec_name</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">sardanacustomsettings</span><span class="p">,</span> <span class="s2">&quot;VALUE_BUFFER_CODEC&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_value_buffer_codec</span> <span class="o">=</span> <span class="n">CodecFactory</span><span class="p">()</span><span class="o">.</span><span class="n">getCodec</span><span class="p">(</span><span class="n">codec_name</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_value_ref_buffer</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_value_ref_buffer_cb</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">codec_name</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">sardanacustomsettings</span><span class="p">,</span> <span class="s2">&quot;VALUE_REF_BUFFER_CODEC&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_value_ref_buffer_codec</span> <span class="o">=</span> <span class="n">CodecFactory</span><span class="p">()</span><span class="o">.</span><span class="n">getCodec</span><span class="p">(</span><span class="n">codec_name</span><span class="p">)</span>

<div class="viewcode-block" id="ExpChannel.isReferable"><a class="viewcode-back" href="../../../../../../devel/api/sardana/taurus/core/tango/sardana/pool.html#sardana.taurus.core.tango.sardana.pool.ExpChannel.isReferable">[docs]</a>    <span class="k">def</span> <span class="nf">isReferable</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="s2">&quot;valueref&quot;</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">str</span><span class="o">.</span><span class="n">lower</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_attribute_list</span><span class="p">())):</span>
            <span class="k">return</span> <span class="kc">True</span>
        <span class="k">return</span> <span class="kc">False</span></div>

<div class="viewcode-block" id="ExpChannel.getIntegrationTime"><a class="viewcode-back" href="../../../../../../devel/api/sardana/taurus/core/tango/sardana/pool.html#sardana.taurus.core.tango.sardana.pool.ExpChannel.getIntegrationTime">[docs]</a>    <span class="k">def</span> <span class="nf">getIntegrationTime</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_getAttrValue</span><span class="p">(</span><span class="s1">&#39;IntegrationTime&#39;</span><span class="p">)</span></div>

<div class="viewcode-block" id="ExpChannel.getIntegrationTimeObj"><a class="viewcode-back" href="../../../../../../devel/api/sardana/taurus/core/tango/sardana/pool.html#sardana.taurus.core.tango.sardana.pool.ExpChannel.getIntegrationTimeObj">[docs]</a>    <span class="k">def</span> <span class="nf">getIntegrationTimeObj</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_getAttrEG</span><span class="p">(</span><span class="s1">&#39;IntegrationTime&#39;</span><span class="p">)</span></div>

<div class="viewcode-block" id="ExpChannel.setIntegrationTime"><a class="viewcode-back" href="../../../../../../devel/api/sardana/taurus/core/tango/sardana/pool.html#sardana.taurus.core.tango.sardana.pool.ExpChannel.setIntegrationTime">[docs]</a>    <span class="k">def</span> <span class="nf">setIntegrationTime</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">integ_time</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">getIntegrationTimeObj</span><span class="p">()</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">integ_time</span><span class="p">)</span></div>

<div class="viewcode-block" id="ExpChannel.putIntegrationTime"><a class="viewcode-back" href="../../../../../../devel/api/sardana/taurus/core/tango/sardana/pool.html#sardana.taurus.core.tango.sardana.pool.ExpChannel.putIntegrationTime">[docs]</a>    <span class="k">def</span> <span class="nf">putIntegrationTime</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">integ_time</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_last_integ_time</span> <span class="o">==</span> <span class="n">integ_time</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_last_integ_time</span> <span class="o">=</span> <span class="n">integ_time</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">getIntegrationTimeObj</span><span class="p">()</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">integ_time</span><span class="p">)</span></div>

<div class="viewcode-block" id="ExpChannel.getValueObj_"><a class="viewcode-back" href="../../../../../../devel/api/sardana/taurus/core/tango/sardana/pool.html#sardana.taurus.core.tango.sardana.pool.ExpChannel.getValueObj_">[docs]</a>    <span class="k">def</span> <span class="nf">getValueObj_</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Retrurns Value attribute event generator object.</span>

<span class="sd">        :return: Value attribute event generator</span>
<span class="sd">        :rtype: TangoAttributeEG</span>

<span class="sd">        ..todo:: When support to Taurus 3 will be dropped provide getValueObj.</span>
<span class="sd">        Taurus 3 TaurusDevice class already uses this name.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_getAttrEG</span><span class="p">(</span><span class="s1">&#39;value&#39;</span><span class="p">)</span></div>

<div class="viewcode-block" id="ExpChannel.getValue"><a class="viewcode-back" href="../../../../../../devel/api/sardana/taurus/core/tango/sardana/pool.html#sardana.taurus.core.tango.sardana.pool.ExpChannel.getValue">[docs]</a>    <span class="k">def</span> <span class="nf">getValue</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">force</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_getAttrValue</span><span class="p">(</span><span class="s1">&#39;value&#39;</span><span class="p">,</span> <span class="n">force</span><span class="o">=</span><span class="n">force</span><span class="p">)</span></div>

<div class="viewcode-block" id="ExpChannel.getValueBufferObj"><a class="viewcode-back" href="../../../../../../devel/api/sardana/taurus/core/tango/sardana/pool.html#sardana.taurus.core.tango.sardana.pool.ExpChannel.getValueBufferObj">[docs]</a>    <span class="k">def</span> <span class="nf">getValueBufferObj</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_getAttrEG</span><span class="p">(</span><span class="s1">&#39;valuebuffer&#39;</span><span class="p">)</span></div>

<div class="viewcode-block" id="ExpChannel.getValueBuffer"><a class="viewcode-back" href="../../../../../../devel/api/sardana/taurus/core/tango/sardana/pool.html#sardana.taurus.core.tango.sardana.pool.ExpChannel.getValueBuffer">[docs]</a>    <span class="k">def</span> <span class="nf">getValueBuffer</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_value_buffer</span></div>

<div class="viewcode-block" id="ExpChannel.valueBufferChanged"><a class="viewcode-back" href="../../../../../../devel/api/sardana/taurus/core/tango/sardana/pool.html#sardana.taurus.core.tango.sardana.pool.ExpChannel.valueBufferChanged">[docs]</a>    <span class="k">def</span> <span class="nf">valueBufferChanged</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value_buffer</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">value_buffer</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="n">_</span><span class="p">,</span> <span class="n">value_buffer</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_value_buffer_codec</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="n">value_buffer</span><span class="p">)</span>
        <span class="n">indexes</span> <span class="o">=</span> <span class="n">value_buffer</span><span class="p">[</span><span class="s2">&quot;index&quot;</span><span class="p">]</span>
        <span class="n">values</span> <span class="o">=</span> <span class="n">value_buffer</span><span class="p">[</span><span class="s2">&quot;value&quot;</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">indexes</span><span class="p">,</span> <span class="n">values</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_value_buffer</span><span class="p">[</span><span class="n">index</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span></div>

<div class="viewcode-block" id="ExpChannel.getValueRefObj"><a class="viewcode-back" href="../../../../../../devel/api/sardana/taurus/core/tango/sardana/pool.html#sardana.taurus.core.tango.sardana.pool.ExpChannel.getValueRefObj">[docs]</a>    <span class="k">def</span> <span class="nf">getValueRefObj</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return ValueRef attribute event generator object.</span>

<span class="sd">        :return: ValueRef attribute event generator</span>
<span class="sd">        :rtype: TangoAttributeEG</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_getAttrEG</span><span class="p">(</span><span class="s1">&#39;value&#39;</span><span class="p">)</span></div>

<div class="viewcode-block" id="ExpChannel.getValueRef"><a class="viewcode-back" href="../../../../../../devel/api/sardana/taurus/core/tango/sardana/pool.html#sardana.taurus.core.tango.sardana.pool.ExpChannel.getValueRef">[docs]</a>    <span class="k">def</span> <span class="nf">getValueRef</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">force</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_getAttrValue</span><span class="p">(</span><span class="s1">&#39;valueref&#39;</span><span class="p">,</span> <span class="n">force</span><span class="o">=</span><span class="n">force</span><span class="p">)</span></div>

<div class="viewcode-block" id="ExpChannel.getValueRefBufferObj"><a class="viewcode-back" href="../../../../../../devel/api/sardana/taurus/core/tango/sardana/pool.html#sardana.taurus.core.tango.sardana.pool.ExpChannel.getValueRefBufferObj">[docs]</a>    <span class="k">def</span> <span class="nf">getValueRefBufferObj</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_getAttrEG</span><span class="p">(</span><span class="s1">&#39;valuerefbuffer&#39;</span><span class="p">)</span></div>

<div class="viewcode-block" id="ExpChannel.getValueRefBuffer"><a class="viewcode-back" href="../../../../../../devel/api/sardana/taurus/core/tango/sardana/pool.html#sardana.taurus.core.tango.sardana.pool.ExpChannel.getValueRefBuffer">[docs]</a>    <span class="k">def</span> <span class="nf">getValueRefBuffer</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_value_ref_buffer</span></div>

<div class="viewcode-block" id="ExpChannel.valueBufferRefChanged"><a class="viewcode-back" href="../../../../../../devel/api/sardana/taurus/core/tango/sardana/pool.html#sardana.taurus.core.tango.sardana.pool.ExpChannel.valueBufferRefChanged">[docs]</a>    <span class="k">def</span> <span class="nf">valueBufferRefChanged</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value_ref_buffer</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">value_ref_buffer</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="n">_</span><span class="p">,</span> <span class="n">value_ref_buffer</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_value_ref_buffercodec</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span>
            <span class="n">value_ref_buffer</span><span class="p">)</span>
        <span class="n">indexes</span> <span class="o">=</span> <span class="n">value_ref_buffer</span><span class="p">[</span><span class="s2">&quot;index&quot;</span><span class="p">]</span>
        <span class="n">value_refs</span> <span class="o">=</span> <span class="n">value_ref_buffer</span><span class="p">[</span><span class="s2">&quot;value_ref&quot;</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">value_ref</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">indexes</span><span class="p">,</span> <span class="n">value_refs</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_value_ref_buffer</span><span class="p">[</span><span class="n">index</span><span class="p">]</span> <span class="o">=</span> <span class="n">value_ref</span></div>

<div class="viewcode-block" id="ExpChannel.getValueRefPattern"><a class="viewcode-back" href="../../../../../../devel/api/sardana/taurus/core/tango/sardana/pool.html#sardana.taurus.core.tango.sardana.pool.ExpChannel.getValueRefPattern">[docs]</a>    <span class="k">def</span> <span class="nf">getValueRefPattern</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_getAttrValue</span><span class="p">(</span><span class="s1">&#39;ValueRefPattern&#39;</span><span class="p">)</span></div>

<div class="viewcode-block" id="ExpChannel.getValueRefPatternObj"><a class="viewcode-back" href="../../../../../../devel/api/sardana/taurus/core/tango/sardana/pool.html#sardana.taurus.core.tango.sardana.pool.ExpChannel.getValueRefPatternObj">[docs]</a>    <span class="k">def</span> <span class="nf">getValueRefPatternObj</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_getAttrEG</span><span class="p">(</span><span class="s1">&#39;ValueRefPattern&#39;</span><span class="p">)</span></div>

<div class="viewcode-block" id="ExpChannel.setValueRefPattern"><a class="viewcode-back" href="../../../../../../devel/api/sardana/taurus/core/tango/sardana/pool.html#sardana.taurus.core.tango.sardana.pool.ExpChannel.setValueRefPattern">[docs]</a>    <span class="k">def</span> <span class="nf">setValueRefPattern</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value_ref_pattern</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">getValueRefPatternObj</span><span class="p">()</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">value_ref_pattern</span><span class="p">)</span></div>

<div class="viewcode-block" id="ExpChannel.putValueRefPattern"><a class="viewcode-back" href="../../../../../../devel/api/sardana/taurus/core/tango/sardana/pool.html#sardana.taurus.core.tango.sardana.pool.ExpChannel.putValueRefPattern">[docs]</a>    <span class="k">def</span> <span class="nf">putValueRefPattern</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value_ref_pattern</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_last_value_ref_pattern</span> <span class="o">==</span> <span class="n">value_ref_pattern</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_last_value_ref_pattern</span> <span class="o">=</span> <span class="n">value_ref_pattern</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">getValueRefPatternObj</span><span class="p">()</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">value_ref_pattern</span><span class="p">)</span></div>

<div class="viewcode-block" id="ExpChannel.isValueRefEnabled"><a class="viewcode-back" href="../../../../../../devel/api/sardana/taurus/core/tango/sardana/pool.html#sardana.taurus.core.tango.sardana.pool.ExpChannel.isValueRefEnabled">[docs]</a>    <span class="k">def</span> <span class="nf">isValueRefEnabled</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_getAttrValue</span><span class="p">(</span><span class="s1">&#39;ValueRefEnabled&#39;</span><span class="p">)</span></div>

<div class="viewcode-block" id="ExpChannel.getValueRefEnabledObj"><a class="viewcode-back" href="../../../../../../devel/api/sardana/taurus/core/tango/sardana/pool.html#sardana.taurus.core.tango.sardana.pool.ExpChannel.getValueRefEnabledObj">[docs]</a>    <span class="k">def</span> <span class="nf">getValueRefEnabledObj</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_getAttrEG</span><span class="p">(</span><span class="s1">&#39;ValueRefEnabled&#39;</span><span class="p">)</span></div>

<div class="viewcode-block" id="ExpChannel.setValueRefEnabled"><a class="viewcode-back" href="../../../../../../devel/api/sardana/taurus/core/tango/sardana/pool.html#sardana.taurus.core.tango.sardana.pool.ExpChannel.setValueRefEnabled">[docs]</a>    <span class="k">def</span> <span class="nf">setValueRefEnabled</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value_ref_enabled</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">getValueRefEnabledObj</span><span class="p">()</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">value_ref_enabled</span><span class="p">)</span></div>

<div class="viewcode-block" id="ExpChannel.putValueRefEnabled"><a class="viewcode-back" href="../../../../../../devel/api/sardana/taurus/core/tango/sardana/pool.html#sardana.taurus.core.tango.sardana.pool.ExpChannel.putValueRefEnabled">[docs]</a>    <span class="k">def</span> <span class="nf">putValueRefEnabled</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value_ref_enabled</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_last_value_ref_enabled</span> <span class="o">==</span> <span class="n">value_ref_enabled</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_last_value_ref_enabled</span> <span class="o">=</span> <span class="n">value_ref_enabled</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">getValueRefEnabledObj</span><span class="p">()</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">value_ref_enabled</span><span class="p">)</span></div>

    <span class="k">def</span> <span class="nf">_start</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Start</span><span class="p">()</span>

<div class="viewcode-block" id="ExpChannel.go"><a class="viewcode-back" href="../../../../../../devel/api/sardana/taurus/core/tango/sardana/pool.html#sardana.taurus.core.tango.sardana.pool.ExpChannel.go">[docs]</a>    <span class="k">def</span> <span class="nf">go</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Count and report count result.</span>

<span class="sd">        Configuration measurement, then start and wait until finish.</span>

<span class="sd">        .. note::</span>
<span class="sd">            The count (go) method API is partially experimental (value</span>
<span class="sd">            references may be changed to values whenever possible in the</span>
<span class="sd">            future). Backwards incompatible changes may occur if deemed</span>
<span class="sd">            necessary by the core developers.</span>

<span class="sd">        :return: state and value (or value reference - experimental)</span>
<span class="sd">        :rtype: :obj:`tuple`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">start_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
        <span class="n">integration_time</span> <span class="o">=</span> <span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">putIntegrationTime</span><span class="p">(</span><span class="n">integration_time</span><span class="p">)</span>
        <span class="n">PoolElement</span><span class="o">.</span><span class="n">go</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="n">state</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getStateEG</span><span class="p">()</span><span class="o">.</span><span class="n">readValue</span><span class="p">()</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">isReferable</span><span class="p">()</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">isValueRefEnabled</span><span class="p">():</span>
            <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getValueRef</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getValue</span><span class="p">()</span>
        <span class="n">ret</span> <span class="o">=</span> <span class="n">state</span><span class="p">,</span> <span class="n">result</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_total_go_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start_time</span>
        <span class="k">return</span> <span class="n">ret</span></div>

    <span class="n">startCount</span> <span class="o">=</span> <span class="n">PoolElement</span><span class="o">.</span><span class="n">start</span>
    <span class="n">waitCount</span> <span class="o">=</span> <span class="n">PoolElement</span><span class="o">.</span><span class="n">waitFinish</span>
    <span class="n">count</span> <span class="o">=</span> <span class="n">go</span>
    <span class="n">stopCount</span> <span class="o">=</span> <span class="n">PoolElement</span><span class="o">.</span><span class="n">abort</span>
    <span class="n">stop</span> <span class="o">=</span> <span class="n">PoolElement</span><span class="o">.</span><span class="n">stop</span></div>


<span class="k">class</span> <span class="nc">TimerableExpChannel</span><span class="p">(</span><span class="n">ExpChannel</span><span class="p">):</span>

    <span class="k">def</span> <span class="nf">getTimer</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_getAttrValue</span><span class="p">(</span><span class="s1">&#39;Timer&#39;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">getTimerObj</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_getAttrEG</span><span class="p">(</span><span class="s1">&#39;Timer&#39;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">setTimer</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">timer</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">getTimerObj</span><span class="p">()</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">timer</span><span class="p">)</span>


<div class="viewcode-block" id="CTExpChannel"><a class="viewcode-back" href="../../../../../../devel/api/sardana/taurus/core/tango/sardana/pool.html#sardana.taurus.core.tango.sardana.pool.CTExpChannel">[docs]</a><span class="k">class</span> <span class="nc">CTExpChannel</span><span class="p">(</span><span class="n">TimerableExpChannel</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Class encapsulating CTExpChannel functionality.&quot;&quot;&quot;</span>
    <span class="k">pass</span></div>


<div class="viewcode-block" id="ZeroDExpChannel"><a class="viewcode-back" href="../../../../../../devel/api/sardana/taurus/core/tango/sardana/pool.html#sardana.taurus.core.tango.sardana.pool.ZeroDExpChannel">[docs]</a><span class="k">class</span> <span class="nc">ZeroDExpChannel</span><span class="p">(</span><span class="n">ExpChannel</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Class encapsulating ZeroDExpChannel functionality.&quot;&quot;&quot;</span>
    <span class="k">pass</span></div>


<div class="viewcode-block" id="OneDExpChannel"><a class="viewcode-back" href="../../../../../../devel/api/sardana/taurus/core/tango/sardana/pool.html#sardana.taurus.core.tango.sardana.pool.OneDExpChannel">[docs]</a><span class="k">class</span> <span class="nc">OneDExpChannel</span><span class="p">(</span><span class="n">TimerableExpChannel</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Class encapsulating OneDExpChannel functionality.&quot;&quot;&quot;</span>
    <span class="k">pass</span></div>


<div class="viewcode-block" id="TwoDExpChannel"><a class="viewcode-back" href="../../../../../../devel/api/sardana/taurus/core/tango/sardana/pool.html#sardana.taurus.core.tango.sardana.pool.TwoDExpChannel">[docs]</a><span class="k">class</span> <span class="nc">TwoDExpChannel</span><span class="p">(</span><span class="n">TimerableExpChannel</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Class encapsulating TwoDExpChannel functionality.&quot;&quot;&quot;</span>
    <span class="k">pass</span></div>


<div class="viewcode-block" id="PseudoCounter"><a class="viewcode-back" href="../../../../../../devel/api/sardana/taurus/core/tango/sardana/pool.html#sardana.taurus.core.tango.sardana.pool.PseudoCounter">[docs]</a><span class="k">class</span> <span class="nc">PseudoCounter</span><span class="p">(</span><span class="n">ExpChannel</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Class encapsulating PseudoCounter functionality.&quot;&quot;&quot;</span>
    <span class="k">pass</span></div>


<div class="viewcode-block" id="TriggerGate"><a class="viewcode-back" href="../../../../../../devel/api/sardana/taurus/core/tango/sardana/pool.html#sardana.taurus.core.tango.sardana.pool.TriggerGate">[docs]</a><span class="k">class</span> <span class="nc">TriggerGate</span><span class="p">(</span><span class="n">PoolElement</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Class encapsulating TriggerGate functionality.&quot;&quot;&quot;</span>
    <span class="k">pass</span></div>


<div class="viewcode-block" id="Motor"><a class="viewcode-back" href="../../../../../../devel/api/sardana/taurus/core/tango/sardana/pool.html#sardana.taurus.core.tango.sardana.pool.Motor">[docs]</a><span class="k">class</span> <span class="nc">Motor</span><span class="p">(</span><span class="n">PoolElement</span><span class="p">,</span> <span class="n">Moveable</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Class encapsulating Motor functionality.&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;PoolElement initialization.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">call__init__</span><span class="p">(</span><span class="n">PoolElement</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">call__init__</span><span class="p">(</span><span class="n">Moveable</span><span class="p">)</span>

<div class="viewcode-block" id="Motor.getPosition"><a class="viewcode-back" href="../../../../../../devel/api/sardana/taurus/core/tango/sardana/pool.html#sardana.taurus.core.tango.sardana.pool.Motor.getPosition">[docs]</a>    <span class="k">def</span> <span class="nf">getPosition</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">force</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_getAttrValue</span><span class="p">(</span><span class="s1">&#39;position&#39;</span><span class="p">,</span> <span class="n">force</span><span class="o">=</span><span class="n">force</span><span class="p">)</span></div>

<div class="viewcode-block" id="Motor.getDialPosition"><a class="viewcode-back" href="../../../../../../devel/api/sardana/taurus/core/tango/sardana/pool.html#sardana.taurus.core.tango.sardana.pool.Motor.getDialPosition">[docs]</a>    <span class="k">def</span> <span class="nf">getDialPosition</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">force</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_getAttrValue</span><span class="p">(</span><span class="s1">&#39;dialposition&#39;</span><span class="p">,</span> <span class="n">force</span><span class="o">=</span><span class="n">force</span><span class="p">)</span></div>

<div class="viewcode-block" id="Motor.getVelocity"><a class="viewcode-back" href="../../../../../../devel/api/sardana/taurus/core/tango/sardana/pool.html#sardana.taurus.core.tango.sardana.pool.Motor.getVelocity">[docs]</a>    <span class="k">def</span> <span class="nf">getVelocity</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">force</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_getAttrValue</span><span class="p">(</span><span class="s1">&#39;velocity&#39;</span><span class="p">,</span> <span class="n">force</span><span class="o">=</span><span class="n">force</span><span class="p">)</span></div>

<div class="viewcode-block" id="Motor.getAcceleration"><a class="viewcode-back" href="../../../../../../devel/api/sardana/taurus/core/tango/sardana/pool.html#sardana.taurus.core.tango.sardana.pool.Motor.getAcceleration">[docs]</a>    <span class="k">def</span> <span class="nf">getAcceleration</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">force</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_getAttrValue</span><span class="p">(</span><span class="s1">&#39;acceleration&#39;</span><span class="p">,</span> <span class="n">force</span><span class="o">=</span><span class="n">force</span><span class="p">)</span></div>

<div class="viewcode-block" id="Motor.getDeceleration"><a class="viewcode-back" href="../../../../../../devel/api/sardana/taurus/core/tango/sardana/pool.html#sardana.taurus.core.tango.sardana.pool.Motor.getDeceleration">[docs]</a>    <span class="k">def</span> <span class="nf">getDeceleration</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">force</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_getAttrValue</span><span class="p">(</span><span class="s1">&#39;deceleration&#39;</span><span class="p">,</span> <span class="n">force</span><span class="o">=</span><span class="n">force</span><span class="p">)</span></div>

<div class="viewcode-block" id="Motor.getBaseRate"><a class="viewcode-back" href="../../../../../../devel/api/sardana/taurus/core/tango/sardana/pool.html#sardana.taurus.core.tango.sardana.pool.Motor.getBaseRate">[docs]</a>    <span class="k">def</span> <span class="nf">getBaseRate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">force</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_getAttrValue</span><span class="p">(</span><span class="s1">&#39;base_rate&#39;</span><span class="p">,</span> <span class="n">force</span><span class="o">=</span><span class="n">force</span><span class="p">)</span></div>

<div class="viewcode-block" id="Motor.getBacklash"><a class="viewcode-back" href="../../../../../../devel/api/sardana/taurus/core/tango/sardana/pool.html#sardana.taurus.core.tango.sardana.pool.Motor.getBacklash">[docs]</a>    <span class="k">def</span> <span class="nf">getBacklash</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">force</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_getAttrValue</span><span class="p">(</span><span class="s1">&#39;backlash&#39;</span><span class="p">,</span> <span class="n">force</span><span class="o">=</span><span class="n">force</span><span class="p">)</span></div>

<div class="viewcode-block" id="Motor.getLimitSwitches"><a class="viewcode-back" href="../../../../../../devel/api/sardana/taurus/core/tango/sardana/pool.html#sardana.taurus.core.tango.sardana.pool.Motor.getLimitSwitches">[docs]</a>    <span class="k">def</span> <span class="nf">getLimitSwitches</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">force</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_getAttrValue</span><span class="p">(</span><span class="s1">&#39;limit_switches&#39;</span><span class="p">,</span> <span class="n">force</span><span class="o">=</span><span class="n">force</span><span class="p">)</span></div>

<div class="viewcode-block" id="Motor.getOffset"><a class="viewcode-back" href="../../../../../../devel/api/sardana/taurus/core/tango/sardana/pool.html#sardana.taurus.core.tango.sardana.pool.Motor.getOffset">[docs]</a>    <span class="k">def</span> <span class="nf">getOffset</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">force</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_getAttrValue</span><span class="p">(</span><span class="s1">&#39;offset&#39;</span><span class="p">,</span> <span class="n">force</span><span class="o">=</span><span class="n">force</span><span class="p">)</span></div>

<div class="viewcode-block" id="Motor.getStepPerUnit"><a class="viewcode-back" href="../../../../../../devel/api/sardana/taurus/core/tango/sardana/pool.html#sardana.taurus.core.tango.sardana.pool.Motor.getStepPerUnit">[docs]</a>    <span class="k">def</span> <span class="nf">getStepPerUnit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">force</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_getAttrValue</span><span class="p">(</span><span class="s1">&#39;step_per_unit&#39;</span><span class="p">,</span> <span class="n">force</span><span class="o">=</span><span class="n">force</span><span class="p">)</span></div>

<div class="viewcode-block" id="Motor.getSign"><a class="viewcode-back" href="../../../../../../devel/api/sardana/taurus/core/tango/sardana/pool.html#sardana.taurus.core.tango.sardana.pool.Motor.getSign">[docs]</a>    <span class="k">def</span> <span class="nf">getSign</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">force</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_getAttrValue</span><span class="p">(</span><span class="s1">&#39;Sign&#39;</span><span class="p">,</span> <span class="n">force</span><span class="o">=</span><span class="n">force</span><span class="p">)</span></div>

<div class="viewcode-block" id="Motor.getSimulationMode"><a class="viewcode-back" href="../../../../../../devel/api/sardana/taurus/core/tango/sardana/pool.html#sardana.taurus.core.tango.sardana.pool.Motor.getSimulationMode">[docs]</a>    <span class="k">def</span> <span class="nf">getSimulationMode</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">force</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_getAttrValue</span><span class="p">(</span><span class="s1">&#39;SimulationMode&#39;</span><span class="p">,</span> <span class="n">force</span><span class="o">=</span><span class="n">force</span><span class="p">)</span></div>

<div class="viewcode-block" id="Motor.getPositionObj"><a class="viewcode-back" href="../../../../../../devel/api/sardana/taurus/core/tango/sardana/pool.html#sardana.taurus.core.tango.sardana.pool.Motor.getPositionObj">[docs]</a>    <span class="k">def</span> <span class="nf">getPositionObj</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_getAttrEG</span><span class="p">(</span><span class="s1">&#39;position&#39;</span><span class="p">)</span></div>

<div class="viewcode-block" id="Motor.getDialPositionObj"><a class="viewcode-back" href="../../../../../../devel/api/sardana/taurus/core/tango/sardana/pool.html#sardana.taurus.core.tango.sardana.pool.Motor.getDialPositionObj">[docs]</a>    <span class="k">def</span> <span class="nf">getDialPositionObj</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_getAttrEG</span><span class="p">(</span><span class="s1">&#39;dialposition&#39;</span><span class="p">)</span></div>

<div class="viewcode-block" id="Motor.getVelocityObj"><a class="viewcode-back" href="../../../../../../devel/api/sardana/taurus/core/tango/sardana/pool.html#sardana.taurus.core.tango.sardana.pool.Motor.getVelocityObj">[docs]</a>    <span class="k">def</span> <span class="nf">getVelocityObj</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_getAttrEG</span><span class="p">(</span><span class="s1">&#39;velocity&#39;</span><span class="p">)</span></div>

<div class="viewcode-block" id="Motor.getAccelerationObj"><a class="viewcode-back" href="../../../../../../devel/api/sardana/taurus/core/tango/sardana/pool.html#sardana.taurus.core.tango.sardana.pool.Motor.getAccelerationObj">[docs]</a>    <span class="k">def</span> <span class="nf">getAccelerationObj</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_getAttrEG</span><span class="p">(</span><span class="s1">&#39;acceleration&#39;</span><span class="p">)</span></div>

<div class="viewcode-block" id="Motor.getDecelerationObj"><a class="viewcode-back" href="../../../../../../devel/api/sardana/taurus/core/tango/sardana/pool.html#sardana.taurus.core.tango.sardana.pool.Motor.getDecelerationObj">[docs]</a>    <span class="k">def</span> <span class="nf">getDecelerationObj</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_getAttrEG</span><span class="p">(</span><span class="s1">&#39;deceleration&#39;</span><span class="p">)</span></div>

<div class="viewcode-block" id="Motor.getBaseRateObj"><a class="viewcode-back" href="../../../../../../devel/api/sardana/taurus/core/tango/sardana/pool.html#sardana.taurus.core.tango.sardana.pool.Motor.getBaseRateObj">[docs]</a>    <span class="k">def</span> <span class="nf">getBaseRateObj</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_getAttrEG</span><span class="p">(</span><span class="s1">&#39;base_rate&#39;</span><span class="p">)</span></div>

<div class="viewcode-block" id="Motor.getBacklashObj"><a class="viewcode-back" href="../../../../../../devel/api/sardana/taurus/core/tango/sardana/pool.html#sardana.taurus.core.tango.sardana.pool.Motor.getBacklashObj">[docs]</a>    <span class="k">def</span> <span class="nf">getBacklashObj</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_getAttrEG</span><span class="p">(</span><span class="s1">&#39;backlash&#39;</span><span class="p">)</span></div>

<div class="viewcode-block" id="Motor.getLimitSwitchesObj"><a class="viewcode-back" href="../../../../../../devel/api/sardana/taurus/core/tango/sardana/pool.html#sardana.taurus.core.tango.sardana.pool.Motor.getLimitSwitchesObj">[docs]</a>    <span class="k">def</span> <span class="nf">getLimitSwitchesObj</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_getAttrEG</span><span class="p">(</span><span class="s1">&#39;limit_switches&#39;</span><span class="p">)</span></div>

<div class="viewcode-block" id="Motor.getOffsetObj"><a class="viewcode-back" href="../../../../../../devel/api/sardana/taurus/core/tango/sardana/pool.html#sardana.taurus.core.tango.sardana.pool.Motor.getOffsetObj">[docs]</a>    <span class="k">def</span> <span class="nf">getOffsetObj</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_getAttrEG</span><span class="p">(</span><span class="s1">&#39;offset&#39;</span><span class="p">)</span></div>

<div class="viewcode-block" id="Motor.getStepPerUnitObj"><a class="viewcode-back" href="../../../../../../devel/api/sardana/taurus/core/tango/sardana/pool.html#sardana.taurus.core.tango.sardana.pool.Motor.getStepPerUnitObj">[docs]</a>    <span class="k">def</span> <span class="nf">getStepPerUnitObj</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_getAttrEG</span><span class="p">(</span><span class="s1">&#39;step_per_unit&#39;</span><span class="p">)</span></div>

<div class="viewcode-block" id="Motor.getSimulationModeObj"><a class="viewcode-back" href="../../../../../../devel/api/sardana/taurus/core/tango/sardana/pool.html#sardana.taurus.core.tango.sardana.pool.Motor.getSimulationModeObj">[docs]</a>    <span class="k">def</span> <span class="nf">getSimulationModeObj</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_getAttrEG</span><span class="p">(</span><span class="s1">&#39;step_per_unit&#39;</span><span class="p">)</span></div>

<div class="viewcode-block" id="Motor.setVelocity"><a class="viewcode-back" href="../../../../../../devel/api/sardana/taurus/core/tango/sardana/pool.html#sardana.taurus.core.tango.sardana.pool.Motor.setVelocity">[docs]</a>    <span class="k">def</span> <span class="nf">setVelocity</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">getVelocityObj</span><span class="p">()</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">value</span><span class="p">)</span></div>

<div class="viewcode-block" id="Motor.setAcceleration"><a class="viewcode-back" href="../../../../../../devel/api/sardana/taurus/core/tango/sardana/pool.html#sardana.taurus.core.tango.sardana.pool.Motor.setAcceleration">[docs]</a>    <span class="k">def</span> <span class="nf">setAcceleration</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">getAccelerationObj</span><span class="p">()</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">value</span><span class="p">)</span></div>

<div class="viewcode-block" id="Motor.setDeceleration"><a class="viewcode-back" href="../../../../../../devel/api/sardana/taurus/core/tango/sardana/pool.html#sardana.taurus.core.tango.sardana.pool.Motor.setDeceleration">[docs]</a>    <span class="k">def</span> <span class="nf">setDeceleration</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">getDecelerationObj</span><span class="p">()</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">value</span><span class="p">)</span></div>

<div class="viewcode-block" id="Motor.setBaseRate"><a class="viewcode-back" href="../../../../../../devel/api/sardana/taurus/core/tango/sardana/pool.html#sardana.taurus.core.tango.sardana.pool.Motor.setBaseRate">[docs]</a>    <span class="k">def</span> <span class="nf">setBaseRate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">getBaseRateObj</span><span class="p">()</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">value</span><span class="p">)</span></div>

<div class="viewcode-block" id="Motor.setBacklash"><a class="viewcode-back" href="../../../../../../devel/api/sardana/taurus/core/tango/sardana/pool.html#sardana.taurus.core.tango.sardana.pool.Motor.setBacklash">[docs]</a>    <span class="k">def</span> <span class="nf">setBacklash</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">getBacklashObj</span><span class="p">()</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">value</span><span class="p">)</span></div>

<div class="viewcode-block" id="Motor.setOffset"><a class="viewcode-back" href="../../../../../../devel/api/sardana/taurus/core/tango/sardana/pool.html#sardana.taurus.core.tango.sardana.pool.Motor.setOffset">[docs]</a>    <span class="k">def</span> <span class="nf">setOffset</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">getOffsetObj</span><span class="p">()</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">value</span><span class="p">)</span></div>

<div class="viewcode-block" id="Motor.setStepPerUnit"><a class="viewcode-back" href="../../../../../../devel/api/sardana/taurus/core/tango/sardana/pool.html#sardana.taurus.core.tango.sardana.pool.Motor.setStepPerUnit">[docs]</a>    <span class="k">def</span> <span class="nf">setStepPerUnit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">getStepPerUnitObj</span><span class="p">()</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">value</span><span class="p">)</span></div>

<div class="viewcode-block" id="Motor.setSign"><a class="viewcode-back" href="../../../../../../devel/api/sardana/taurus/core/tango/sardana/pool.html#sardana.taurus.core.tango.sardana.pool.Motor.setSign">[docs]</a>    <span class="k">def</span> <span class="nf">setSign</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">getSignObj</span><span class="p">()</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">value</span><span class="p">)</span></div>

    <span class="c1"># -~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-</span>
    <span class="c1"># Moveable interface</span>
    <span class="c1">#</span>

    <span class="k">def</span> <span class="nf">_start</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="n">new_pos</span> <span class="o">=</span> <span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">new_pos</span><span class="p">,</span> <span class="n">collections</span><span class="o">.</span><span class="n">Sequence</span><span class="p">):</span>
            <span class="n">new_pos</span> <span class="o">=</span> <span class="n">new_pos</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">write_attribute</span><span class="p">(</span><span class="s1">&#39;position&#39;</span><span class="p">,</span> <span class="n">new_pos</span><span class="p">)</span>
        <span class="k">except</span> <span class="n">DevFailed</span> <span class="k">as</span> <span class="n">df</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">err</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">args</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">err</span><span class="o">.</span><span class="n">reason</span> <span class="o">==</span> <span class="s1">&#39;API_AttrNotAllowed&#39;</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%s</span><span class="s1"> is already moving&#39;</span> <span class="o">%</span> <span class="bp">self</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">raise</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">final_pos</span> <span class="o">=</span> <span class="n">new_pos</span>

<div class="viewcode-block" id="Motor.go"><a class="viewcode-back" href="../../../../../../devel/api/sardana/taurus/core/tango/sardana/pool.html#sardana.taurus.core.tango.sardana.pool.Motor.go">[docs]</a>    <span class="k">def</span> <span class="nf">go</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="n">start_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
        <span class="n">PoolElement</span><span class="o">.</span><span class="n">go</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">ret</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getStateEG</span><span class="p">()</span><span class="o">.</span><span class="n">readValue</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">readPosition</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_total_go_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start_time</span>
        <span class="k">return</span> <span class="n">ret</span></div>

    <span class="n">startMove</span> <span class="o">=</span> <span class="n">PoolElement</span><span class="o">.</span><span class="n">start</span>
    <span class="n">waitMove</span> <span class="o">=</span> <span class="n">PoolElement</span><span class="o">.</span><span class="n">waitFinish</span>
    <span class="n">move</span> <span class="o">=</span> <span class="n">go</span>
    <span class="n">getLastMotionTime</span> <span class="o">=</span> <span class="n">PoolElement</span><span class="o">.</span><span class="n">getLastGoTime</span>
    <span class="n">getTotalLastMotionTime</span> <span class="o">=</span> <span class="n">PoolElement</span><span class="o">.</span><span class="n">getTotalLastGoTime</span>

<div class="viewcode-block" id="Motor.iterMove"><a class="viewcode-back" href="../../../../../../devel/api/sardana/taurus/core/tango/sardana/pool.html#sardana.taurus.core.tango.sardana.pool.Motor.iterMove">[docs]</a>    <span class="nd">@reservedOperation</span>
    <span class="k">def</span> <span class="nf">iterMove</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">new_pos</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">new_pos</span><span class="p">,</span> <span class="n">collections</span><span class="o">.</span><span class="n">Sequence</span><span class="p">):</span>
            <span class="n">new_pos</span> <span class="o">=</span> <span class="n">new_pos</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">state</span><span class="p">,</span> <span class="n">pos</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getAttribute</span><span class="p">(</span><span class="s2">&quot;state&quot;</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">getAttribute</span><span class="p">(</span><span class="s2">&quot;position&quot;</span><span class="p">)</span>

        <span class="n">evt_wait</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_getEventWait</span><span class="p">()</span>
        <span class="n">evt_wait</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">state</span><span class="p">)</span>
        <span class="n">evt_wait</span><span class="o">.</span><span class="n">lock</span><span class="p">()</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="c1"># evt_wait.waitEvent(DevState.MOVING, equal=False)</span>
            <span class="n">time_stamp</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">getPositionObj</span><span class="p">()</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">new_pos</span><span class="p">)</span>
            <span class="k">except</span> <span class="n">DevFailed</span> <span class="k">as</span> <span class="n">err_traceback</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">err</span> <span class="ow">in</span> <span class="n">err_traceback</span><span class="o">.</span><span class="n">args</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">err</span><span class="o">.</span><span class="n">reason</span> <span class="o">==</span> <span class="s1">&#39;API_AttrNotAllowed&#39;</span><span class="p">:</span>
                        <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%s</span><span class="s1"> is already moving&#39;</span> <span class="o">%</span> <span class="bp">self</span><span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="k">raise</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">final_pos</span> <span class="o">=</span> <span class="n">new_pos</span>
            <span class="c1"># putting timeout=0.1 and retries=1 is a patch for the case when</span>
            <span class="c1"># the initial moving event doesn&#39;t arrive do to an unknown</span>
            <span class="c1"># tango/pytango error at the time</span>
            <span class="n">evt_wait</span><span class="o">.</span><span class="n">waitEvent</span><span class="p">(</span><span class="n">DevState</span><span class="o">.</span><span class="n">MOVING</span><span class="p">,</span> <span class="n">time_stamp</span><span class="p">,</span>
                               <span class="n">timeout</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">retries</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="k">finally</span><span class="p">:</span>
            <span class="n">evt_wait</span><span class="o">.</span><span class="n">unlock</span><span class="p">()</span>
            <span class="n">evt_wait</span><span class="o">.</span><span class="n">disconnect</span><span class="p">()</span>

        <span class="n">evt_iter_wait</span> <span class="o">=</span> <span class="n">AttributeEventIterator</span><span class="p">(</span><span class="n">state</span><span class="p">,</span> <span class="n">pos</span><span class="p">)</span>
        <span class="n">evt_iter_wait</span><span class="o">.</span><span class="n">lock</span><span class="p">()</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">evt_data</span> <span class="ow">in</span> <span class="n">evt_iter_wait</span><span class="o">.</span><span class="n">events</span><span class="p">():</span>
                <span class="n">src</span><span class="p">,</span> <span class="n">value</span> <span class="o">=</span> <span class="n">evt_data</span>
                <span class="k">if</span> <span class="n">src</span> <span class="o">==</span> <span class="n">state</span> <span class="ow">and</span> <span class="n">value</span> <span class="o">!=</span> <span class="n">DevState</span><span class="o">.</span><span class="n">MOVING</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">StopIteration</span>
                <span class="k">yield</span> <span class="n">value</span>
        <span class="k">finally</span><span class="p">:</span>
            <span class="n">evt_iter_wait</span><span class="o">.</span><span class="n">unlock</span><span class="p">()</span>
            <span class="n">evt_iter_wait</span><span class="o">.</span><span class="n">disconnect</span><span class="p">()</span></div>

<div class="viewcode-block" id="Motor.readPosition"><a class="viewcode-back" href="../../../../../../devel/api/sardana/taurus/core/tango/sardana/pool.html#sardana.taurus.core.tango.sardana.pool.Motor.readPosition">[docs]</a>    <span class="k">def</span> <span class="nf">readPosition</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">force</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">getPosition</span><span class="p">(</span><span class="n">force</span><span class="o">=</span><span class="n">force</span><span class="p">)]</span></div>

<div class="viewcode-block" id="Motor.getMoveableSource"><a class="viewcode-back" href="../../../../../../devel/api/sardana/taurus/core/tango/sardana/pool.html#sardana.taurus.core.tango.sardana.pool.Motor.getMoveableSource">[docs]</a>    <span class="k">def</span> <span class="nf">getMoveableSource</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">getPoolObj</span><span class="p">()</span></div>

<div class="viewcode-block" id="Motor.getSize"><a class="viewcode-back" href="../../../../../../devel/api/sardana/taurus/core/tango/sardana/pool.html#sardana.taurus.core.tango.sardana.pool.Motor.getSize">[docs]</a>    <span class="k">def</span> <span class="nf">getSize</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="mi">1</span></div>

<div class="viewcode-block" id="Motor.getIndex"><a class="viewcode-back" href="../../../../../../devel/api/sardana/taurus/core/tango/sardana/pool.html#sardana.taurus.core.tango.sardana.pool.Motor.getIndex">[docs]</a>    <span class="k">def</span> <span class="nf">getIndex</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">name</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">getName</span><span class="p">()</span><span class="o">.</span><span class="n">lower</span><span class="p">():</span>
            <span class="k">return</span> <span class="mi">0</span>
        <span class="k">return</span> <span class="o">-</span><span class="mi">1</span></div>

    <span class="c1">#</span>
    <span class="c1"># End of Moveable interface</span>
    <span class="c1"># -~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-</span>

    <span class="k">def</span> <span class="nf">_information</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tab</span><span class="o">=</span><span class="s1">&#39;    &#39;</span><span class="p">):</span>
        <span class="n">msg</span> <span class="o">=</span> <span class="n">PoolElement</span><span class="o">.</span><span class="n">_information</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tab</span><span class="o">=</span><span class="n">tab</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">position</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">read_attribute</span><span class="p">(</span><span class="s2">&quot;position&quot;</span><span class="p">)</span>
            <span class="n">pos</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">position</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">position</span><span class="o">.</span><span class="n">quality</span> <span class="o">!=</span> <span class="n">AttrQuality</span><span class="o">.</span><span class="n">ATTR_VALID</span><span class="p">:</span>
                <span class="n">pos</span> <span class="o">+=</span> <span class="s2">&quot; [&quot;</span> <span class="o">+</span> <span class="n">QUALITY</span><span class="p">[</span><span class="n">position</span><span class="o">.</span><span class="n">quality</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;]&quot;</span>
        <span class="k">except</span> <span class="n">DevFailed</span> <span class="k">as</span> <span class="n">df</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">args</span><span class="p">):</span>
                <span class="n">pos</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">desc</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">e_info</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">exc_info</span><span class="p">()[:</span><span class="mi">2</span><span class="p">]</span>
                <span class="n">pos</span> <span class="o">=</span> <span class="n">traceback</span><span class="o">.</span><span class="n">format_exception_only</span><span class="p">(</span><span class="o">*</span><span class="n">e_info</span><span class="p">)</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="n">e_info</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">exc_info</span><span class="p">()[:</span><span class="mi">2</span><span class="p">]</span>
            <span class="n">pos</span> <span class="o">=</span> <span class="n">traceback</span><span class="o">.</span><span class="n">format_exception_only</span><span class="p">(</span><span class="o">*</span><span class="n">e_info</span><span class="p">)</span>

        <span class="n">msg</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tab</span> <span class="o">+</span> <span class="s2">&quot;Position: &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">pos</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">msg</span></div>


<div class="viewcode-block" id="PseudoMotor"><a class="viewcode-back" href="../../../../../../devel/api/sardana/taurus/core/tango/sardana/pool.html#sardana.taurus.core.tango.sardana.pool.PseudoMotor">[docs]</a><span class="k">class</span> <span class="nc">PseudoMotor</span><span class="p">(</span><span class="n">PoolElement</span><span class="p">,</span> <span class="n">Moveable</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Class encapsulating PseudoMotor functionality.&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;PoolElement initialization.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">call__init__</span><span class="p">(</span><span class="n">PoolElement</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">call__init__</span><span class="p">(</span><span class="n">Moveable</span><span class="p">)</span>

<div class="viewcode-block" id="PseudoMotor.getPosition"><a class="viewcode-back" href="../../../../../../devel/api/sardana/taurus/core/tango/sardana/pool.html#sardana.taurus.core.tango.sardana.pool.PseudoMotor.getPosition">[docs]</a>    <span class="k">def</span> <span class="nf">getPosition</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">force</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_getAttrValue</span><span class="p">(</span><span class="s1">&#39;position&#39;</span><span class="p">,</span> <span class="n">force</span><span class="o">=</span><span class="n">force</span><span class="p">)</span></div>

<div class="viewcode-block" id="PseudoMotor.getDialPosition"><a class="viewcode-back" href="../../../../../../devel/api/sardana/taurus/core/tango/sardana/pool.html#sardana.taurus.core.tango.sardana.pool.PseudoMotor.getDialPosition">[docs]</a>    <span class="k">def</span> <span class="nf">getDialPosition</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">force</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">getPosition</span><span class="p">(</span><span class="n">force</span><span class="o">=</span><span class="n">force</span><span class="p">)</span></div>

<div class="viewcode-block" id="PseudoMotor.getPositionObj"><a class="viewcode-back" href="../../../../../../devel/api/sardana/taurus/core/tango/sardana/pool.html#sardana.taurus.core.tango.sardana.pool.PseudoMotor.getPositionObj">[docs]</a>    <span class="k">def</span> <span class="nf">getPositionObj</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_getAttrEG</span><span class="p">(</span><span class="s1">&#39;position&#39;</span><span class="p">)</span></div>

<div class="viewcode-block" id="PseudoMotor.getDialPositionObj"><a class="viewcode-back" href="../../../../../../devel/api/sardana/taurus/core/tango/sardana/pool.html#sardana.taurus.core.tango.sardana.pool.PseudoMotor.getDialPositionObj">[docs]</a>    <span class="k">def</span> <span class="nf">getDialPositionObj</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">getPositionObj</span><span class="p">()</span></div>

    <span class="c1"># -~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-</span>
    <span class="c1"># Moveable interface</span>
    <span class="c1">#</span>

    <span class="k">def</span> <span class="nf">_start</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="n">new_pos</span> <span class="o">=</span> <span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">new_pos</span><span class="p">,</span> <span class="n">collections</span><span class="o">.</span><span class="n">Sequence</span><span class="p">):</span>
            <span class="n">new_pos</span> <span class="o">=</span> <span class="n">new_pos</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">write_attribute</span><span class="p">(</span><span class="s1">&#39;position&#39;</span><span class="p">,</span> <span class="n">new_pos</span><span class="p">)</span>
        <span class="k">except</span> <span class="n">DevFailed</span> <span class="k">as</span> <span class="n">df</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">err</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">args</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">err</span><span class="o">.</span><span class="n">reason</span> <span class="o">==</span> <span class="s1">&#39;API_AttrNotAllowed&#39;</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%s</span><span class="s1"> is already moving&#39;</span> <span class="o">%</span> <span class="bp">self</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">raise</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">final_pos</span> <span class="o">=</span> <span class="n">new_pos</span>

<div class="viewcode-block" id="PseudoMotor.go"><a class="viewcode-back" href="../../../../../../devel/api/sardana/taurus/core/tango/sardana/pool.html#sardana.taurus.core.tango.sardana.pool.PseudoMotor.go">[docs]</a>    <span class="k">def</span> <span class="nf">go</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="n">start_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
        <span class="n">PoolElement</span><span class="o">.</span><span class="n">go</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">ret</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getStateEG</span><span class="p">()</span><span class="o">.</span><span class="n">readValue</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">readPosition</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_total_go_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start_time</span>
        <span class="k">return</span> <span class="n">ret</span></div>

    <span class="n">startMove</span> <span class="o">=</span> <span class="n">PoolElement</span><span class="o">.</span><span class="n">start</span>
    <span class="n">waitMove</span> <span class="o">=</span> <span class="n">PoolElement</span><span class="o">.</span><span class="n">waitFinish</span>
    <span class="n">move</span> <span class="o">=</span> <span class="n">go</span>
    <span class="n">getLastMotionTime</span> <span class="o">=</span> <span class="n">PoolElement</span><span class="o">.</span><span class="n">getLastGoTime</span>
    <span class="n">getTotalLastMotionTime</span> <span class="o">=</span> <span class="n">PoolElement</span><span class="o">.</span><span class="n">getTotalLastGoTime</span>

<div class="viewcode-block" id="PseudoMotor.readPosition"><a class="viewcode-back" href="../../../../../../devel/api/sardana/taurus/core/tango/sardana/pool.html#sardana.taurus.core.tango.sardana.pool.PseudoMotor.readPosition">[docs]</a>    <span class="k">def</span> <span class="nf">readPosition</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">force</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">getPosition</span><span class="p">(</span><span class="n">force</span><span class="o">=</span><span class="n">force</span><span class="p">)]</span></div>

<div class="viewcode-block" id="PseudoMotor.getMoveableSource"><a class="viewcode-back" href="../../../../../../devel/api/sardana/taurus/core/tango/sardana/pool.html#sardana.taurus.core.tango.sardana.pool.PseudoMotor.getMoveableSource">[docs]</a>    <span class="k">def</span> <span class="nf">getMoveableSource</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">getPoolObj</span><span class="p">()</span></div>

<div class="viewcode-block" id="PseudoMotor.getSize"><a class="viewcode-back" href="../../../../../../devel/api/sardana/taurus/core/tango/sardana/pool.html#sardana.taurus.core.tango.sardana.pool.PseudoMotor.getSize">[docs]</a>    <span class="k">def</span> <span class="nf">getSize</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="mi">1</span></div>

<div class="viewcode-block" id="PseudoMotor.getIndex"><a class="viewcode-back" href="../../../../../../devel/api/sardana/taurus/core/tango/sardana/pool.html#sardana.taurus.core.tango.sardana.pool.PseudoMotor.getIndex">[docs]</a>    <span class="k">def</span> <span class="nf">getIndex</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">name</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">getName</span><span class="p">()</span><span class="o">.</span><span class="n">lower</span><span class="p">():</span>
            <span class="k">return</span> <span class="mi">0</span>
        <span class="k">return</span> <span class="o">-</span><span class="mi">1</span></div>

    <span class="c1">#</span>
    <span class="c1"># End of Moveable interface</span>
    <span class="c1"># -~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-</span>

    <span class="k">def</span> <span class="nf">_information</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tab</span><span class="o">=</span><span class="s1">&#39;    &#39;</span><span class="p">):</span>
        <span class="n">msg</span> <span class="o">=</span> <span class="n">PoolElement</span><span class="o">.</span><span class="n">_information</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tab</span><span class="o">=</span><span class="n">tab</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">position</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">read_attribute</span><span class="p">(</span><span class="s2">&quot;position&quot;</span><span class="p">)</span>
            <span class="n">pos</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">position</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">position</span><span class="o">.</span><span class="n">quality</span> <span class="o">!=</span> <span class="n">AttrQuality</span><span class="o">.</span><span class="n">ATTR_VALID</span><span class="p">:</span>
                <span class="n">pos</span> <span class="o">+=</span> <span class="s2">&quot; [&quot;</span> <span class="o">+</span> <span class="n">QUALITY</span><span class="p">[</span><span class="n">position</span><span class="o">.</span><span class="n">quality</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;]&quot;</span>
        <span class="k">except</span> <span class="n">DevFailed</span> <span class="k">as</span> <span class="n">df</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">args</span><span class="p">):</span>
                <span class="n">pos</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">desc</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">e_info</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">exc_info</span><span class="p">()[:</span><span class="mi">2</span><span class="p">]</span>
                <span class="n">pos</span> <span class="o">=</span> <span class="n">traceback</span><span class="o">.</span><span class="n">format_exception_only</span><span class="p">(</span><span class="o">*</span><span class="n">e_info</span><span class="p">)</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="n">e_info</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">exc_info</span><span class="p">()[:</span><span class="mi">2</span><span class="p">]</span>
            <span class="n">pos</span> <span class="o">=</span> <span class="n">traceback</span><span class="o">.</span><span class="n">format_exception_only</span><span class="p">(</span><span class="o">*</span><span class="n">e_info</span><span class="p">)</span>

        <span class="n">msg</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tab</span> <span class="o">+</span> <span class="s2">&quot;Position: &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">pos</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">msg</span></div>


<div class="viewcode-block" id="MotorGroup"><a class="viewcode-back" href="../../../../../../devel/api/sardana/taurus/core/tango/sardana/pool.html#sardana.taurus.core.tango.sardana.pool.MotorGroup">[docs]</a><span class="k">class</span> <span class="nc">MotorGroup</span><span class="p">(</span><span class="n">PoolElement</span><span class="p">,</span> <span class="n">Moveable</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Class encapsulating MotorGroup functionality.&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;PoolElement initialization.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">call__init__</span><span class="p">(</span><span class="n">PoolElement</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">call__init__</span><span class="p">(</span><span class="n">Moveable</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_create_str_tuple</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="mi">3</span> <span class="o">*</span> <span class="p">[</span><span class="s2">&quot;TODO&quot;</span><span class="p">]</span>

<div class="viewcode-block" id="MotorGroup.getMotorNames"><a class="viewcode-back" href="../../../../../../devel/api/sardana/taurus/core/tango/sardana/pool.html#sardana.taurus.core.tango.sardana.pool.MotorGroup.getMotorNames">[docs]</a>    <span class="k">def</span> <span class="nf">getMotorNames</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">getPoolData</span><span class="p">()[</span><span class="s1">&#39;elements&#39;</span><span class="p">]</span></div>

<div class="viewcode-block" id="MotorGroup.hasMotor"><a class="viewcode-back" href="../../../../../../devel/api/sardana/taurus/core/tango/sardana/pool.html#sardana.taurus.core.tango.sardana.pool.MotorGroup.hasMotor">[docs]</a>    <span class="k">def</span> <span class="nf">hasMotor</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
        <span class="n">motor_names</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">str</span><span class="o">.</span><span class="n">lower</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">getMotorNames</span><span class="p">()))</span>
        <span class="k">return</span> <span class="n">name</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="ow">in</span> <span class="n">motor_names</span></div>

<div class="viewcode-block" id="MotorGroup.getPosition"><a class="viewcode-back" href="../../../../../../devel/api/sardana/taurus/core/tango/sardana/pool.html#sardana.taurus.core.tango.sardana.pool.MotorGroup.getPosition">[docs]</a>    <span class="k">def</span> <span class="nf">getPosition</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">force</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_getAttrValue</span><span class="p">(</span><span class="s1">&#39;position&#39;</span><span class="p">,</span> <span class="n">force</span><span class="o">=</span><span class="n">force</span><span class="p">)</span></div>

<div class="viewcode-block" id="MotorGroup.getPositionObj"><a class="viewcode-back" href="../../../../../../devel/api/sardana/taurus/core/tango/sardana/pool.html#sardana.taurus.core.tango.sardana.pool.MotorGroup.getPositionObj">[docs]</a>    <span class="k">def</span> <span class="nf">getPositionObj</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_getAttrEG</span><span class="p">(</span><span class="s1">&#39;position&#39;</span><span class="p">)</span></div>

    <span class="c1"># -~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-</span>
    <span class="c1"># Moveable interface</span>
    <span class="c1">#</span>

    <span class="k">def</span> <span class="nf">_start</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="n">new_pos</span> <span class="o">=</span> <span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">write_attribute</span><span class="p">(</span><span class="s1">&#39;position&#39;</span><span class="p">,</span> <span class="n">new_pos</span><span class="p">)</span>
        <span class="k">except</span> <span class="n">DevFailed</span> <span class="k">as</span> <span class="n">df</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">err</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">args</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">err</span><span class="o">.</span><span class="n">reason</span> <span class="o">==</span> <span class="s1">&#39;API_AttrNotAllowed&#39;</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%s</span><span class="s1"> is already moving&#39;</span> <span class="o">%</span> <span class="bp">self</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">raise</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">final_pos</span> <span class="o">=</span> <span class="n">new_pos</span>

<div class="viewcode-block" id="MotorGroup.go"><a class="viewcode-back" href="../../../../../../devel/api/sardana/taurus/core/tango/sardana/pool.html#sardana.taurus.core.tango.sardana.pool.MotorGroup.go">[docs]</a>    <span class="k">def</span> <span class="nf">go</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="n">start_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
        <span class="n">PoolElement</span><span class="o">.</span><span class="n">go</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">ret</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getStateEG</span><span class="p">()</span><span class="o">.</span><span class="n">readValue</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">readPosition</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_total_go_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start_time</span>
        <span class="k">return</span> <span class="n">ret</span></div>

    <span class="n">startMove</span> <span class="o">=</span> <span class="n">PoolElement</span><span class="o">.</span><span class="n">start</span>
    <span class="n">waitMove</span> <span class="o">=</span> <span class="n">PoolElement</span><span class="o">.</span><span class="n">waitFinish</span>
    <span class="n">move</span> <span class="o">=</span> <span class="n">go</span>
    <span class="n">getLastMotionTime</span> <span class="o">=</span> <span class="n">PoolElement</span><span class="o">.</span><span class="n">getLastGoTime</span>
    <span class="n">getTotalLastMotionTime</span> <span class="o">=</span> <span class="n">PoolElement</span><span class="o">.</span><span class="n">getTotalLastGoTime</span>

<div class="viewcode-block" id="MotorGroup.readPosition"><a class="viewcode-back" href="../../../../../../devel/api/sardana/taurus/core/tango/sardana/pool.html#sardana.taurus.core.tango.sardana.pool.MotorGroup.readPosition">[docs]</a>    <span class="k">def</span> <span class="nf">readPosition</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">force</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">getPosition</span><span class="p">(</span><span class="n">force</span><span class="o">=</span><span class="n">force</span><span class="p">)</span></div>

<div class="viewcode-block" id="MotorGroup.getMoveableSource"><a class="viewcode-back" href="../../../../../../devel/api/sardana/taurus/core/tango/sardana/pool.html#sardana.taurus.core.tango.sardana.pool.MotorGroup.getMoveableSource">[docs]</a>    <span class="k">def</span> <span class="nf">getMoveableSource</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">getPoolObj</span><span class="p">()</span></div>

<div class="viewcode-block" id="MotorGroup.getSize"><a class="viewcode-back" href="../../../../../../devel/api/sardana/taurus/core/tango/sardana/pool.html#sardana.taurus.core.tango.sardana.pool.MotorGroup.getSize">[docs]</a>    <span class="k">def</span> <span class="nf">getSize</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">getMotorNames</span><span class="p">())</span></div>

<div class="viewcode-block" id="MotorGroup.getIndex"><a class="viewcode-back" href="../../../../../../devel/api/sardana/taurus/core/tango/sardana/pool.html#sardana.taurus.core.tango.sardana.pool.MotorGroup.getIndex">[docs]</a>    <span class="k">def</span> <span class="nf">getIndex</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">motor_names</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">str</span><span class="o">.</span><span class="n">lower</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">getMotorNames</span><span class="p">()))</span>
            <span class="k">return</span> <span class="n">motor_names</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">name</span><span class="o">.</span><span class="n">lower</span><span class="p">())</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="k">return</span> <span class="o">-</span><span class="mi">1</span></div>

    <span class="c1">#</span>
    <span class="c1"># End of Moveable interface</span>
    <span class="c1"># -~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-</span>

    <span class="k">def</span> <span class="nf">_information</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tab</span><span class="o">=</span><span class="s1">&#39;    &#39;</span><span class="p">):</span>
        <span class="n">msg</span> <span class="o">=</span> <span class="n">PoolElement</span><span class="o">.</span><span class="n">_information</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tab</span><span class="o">=</span><span class="n">tab</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">position</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">read_attribute</span><span class="p">(</span><span class="s2">&quot;position&quot;</span><span class="p">)</span>
            <span class="n">pos</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">position</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">position</span><span class="o">.</span><span class="n">quality</span> <span class="o">!=</span> <span class="n">AttrQuality</span><span class="o">.</span><span class="n">ATTR_VALID</span><span class="p">:</span>
                <span class="n">pos</span> <span class="o">+=</span> <span class="s2">&quot; [&quot;</span> <span class="o">+</span> <span class="n">QUALITY</span><span class="p">[</span><span class="n">position</span><span class="o">.</span><span class="n">quality</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;]&quot;</span>
        <span class="k">except</span> <span class="n">DevFailed</span> <span class="k">as</span> <span class="n">df</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">args</span><span class="p">):</span>
                <span class="n">pos</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">desc</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">e_info</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">exc_info</span><span class="p">()[:</span><span class="mi">2</span><span class="p">]</span>
                <span class="n">pos</span> <span class="o">=</span> <span class="n">traceback</span><span class="o">.</span><span class="n">format_exception_only</span><span class="p">(</span><span class="o">*</span><span class="n">e_info</span><span class="p">)</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="n">e_info</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">exc_info</span><span class="p">()[:</span><span class="mi">2</span><span class="p">]</span>
            <span class="n">pos</span> <span class="o">=</span> <span class="n">traceback</span><span class="o">.</span><span class="n">format_exception_only</span><span class="p">(</span><span class="o">*</span><span class="n">e_info</span><span class="p">)</span>

        <span class="n">msg</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tab</span> <span class="o">+</span> <span class="s2">&quot;Position: &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">pos</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">msg</span></div>


<span class="k">class</span> <span class="nc">BaseChannelInfo</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
        <span class="c1"># dict&lt;str, obj&gt;</span>
        <span class="c1"># channel data</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">raw_data</span> <span class="o">=</span> <span class="n">data</span>
        <span class="bp">self</span><span class="o">.</span><span class="vm">__dict__</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>


<span class="k">class</span> <span class="nc">TangoChannelInfo</span><span class="p">(</span><span class="n">BaseChannelInfo</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">info</span><span class="p">):</span>
        <span class="n">BaseChannelInfo</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>
        <span class="c1"># PyTango.AttributeInfoEx</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_info</span><span class="p">(</span><span class="n">info</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">has_info</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">raw_info</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>

    <span class="k">def</span> <span class="nf">set_info</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">info</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">raw_info</span> <span class="o">=</span> <span class="n">info</span>

        <span class="k">if</span> <span class="n">info</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span>

        <span class="n">data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">raw_data</span>

        <span class="k">if</span> <span class="s1">&#39;data_type&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">data</span><span class="p">:</span>
            <span class="n">data_type</span> <span class="o">=</span> <span class="n">info</span><span class="o">.</span><span class="n">data_type</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">data_type</span> <span class="o">=</span> <span class="n">FROM_TANGO_TO_STR_TYPE</span><span class="p">[</span><span class="n">data_type</span><span class="p">]</span>
            <span class="k">except</span> <span class="ne">KeyError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                <span class="c1"># For backwards compatibility:</span>
                <span class="c1"># starting from Taurus 4.3.0 DevVoid was added to the dict</span>
                <span class="k">if</span> <span class="n">data_type</span> <span class="o">==</span> <span class="n">PyTango</span><span class="o">.</span><span class="n">DevVoid</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">data_type</span> <span class="o">=</span> <span class="kc">None</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="n">e</span>

        <span class="k">if</span> <span class="s1">&#39;shape&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">data</span><span class="p">:</span>
            <span class="n">shape</span> <span class="o">=</span> <span class="p">()</span>
            <span class="k">if</span> <span class="n">info</span><span class="o">.</span><span class="n">data_format</span> <span class="o">==</span> <span class="n">AttrDataFormat</span><span class="o">.</span><span class="n">SPECTRUM</span><span class="p">:</span>
                <span class="n">shape</span> <span class="o">=</span> <span class="p">(</span><span class="n">info</span><span class="o">.</span><span class="n">max_dim_x</span><span class="p">,)</span>
            <span class="k">elif</span> <span class="n">info</span><span class="o">.</span><span class="n">data_format</span> <span class="o">==</span> <span class="n">AttrDataFormat</span><span class="o">.</span><span class="n">IMAGE</span><span class="p">:</span>
                <span class="n">shape</span> <span class="o">=</span> <span class="p">(</span><span class="n">info</span><span class="o">.</span><span class="n">max_dim_x</span><span class="p">,</span> <span class="n">info</span><span class="o">.</span><span class="n">max_dim_y</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">shape</span> <span class="o">=</span> <span class="n">shape</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">shape</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">shape</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">shape</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">shape</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__getattr__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">has_info</span><span class="p">():</span>
            <span class="k">return</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">raw_info</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
        <span class="n">cls_name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span>
        <span class="k">raise</span> <span class="ne">AttributeError</span><span class="p">(</span><span class="s2">&quot;&#39;</span><span class="si">%s</span><span class="s2">&#39; has no attribute &#39;</span><span class="si">%s</span><span class="s2">&#39;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">cls_name</span><span class="p">,</span> <span class="n">name</span><span class="p">))</span>


<span class="k">def</span> <span class="nf">getChannelConfigs</span><span class="p">(</span><span class="n">mgconfig</span><span class="p">,</span> <span class="n">ctrls</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">sort</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    gets a list of channel configurations of the controllers of the given</span>
<span class="sd">    measurement group configuration. It optionally filters to those channels</span>
<span class="sd">    matching given lists of controller.</span>

<span class="sd">    :param ctrls: (seq&lt;str&gt; or None) a sequence of strings to filter the</span>
<span class="sd">                  controllers. If None given, all controllers will be used</span>
<span class="sd">    :param sort: (bool) If True (default) the returned list will be sorted</span>
<span class="sd">                 according to channel index (if given in channeldata) and</span>
<span class="sd">                 then by channelname.</span>

<span class="sd">    :return: (list&lt;tuple&gt;) A list of channelname,channeldata pairs.</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="n">chconfigs</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">mgconfig</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">ctrl_name</span><span class="p">,</span> <span class="n">ctrl_data</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">mgconfig</span><span class="p">[</span><span class="s1">&#39;controllers&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
        <span class="k">if</span> <span class="n">ctrls</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">ctrl_name</span> <span class="ow">in</span> <span class="n">ctrls</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">ch_name</span><span class="p">,</span> <span class="n">ch_data</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">ctrl_data</span><span class="p">[</span><span class="s1">&#39;channels&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
                <span class="n">ch_data</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s1">&#39;_controller_name&#39;</span><span class="p">:</span> <span class="n">ctrl_name</span><span class="p">})</span>
                <span class="n">chconfigs</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">ch_name</span><span class="p">,</span> <span class="n">ch_data</span><span class="p">))</span>
    <span class="k">if</span> <span class="n">sort</span><span class="p">:</span>
        <span class="c1"># sort the channel configs by index (primary sort) and then by channel</span>
        <span class="c1"># name.</span>
        <span class="c1"># sort by channel_name</span>
        <span class="n">chconfigs</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">chconfigs</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">c</span><span class="p">:</span> <span class="n">c</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="c1"># sort by index (give a very large index for those which don&#39;t have it)</span>
        <span class="n">chconfigs</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">chconfigs</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">c</span><span class="p">:</span> <span class="n">c</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;index&#39;</span><span class="p">,</span> <span class="mf">1e16</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">chconfigs</span>


<span class="k">class</span> <span class="nc">MGConfiguration</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mg</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_mg</span> <span class="o">=</span> <span class="n">weakref</span><span class="o">.</span><span class="n">ref</span><span class="p">(</span><span class="n">mg</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_raw_data</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_pending_event_data</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_local_changes</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">set_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">force</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="c1"># object each time</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">CodecFactory</span><span class="p">()</span><span class="o">.</span><span class="n">decode</span><span class="p">((</span><span class="s1">&#39;json&#39;</span><span class="p">,</span> <span class="n">data</span><span class="p">))</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">force</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_raw_data</span> <span class="o">==</span> <span class="n">data</span><span class="p">:</span>
                <span class="c1"># The new data received on the on_change_event was generated by</span>
                <span class="c1"># this object.</span>
                <span class="k">return</span>
            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">_local_changes</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_pending_event_data</span> <span class="o">=</span> <span class="n">data</span>
                <span class="k">return</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_pending_event_data</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_local_changes</span> <span class="o">=</span> <span class="kc">False</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_raw_data</span> <span class="o">=</span> <span class="n">data</span>
        <span class="bp">self</span><span class="o">.</span><span class="vm">__dict__</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="c1"># dict&lt;str, dict&gt;</span>
        <span class="c1"># where key is the channel name and value is the channel data in form</span>
        <span class="c1"># of a dict as received by the MG configuration attribute</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">channels</span> <span class="o">=</span> <span class="n">channels</span> <span class="o">=</span> <span class="n">CaselessDict</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">channels_names</span> <span class="o">=</span> <span class="n">channels_names</span> <span class="o">=</span> <span class="n">CaselessDict</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">channels_labels</span> <span class="o">=</span> <span class="n">channels_labels</span> <span class="o">=</span> <span class="n">CaselessDict</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">controllers_names</span> <span class="o">=</span> <span class="n">controllers_names</span> <span class="o">=</span> <span class="n">CaselessDict</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">controllers_channels</span> <span class="o">=</span> <span class="n">controllers_channels</span> <span class="o">=</span> <span class="n">CaselessDict</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">controllers_alias</span> <span class="o">=</span> <span class="n">CaselessDict</span><span class="p">()</span>

        <span class="c1"># TODO private controllers attr</span>
        <span class="k">for</span> <span class="n">ctrl_name</span><span class="p">,</span> <span class="n">ctrl_data</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">controllers</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">ctrl_name</span> <span class="o">!=</span> <span class="s1">&#39;__tango__&#39;</span><span class="p">:</span>
                    <span class="n">proxy</span> <span class="o">=</span> <span class="n">DeviceProxy</span><span class="p">(</span><span class="n">ctrl_name</span><span class="p">)</span>
                    <span class="n">ctrl_full_name</span> <span class="o">=</span> <span class="n">ctrl_name</span>
                    <span class="n">ctrl_name</span> <span class="o">=</span> <span class="n">proxy</span><span class="o">.</span><span class="n">alias</span><span class="p">()</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">controllers_alias</span><span class="p">[</span><span class="n">ctrl_full_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">ctrl_name</span>

                <span class="n">controllers_names</span><span class="p">[</span><span class="n">ctrl_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">ctrl_data</span>
                <span class="n">controllers_channels</span><span class="p">[</span><span class="n">ctrl_name</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
                <span class="k">pass</span>
            <span class="k">for</span> <span class="n">channel_name</span><span class="p">,</span> <span class="n">channel_data</span> <span class="ow">in</span> \
                    <span class="nb">list</span><span class="p">(</span><span class="n">ctrl_data</span><span class="p">[</span><span class="s1">&#39;channels&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
                <span class="n">channels</span><span class="p">[</span><span class="n">channel_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">channel_data</span>
                <span class="n">name</span> <span class="o">=</span> <span class="n">channel_data</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span>
                <span class="n">channels_names</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">channel_data</span>
                <span class="n">label</span> <span class="o">=</span> <span class="n">channel_data</span><span class="p">[</span><span class="s1">&#39;label&#39;</span><span class="p">]</span>
                <span class="n">channels_labels</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">channel_data</span>
                <span class="n">index</span> <span class="o">=</span> <span class="n">channel_data</span><span class="p">[</span><span class="s1">&#39;index&#39;</span><span class="p">]</span>
                <span class="n">ch_data</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;fullname&#39;</span><span class="p">:</span> <span class="n">channel_name</span><span class="p">,</span>
                           <span class="s1">&#39;label&#39;</span><span class="p">:</span> <span class="n">label</span><span class="p">,</span>
                           <span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="n">name</span><span class="p">,</span>
                           <span class="s1">&#39;index&#39;</span><span class="p">:</span> <span class="n">index</span><span class="p">}</span>
                <span class="n">controllers_channels</span><span class="p">[</span><span class="n">ctrl_name</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ch_data</span><span class="p">)</span>

        <span class="c1">#####################</span>
        <span class="c1"># @todo: the for-loops above could be replaced by something like:</span>
        <span class="c1"># self.channels = channels = \</span>
        <span class="c1">#      CaselessDict(getChannelConfigs(data, sort=False))</span>
        <span class="c1">#####################</span>

        <span class="c1"># Create ordered list by channel index in the MG as cache</span>
        <span class="c1">#    channel_list: seq&lt;dict&gt; each element is the channel data in form</span>
        <span class="c1">#    of a dict as received by the MG configuration attribute.</span>
        <span class="c1">#    channel_list_name: seq&lt;str&gt;</span>
        <span class="c1">#    controller_list_names: seg&lt;str&gt;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">channel_list</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">channels</span><span class="p">)</span> <span class="o">*</span> <span class="p">[</span><span class="kc">None</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">channel_list_name</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">channels</span><span class="p">)</span> <span class="o">*</span> <span class="p">[</span><span class="kc">None</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">controller_list_name</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">for</span> <span class="n">channel</span><span class="p">,</span> <span class="n">channel_data</span> <span class="ow">in</span> <span class="n">channels</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">idx</span> <span class="o">=</span> <span class="n">channel_data</span><span class="p">[</span><span class="s1">&#39;index&#39;</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">channel_list</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span> <span class="o">=</span> <span class="n">channel_data</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">channel_list_name</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span> <span class="o">=</span> <span class="n">channel</span>

        <span class="k">for</span> <span class="n">channel_name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">channel_list_name</span><span class="p">:</span>
            <span class="n">ctrl</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_ctrl_for_element</span><span class="p">(</span><span class="n">channel_name</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">ctrl</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">controller_list_name</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">controller_list_name</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ctrl</span><span class="p">)</span>
        <span class="c1"># dict&lt;str, list[DeviceProxy, CaselessDict&lt;str, dict&gt;]&gt;</span>
        <span class="c1"># where key is a device name and value is a list with two elements:</span>
        <span class="c1">#  - A device proxy or None if there was an error building it</span>
        <span class="c1">#  - A dict where keys are attribute names and value is a reference to</span>
        <span class="c1">#    a dict representing channel data as received in raw data</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tango_dev_channels</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="c1"># Number of elements in tango_dev_channels in error (could not build</span>
        <span class="c1"># DeviceProxy, probably)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tango_dev_channels_in_error</span> <span class="o">=</span> <span class="mi">0</span>

        <span class="c1"># dict&lt;str, tuple&lt;str, str, TangoChannelInfo&gt;&gt;</span>
        <span class="c1"># where key is a channel name and value is a tuple of three elements:</span>
        <span class="c1">#  - device name</span>
        <span class="c1">#  - attribute name</span>
        <span class="c1">#  - attribute information or None if there was an error trying to get</span>
        <span class="c1">#    the information</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tango_channels_info</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="c1"># Number of elements in tango_channels_info_in_error in error</span>
        <span class="c1"># (could not build attribute info, probably)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tango_channels_info_in_error</span> <span class="o">=</span> <span class="mi">0</span>

        <span class="c1"># dict&lt;str, dict&gt;</span>
        <span class="c1"># where key is a channel name and data is a reference to a dict</span>
        <span class="c1"># representing channel data as received in raw data</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">non_tango_channels</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">initialized</span> <span class="o">=</span> <span class="kc">False</span>

    <span class="k">def</span> <span class="nf">_build</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># internal channel structure that groups channels by tango device so</span>
        <span class="c1"># they can be read as a group minimizing this way the network requests</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tango_dev_channels</span> <span class="o">=</span> <span class="n">tg_dev_chs</span> <span class="o">=</span> <span class="n">CaselessDict</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tango_dev_channels_in_error</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tango_channels_info</span> <span class="o">=</span> <span class="n">tg_chs_info</span> <span class="o">=</span> <span class="n">CaselessDict</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tango_channels_info_in_error</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">non_tango_channels</span> <span class="o">=</span> <span class="n">n_tg_chs</span> <span class="o">=</span> <span class="n">CaselessDict</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cache</span> <span class="o">=</span> <span class="n">cache</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="n">tg_attr_validator</span> <span class="o">=</span> <span class="n">TangoAttributeNameValidator</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">channel_name</span><span class="p">,</span> <span class="n">channel_data</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">channels</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
            <span class="n">cache</span><span class="p">[</span><span class="n">channel_name</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="n">data_source</span> <span class="o">=</span> <span class="n">channel_data</span><span class="p">[</span><span class="s1">&#39;source&#39;</span><span class="p">]</span>
            <span class="n">params</span> <span class="o">=</span> <span class="n">tg_attr_validator</span><span class="o">.</span><span class="n">getUriGroups</span><span class="p">(</span><span class="n">data_source</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">params</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="c1"># Handle NON tango channel</span>
                <span class="n">n_tg_chs</span><span class="p">[</span><span class="n">channel_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">channel_data</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="c1"># Handle tango channel</span>
                <span class="n">dev_name</span> <span class="o">=</span> <span class="n">params</span><span class="p">[</span><span class="s1">&#39;devname&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
                <span class="n">attr_name</span> <span class="o">=</span> <span class="n">params</span><span class="p">[</span><span class="s1">&#39;_shortattrname&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
                <span class="n">host</span><span class="p">,</span> <span class="n">port</span> <span class="o">=</span> <span class="n">params</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;host&#39;</span><span class="p">),</span> <span class="n">params</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;port&#39;</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">host</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">port</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">dev_name</span> <span class="o">=</span> <span class="s2">&quot;tango://</span><span class="si">{0}</span><span class="s2">:</span><span class="si">{1}</span><span class="s2">/</span><span class="si">{2}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">host</span><span class="p">,</span> <span class="n">port</span><span class="p">,</span>
                                                            <span class="n">dev_name</span><span class="p">)</span>
                <span class="n">dev_data</span> <span class="o">=</span> <span class="n">tg_dev_chs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">dev_name</span><span class="p">)</span>
                <span class="c1"># technical debt: read Value or ValueRef attribute</span>
                <span class="c1"># ideally the source configuration should include this info</span>
                <span class="c1"># Use DeviceProxy instead of taurus to avoid crashes in Py3</span>
                <span class="c1"># See: tango-controls/pytango#292</span>
                <span class="c1"># channel = Device(dev_name)</span>
                <span class="c1"># if (isinstance(channel, ExpChannel)</span>
                <span class="c1">#         and channel.isReferable()</span>
                <span class="c1">#         and channel_data.get(&quot;value_ref_enabled&quot;, False)):</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">_is_referable</span><span class="p">(</span><span class="n">dev_name</span><span class="p">)</span>
                        <span class="ow">and</span> <span class="n">channel_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;value_ref_enabled&quot;</span><span class="p">,</span> <span class="kc">False</span><span class="p">)):</span>
                    <span class="n">attr_name</span> <span class="o">+=</span> <span class="s2">&quot;Ref&quot;</span>
                <span class="k">if</span> <span class="n">dev_data</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="c1"># Build tango device</span>
                    <span class="n">dev</span> <span class="o">=</span> <span class="kc">None</span>
                    <span class="k">try</span><span class="p">:</span>
                        <span class="n">dev</span> <span class="o">=</span> <span class="n">DeviceProxy</span><span class="p">(</span><span class="n">dev_name</span><span class="p">)</span>
                    <span class="k">except</span><span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">tango_dev_channels_in_error</span> <span class="o">+=</span> <span class="mi">1</span>
                    <span class="n">tg_dev_chs</span><span class="p">[</span><span class="n">dev_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">dev_data</span> <span class="o">=</span> <span class="p">[</span><span class="n">dev</span><span class="p">,</span> <span class="n">CaselessDict</span><span class="p">()]</span>
                <span class="n">dev</span><span class="p">,</span> <span class="n">attr_data</span> <span class="o">=</span> <span class="n">dev_data</span>
                <span class="n">attr_data</span><span class="p">[</span><span class="n">attr_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">channel_data</span>

                <span class="c1"># get attribute configuration</span>
                <span class="n">attr_info</span> <span class="o">=</span> <span class="kc">None</span>
                <span class="k">if</span> <span class="n">dev</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">tango_channels_info_in_error</span> <span class="o">+=</span> <span class="mi">1</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">try</span><span class="p">:</span>
                        <span class="n">tg_attr_info</span> <span class="o">=</span> <span class="n">dev</span><span class="o">.</span><span class="n">get_attribute_config_ex</span><span class="p">(</span><span class="n">attr_name</span><span class="p">)[</span>
                            <span class="mi">0</span><span class="p">]</span>
                    <span class="k">except</span><span class="p">:</span>
                        <span class="n">tg_attr_info</span> <span class="o">=</span> \
                            <span class="bp">self</span><span class="o">.</span><span class="n">_build_empty_tango_attr_info</span><span class="p">(</span><span class="n">channel_data</span><span class="p">)</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">tango_channels_info_in_error</span> <span class="o">+=</span> <span class="mi">1</span>
                    <span class="n">attr_info</span> <span class="o">=</span> <span class="n">TangoChannelInfo</span><span class="p">(</span><span class="n">channel_data</span><span class="p">,</span> <span class="n">tg_attr_info</span><span class="p">)</span>

                <span class="n">tg_chs_info</span><span class="p">[</span><span class="n">channel_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">dev_name</span><span class="p">,</span> <span class="n">attr_name</span><span class="p">,</span> <span class="n">attr_info</span>

    <span class="k">def</span> <span class="nf">_build_empty_tango_attr_info</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">channel_data</span><span class="p">):</span>
        <span class="n">ret</span> <span class="o">=</span> <span class="n">PyTango</span><span class="o">.</span><span class="n">AttributeInfoEx</span><span class="p">()</span>
        <span class="n">ret</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">channel_data</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span>
        <span class="n">ret</span><span class="o">.</span><span class="n">label</span> <span class="o">=</span> <span class="n">channel_data</span><span class="p">[</span><span class="s1">&#39;label&#39;</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">ret</span>

    <span class="k">def</span> <span class="nf">prepare</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># first time? build everything</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">tango_dev_channels</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_build</span><span class="p">()</span>

        <span class="c1"># prepare missing tango devices</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">tango_dev_channels_in_error</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">dev_name</span><span class="p">,</span> <span class="n">dev_data</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tango_dev_channels</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
                <span class="k">if</span> <span class="n">dev_data</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="k">try</span><span class="p">:</span>
                        <span class="n">dev_data</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">DeviceProxy</span><span class="p">(</span><span class="n">dev_name</span><span class="p">)</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">tango_dev_channels_in_error</span> <span class="o">-=</span> <span class="mi">1</span>
                    <span class="k">except</span><span class="p">:</span>
                        <span class="k">pass</span>

        <span class="c1"># prepare missing tango attribute configuration</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">tango_channels_info_in_error</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">attr_data</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tango_channels_info</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
                <span class="n">dev_name</span><span class="p">,</span> <span class="n">attr_name</span><span class="p">,</span> <span class="n">attr_info</span> <span class="o">=</span> <span class="n">attr_data</span>
                <span class="k">if</span> <span class="n">attr_info</span><span class="o">.</span><span class="n">has_info</span><span class="p">():</span>
                    <span class="k">continue</span>
                <span class="n">dev</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tango_dev_channels</span><span class="p">[</span><span class="n">dev_name</span><span class="p">]</span>
                <span class="k">if</span> <span class="n">dev</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="k">continue</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">tg_attr_info</span> <span class="o">=</span> <span class="n">dev</span><span class="o">.</span><span class="n">get_attribute_config_ex</span><span class="p">(</span><span class="n">attr_name</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
                    <span class="n">attr_info</span><span class="o">.</span><span class="n">set_info</span><span class="p">(</span><span class="n">tg_attr_info</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">tango_channels_info_in_error</span> <span class="o">-=</span> <span class="mi">1</span>
                <span class="k">except</span><span class="p">:</span>
                    <span class="k">pass</span>

    <span class="k">def</span> <span class="nf">getChannels</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">channel_list</span>

    <span class="k">def</span> <span class="nf">getChannelInfo</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">channel_name</span><span class="p">):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">tango_channels_info</span><span class="p">[</span><span class="n">channel_name</span><span class="p">]</span>
        <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
            <span class="n">channel_name</span> <span class="o">=</span> <span class="n">channel_name</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
            <span class="k">for</span> <span class="n">d_name</span><span class="p">,</span> <span class="n">a_name</span><span class="p">,</span> <span class="n">ch_info</span> <span class="ow">in</span> \
                    <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tango_channels_info</span><span class="o">.</span><span class="n">values</span><span class="p">()):</span>
                <span class="k">if</span> <span class="n">ch_info</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="n">channel_name</span><span class="p">:</span>
                    <span class="k">return</span> <span class="n">d_name</span><span class="p">,</span> <span class="n">a_name</span><span class="p">,</span> <span class="n">ch_info</span>

    <span class="k">def</span> <span class="nf">getChannelsInfo</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">only_enabled</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns information about the channels present in the measurement</span>
<span class="sd">        group in a form of dictionary, where key is a channel name and value is</span>
<span class="sd">        a tuple of three elements:</span>
<span class="sd">            - device name</span>
<span class="sd">            - attribute name</span>
<span class="sd">            - attribute information or None if there was an error trying to get</span>
<span class="sd">              the information</span>

<span class="sd">        :param only_enabled: flag to filter out disabled channels</span>
<span class="sd">        :type only_enabled: bool</span>
<span class="sd">        :return: dictionary with channels info</span>
<span class="sd">        :rtype: dict&lt;str, tuple&lt;str, str, TangoChannelInfo&gt;&gt;</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">prepare</span><span class="p">()</span>
        <span class="n">ret</span> <span class="o">=</span> <span class="n">CaselessDict</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tango_channels_info</span><span class="p">)</span>
        <span class="n">ret</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">non_tango_channels</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">ch_name</span><span class="p">,</span> <span class="p">(</span><span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">ch_info</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">ret</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
            <span class="k">if</span> <span class="n">only_enabled</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">ch_info</span><span class="o">.</span><span class="n">enabled</span><span class="p">:</span>
                <span class="n">ret</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">ch_name</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">ret</span>

    <span class="k">def</span> <span class="nf">getChannelsInfoList</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">only_enabled</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns information about the channels present in the measurement</span>
<span class="sd">        group in a form of ordered, based on the channel index, list.</span>

<span class="sd">        :param only_enabled: flag to filter out disabled channels</span>
<span class="sd">        :type only_enabled: bool</span>
<span class="sd">        :return: list with channels info</span>
<span class="sd">        :rtype: list&lt;TangoChannelInfo&gt;</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">channels_info</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getChannelsInfo</span><span class="p">(</span><span class="n">only_enabled</span><span class="o">=</span><span class="n">only_enabled</span><span class="p">)</span>
        <span class="n">ret</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="p">(</span><span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">ch_info</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">channels_info</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
            <span class="n">ret</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ch_info</span><span class="p">)</span>
        <span class="n">ret</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">ret</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">ret</span>

    <span class="k">def</span> <span class="nf">getCountersInfoList</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">channels_info</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getChannelsInfoList</span><span class="p">()</span>
        <span class="n">timer_name</span><span class="p">,</span> <span class="n">idx</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">timer</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">ch</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">channels_info</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">ch</span><span class="p">[</span><span class="s1">&#39;full_name&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">timer_name</span><span class="p">:</span>
                <span class="n">idx</span> <span class="o">=</span> <span class="n">i</span>
                <span class="k">break</span>
        <span class="k">if</span> <span class="n">idx</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">channels_info</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">idx</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">channels_info</span>

    <span class="k">def</span> <span class="nf">getTangoDevChannels</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">only_enabled</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns Tango channels (attributes) that could be used to read</span>
<span class="sd">        measurement group results in a form of dict where key is a device name</span>
<span class="sd">        and value is a list with two elements:</span>
<span class="sd">            - A device proxy or None if there was an error building it</span>
<span class="sd">            - A dict where keys are attribute names and value is a reference to</span>
<span class="sd">              a dict representing channel data as received in raw data</span>

<span class="sd">        :param only_enabled: flag to filter out disabled channels</span>
<span class="sd">        :type only_enabled: bool</span>
<span class="sd">        :return: dict with Tango channels</span>
<span class="sd">        :rtype: dict&lt;str, list[DeviceProxy, CaselessDict&lt;str, dict&gt;]&gt;</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">only_enabled</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">tango_dev_channels</span>
        <span class="n">tango_dev_channels</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">dev_name</span><span class="p">,</span> <span class="n">dev_data</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tango_dev_channels</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
            <span class="n">dev_proxy</span><span class="p">,</span> <span class="n">attrs</span> <span class="o">=</span> <span class="n">dev_data</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">dev_data</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
            <span class="k">for</span> <span class="n">attr_name</span><span class="p">,</span> <span class="n">channel_data</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">attrs</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">channel_data</span><span class="p">[</span><span class="s2">&quot;enabled&quot;</span><span class="p">]:</span>
                    <span class="n">attrs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">attr_name</span><span class="p">)</span>
            <span class="n">tango_dev_channels</span><span class="p">[</span><span class="n">dev_name</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">dev_proxy</span><span class="p">,</span> <span class="n">attrs</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">tango_dev_channels</span>

    <span class="k">def</span> <span class="nf">read</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parallel</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">parallel</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_read_parallel</span><span class="p">()</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_read</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">_read_parallel</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">prepare</span><span class="p">()</span>
        <span class="n">ret</span> <span class="o">=</span> <span class="n">CaselessDict</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cache</span><span class="p">)</span>
        <span class="n">dev_replies</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="c1"># deposit read requests</span>
        <span class="n">tango_dev_channels</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getTangoDevChannels</span><span class="p">(</span><span class="n">only_enabled</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">dev_data</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">tango_dev_channels</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
            <span class="n">dev</span><span class="p">,</span> <span class="n">attrs</span> <span class="o">=</span> <span class="n">dev_data</span>
            <span class="k">if</span> <span class="n">dev</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">continue</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">dev_replies</span><span class="p">[</span><span class="n">dev</span><span class="p">]</span> <span class="o">=</span> <span class="n">dev</span><span class="o">.</span><span class="n">read_attributes_asynch</span><span class="p">(</span>
                    <span class="nb">list</span><span class="p">(</span><span class="n">attrs</span><span class="o">.</span><span class="n">keys</span><span class="p">())),</span> <span class="n">attrs</span>
            <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
                <span class="n">dev_replies</span><span class="p">[</span><span class="n">dev</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">attrs</span>

        <span class="c1"># gather all replies</span>
        <span class="k">for</span> <span class="n">dev</span><span class="p">,</span> <span class="n">reply_data</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">dev_replies</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
            <span class="n">reply</span><span class="p">,</span> <span class="n">attrs</span> <span class="o">=</span> <span class="n">reply_data</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">data</span> <span class="o">=</span> <span class="n">dev</span><span class="o">.</span><span class="n">read_attributes_reply</span><span class="p">(</span><span class="n">reply</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">data_item</span> <span class="ow">in</span> <span class="n">data</span><span class="p">:</span>
                    <span class="n">channel_data</span> <span class="o">=</span> <span class="n">attrs</span><span class="p">[</span><span class="n">data_item</span><span class="o">.</span><span class="n">name</span><span class="p">]</span>
                    <span class="k">if</span> <span class="n">data_item</span><span class="o">.</span><span class="n">has_failed</span><span class="p">:</span>
                        <span class="n">value</span> <span class="o">=</span> <span class="kc">None</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">value</span> <span class="o">=</span> <span class="n">data_item</span><span class="o">.</span><span class="n">value</span>
                    <span class="n">ret</span><span class="p">[</span><span class="n">channel_data</span><span class="p">[</span><span class="s1">&#39;full_name&#39;</span><span class="p">]]</span> <span class="o">=</span> <span class="n">value</span>
            <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">channel_data</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">attrs</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
                    <span class="n">ret</span><span class="p">[</span><span class="n">channel_data</span><span class="p">[</span><span class="s1">&#39;full_name&#39;</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="k">return</span> <span class="n">ret</span>

    <span class="k">def</span> <span class="nf">_read</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">prepare</span><span class="p">()</span>
        <span class="n">ret</span> <span class="o">=</span> <span class="n">CaselessDict</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cache</span><span class="p">)</span>
        <span class="n">tango_dev_channels</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getTangoDevChannels</span><span class="p">(</span><span class="n">only_enabled</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">dev_data</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">tango_dev_channels</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
            <span class="n">dev</span><span class="p">,</span> <span class="n">attrs</span> <span class="o">=</span> <span class="n">dev_data</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">data</span> <span class="o">=</span> <span class="n">dev</span><span class="o">.</span><span class="n">read_attributes</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">attrs</span><span class="o">.</span><span class="n">keys</span><span class="p">()))</span>
                <span class="k">for</span> <span class="n">data_item</span> <span class="ow">in</span> <span class="n">data</span><span class="p">:</span>
                    <span class="n">channel_data</span> <span class="o">=</span> <span class="n">attrs</span><span class="p">[</span><span class="n">data_item</span><span class="o">.</span><span class="n">name</span><span class="p">]</span>
                    <span class="k">if</span> <span class="n">data_item</span><span class="o">.</span><span class="n">has_failed</span><span class="p">:</span>
                        <span class="n">value</span> <span class="o">=</span> <span class="kc">None</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">value</span> <span class="o">=</span> <span class="n">data_item</span><span class="o">.</span><span class="n">value</span>
                    <span class="n">ret</span><span class="p">[</span><span class="n">channel_data</span><span class="p">[</span><span class="s1">&#39;full_name&#39;</span><span class="p">]]</span> <span class="o">=</span> <span class="n">value</span>
            <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">channel_data</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">attrs</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
                    <span class="n">ret</span><span class="p">[</span><span class="n">channel_data</span><span class="p">[</span><span class="s1">&#39;full_name&#39;</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">return</span> <span class="n">ret</span>

    <span class="k">def</span> <span class="nf">_get_channel_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">channel_name</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">channel_name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">channels_names</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">channels_names</span><span class="p">[</span><span class="n">channel_name</span><span class="p">]</span>
        <span class="k">elif</span> <span class="n">channel_name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">channels_labels</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">channels_labels</span><span class="p">[</span><span class="n">channel_name</span><span class="p">]</span>
        <span class="k">elif</span> <span class="n">channel_name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">channels</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">channels</span><span class="p">[</span><span class="n">channel_name</span><span class="p">]</span>
        <span class="n">v</span> <span class="o">=</span> <span class="n">TangoDeviceNameValidator</span><span class="p">()</span>
        <span class="n">names</span> <span class="o">=</span> <span class="n">v</span><span class="o">.</span><span class="n">getNames</span><span class="p">(</span><span class="n">channel_name</span><span class="p">)</span>
        <span class="n">msg</span> <span class="o">=</span> <span class="s1">&#39;element &quot;</span><span class="si">{}</span><span class="s1">&quot; is not in </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">channel_name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">label</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">names</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">v</span> <span class="o">=</span> <span class="n">TangoAttributeNameValidator</span><span class="p">()</span>
            <span class="n">names</span> <span class="o">=</span> <span class="n">v</span><span class="o">.</span><span class="n">getNames</span><span class="p">(</span><span class="n">channel_name</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">names</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">KeyError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
        <span class="n">full_name</span> <span class="o">=</span> <span class="n">names</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">channels</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">full_name</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">data</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">KeyError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">data</span>

    <span class="k">def</span> <span class="nf">_get_ctrl_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ctrl_name</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">ctrl_name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">controllers_names</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">controllers_names</span><span class="p">[</span><span class="n">ctrl_name</span><span class="p">]</span>
        <span class="k">elif</span> <span class="n">ctrl_name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">controllers</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">controllers</span><span class="p">[</span><span class="n">ctrl_name</span><span class="p">]</span>
        <span class="n">v</span> <span class="o">=</span> <span class="n">TangoDeviceNameValidator</span><span class="p">()</span>
        <span class="n">names</span> <span class="o">=</span> <span class="n">v</span><span class="o">.</span><span class="n">getNames</span><span class="p">(</span><span class="n">ctrl_name</span><span class="p">)</span>
        <span class="n">msg</span> <span class="o">=</span> <span class="s1">&#39;element &quot;</span><span class="si">{}</span><span class="s1">&quot; is not in </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">ctrl_name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">label</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">names</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">KeyError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
        <span class="n">full_name</span> <span class="o">=</span> <span class="n">names</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">controllers</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">full_name</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">data</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">KeyError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">data</span>

    <span class="k">def</span> <span class="nf">_set_channels_key</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">channels_names</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                          <span class="n">apply_cfg</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_local_changes</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">if</span> <span class="n">channels_names</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">channels_names</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">channels</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
        <span class="c1"># Protections:</span>
        <span class="k">if</span> <span class="n">key</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;enabled&#39;</span><span class="p">,</span> <span class="s1">&#39;output&#39;</span><span class="p">]:</span>
            <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">value</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">bool</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;The value must be a boolean&#39;</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">channel_name</span> <span class="ow">in</span> <span class="n">channels_names</span><span class="p">:</span>
            <span class="n">channel</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_channel_data</span><span class="p">(</span><span class="n">channel_name</span><span class="p">)</span>
            <span class="n">channel</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
        <span class="k">if</span> <span class="n">apply_cfg</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">applyConfiguration</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">_get_channels_key</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">channels_names</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">use_fullname</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Helper method to return the value for one channel configuration key,</span>
<span class="sd">        if the key does not exist the value will be None.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">collections</span><span class="o">.</span><span class="n">OrderedDict</span><span class="p">({})</span>

        <span class="k">if</span> <span class="n">channels_names</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">channels_names</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">channel_list_name</span>

        <span class="k">for</span> <span class="n">channel_name</span> <span class="ow">in</span> <span class="n">channels_names</span><span class="p">:</span>
            <span class="n">channel</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_channel_data</span><span class="p">(</span><span class="n">channel_name</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">use_fullname</span><span class="p">:</span>
                <span class="n">label</span> <span class="o">=</span> <span class="n">channel</span><span class="p">[</span><span class="s1">&#39;full_name&#39;</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">label</span> <span class="o">=</span> <span class="n">channel</span><span class="p">[</span><span class="s1">&#39;label&#39;</span><span class="p">]</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">value</span> <span class="o">=</span> <span class="n">channel</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
            <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
                <span class="n">result</span><span class="p">[</span><span class="n">label</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
                <span class="k">continue</span>
            <span class="k">if</span> <span class="n">key</span> <span class="o">==</span> <span class="s1">&#39;plot_axes&#39;</span><span class="p">:</span>
                <span class="n">res</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">value</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">v</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;&lt;mov&gt;&#39;</span><span class="p">,</span> <span class="s1">&#39;&lt;idx&gt;&#39;</span><span class="p">]:</span>
                        <span class="n">v</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">channels</span><span class="p">[</span><span class="n">v</span><span class="p">][</span><span class="s1">&#39;label&#39;</span><span class="p">]</span>
                    <span class="n">res</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
                <span class="n">value</span> <span class="o">=</span> <span class="n">res</span>
            <span class="n">result</span><span class="p">[</span><span class="n">label</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
        <span class="k">return</span> <span class="n">result</span>

    <span class="k">def</span> <span class="nf">_set_ctrls_key</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">ctrls_names</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">apply_cfg</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_local_changes</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">if</span> <span class="n">ctrls_names</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">ctrls_names</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">controllers</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>

        <span class="k">for</span> <span class="n">ctrl_name</span> <span class="ow">in</span> <span class="n">ctrls_names</span><span class="p">:</span>
            <span class="c1"># if ctrl_name == &#39;__tango__&#39;:</span>
            <span class="c1">#     continue</span>
            <span class="n">ctrl</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_ctrl_data</span><span class="p">(</span><span class="n">ctrl_name</span><span class="p">)</span>
            <span class="n">ctrl</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
        <span class="k">if</span> <span class="n">apply_cfg</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">applyConfiguration</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">_get_ctrls_key</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">ctrls_names</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">use_fullname</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Helper method to return the value for one controller configuration key,</span>
<span class="sd">        if the key does not exist the value will be None.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">collections</span><span class="o">.</span><span class="n">OrderedDict</span><span class="p">({})</span>
        <span class="k">if</span> <span class="n">ctrls_names</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">ctrls_names</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">controller_list_name</span>

        <span class="k">for</span> <span class="n">ctrl_name</span> <span class="ow">in</span> <span class="n">ctrls_names</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">ctrl_name</span> <span class="o">==</span> <span class="s1">&#39;__tango__&#39;</span><span class="p">:</span>
                <span class="n">result</span><span class="p">[</span><span class="n">ctrl_name</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
                <span class="k">continue</span>
            <span class="n">ctrl</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_ctrl_data</span><span class="p">(</span><span class="n">ctrl_name</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">use_fullname</span><span class="p">:</span>
                <span class="n">label</span> <span class="o">=</span> <span class="n">ctrl_name</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">label</span> <span class="o">=</span> <span class="n">DeviceProxy</span><span class="p">(</span><span class="n">ctrl_name</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">()</span>

            <span class="k">try</span><span class="p">:</span>
                <span class="n">value</span> <span class="o">=</span> <span class="n">ctrl</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
            <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
                <span class="n">result</span><span class="p">[</span><span class="n">label</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
                <span class="k">continue</span>

            <span class="k">if</span> <span class="n">key</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;timer&#39;</span><span class="p">,</span> <span class="s1">&#39;monitor&#39;</span><span class="p">]:</span>
                <span class="n">value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">channels</span><span class="p">[</span><span class="n">value</span><span class="p">][</span><span class="s1">&#39;label&#39;</span><span class="p">]</span>
            <span class="k">elif</span> <span class="n">key</span> <span class="o">==</span> <span class="s1">&#39;synchronizer&#39;</span> <span class="ow">and</span> <span class="n">value</span> <span class="o">!=</span> <span class="s1">&#39;software&#39;</span><span class="p">:</span>
                <span class="n">value</span> <span class="o">=</span> <span class="n">DeviceProxy</span><span class="p">(</span><span class="n">value</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">()</span>

            <span class="n">result</span><span class="p">[</span><span class="n">label</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
        <span class="k">return</span> <span class="n">result</span>

    <span class="k">def</span> <span class="nf">_get_ctrl_for_channel</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">channels_names</span><span class="p">,</span> <span class="n">unique</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">collections</span><span class="o">.</span><span class="n">OrderedDict</span><span class="p">({})</span>

        <span class="k">if</span> <span class="n">channels_names</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">channels_names</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">channel_list_name</span>

        <span class="k">for</span> <span class="n">channel_name</span> <span class="ow">in</span> <span class="n">channels_names</span><span class="p">:</span>
            <span class="n">channel</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_channel_data</span><span class="p">(</span><span class="n">channel_name</span><span class="p">)</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">ctrl</span> <span class="o">=</span> <span class="n">channel</span><span class="p">[</span><span class="s1">&#39;_controller_name&#39;</span><span class="p">]</span>
            <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
                <span class="n">ctrl</span> <span class="o">=</span> <span class="s1">&#39;__tango__&#39;</span>
            <span class="k">if</span> <span class="n">unique</span> <span class="ow">and</span> <span class="n">ctrl</span> <span class="ow">in</span> <span class="n">result</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
                <span class="k">raise</span> <span class="ne">KeyError</span><span class="p">(</span><span class="s1">&#39;There are more than one channel of the same &#39;</span>
                               <span class="s1">&#39;controller&#39;</span><span class="p">)</span>
            <span class="n">result</span><span class="p">[</span><span class="n">channel</span><span class="p">[</span><span class="s1">&#39;full_name&#39;</span><span class="p">]]</span> <span class="o">=</span> <span class="n">ctrl</span>

        <span class="k">return</span> <span class="n">result</span>

    <span class="k">def</span> <span class="nf">_get_ctrl_channels</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ctrl</span><span class="p">,</span> <span class="n">use_fullname</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="n">idx_channel</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">if</span> <span class="n">ctrl</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">controllers_channels</span><span class="p">:</span>
            <span class="n">ctrl</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">controllers_alias</span><span class="p">[</span><span class="n">ctrl</span><span class="p">]</span>
        <span class="n">channels_datas</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">controllers_channels</span><span class="p">[</span><span class="n">ctrl</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">channel_data</span> <span class="ow">in</span> <span class="n">channels_datas</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">use_fullname</span><span class="p">:</span>
                <span class="n">name</span> <span class="o">=</span> <span class="n">channel_data</span><span class="p">[</span><span class="s1">&#39;fullname&#39;</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">name</span> <span class="o">=</span> <span class="n">channel_data</span><span class="p">[</span><span class="s1">&#39;label&#39;</span><span class="p">]</span>
            <span class="n">idx</span> <span class="o">=</span> <span class="n">channel_data</span><span class="p">[</span><span class="s1">&#39;index&#39;</span><span class="p">]</span>
            <span class="n">idx_channel</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span> <span class="o">=</span> <span class="n">name</span>
        <span class="n">channels</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">idx_channel</span><span class="p">):</span>
            <span class="n">channels</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">idx_channel</span><span class="p">[</span><span class="n">idx</span><span class="p">])</span>

        <span class="k">return</span> <span class="n">channels</span>

    <span class="k">def</span> <span class="nf">_get_channels_for_element</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">element</span><span class="p">,</span> <span class="n">use_fullname</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="n">channels</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="n">element</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">controllers_channels</span><span class="p">:</span>
            <span class="n">channels</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_ctrl_channels</span><span class="p">(</span><span class="n">element</span><span class="p">,</span> <span class="n">use_fullname</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">channels</span> <span class="o">+=</span> <span class="p">[</span><span class="n">element</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">channels</span>

    <span class="k">def</span> <span class="nf">_get_ctrl_for_element</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">element</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">element</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">controllers_channels</span><span class="p">:</span>
            <span class="n">ctrl</span> <span class="o">=</span> <span class="n">element</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># TODO: find more elegant way</span>
            <span class="n">channel_ctrl</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_ctrl_for_channel</span><span class="p">([</span><span class="n">element</span><span class="p">])</span>
            <span class="n">ctrl</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">channel_ctrl</span><span class="o">.</span><span class="n">values</span><span class="p">())[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">ctrl</span>

    <span class="k">def</span> <span class="nf">applyConfiguration</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="mi">3</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_local_changes</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_pending_event_data</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_pending_event_data</span><span class="p">,</span> <span class="n">force</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s1">&#39;The configuration changed on the server &#39;</span>
                               <span class="s1">&#39;during your changes.&#39;</span><span class="p">)</span>
        <span class="n">mg</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_mg</span><span class="p">()</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">mg</span><span class="o">.</span><span class="n">setConfiguration</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_raw_data</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_local_changes</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_pending_event_data</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">mg</span><span class="o">.</span><span class="n">getConfigurationAttrEG</span><span class="p">()</span><span class="o">.</span><span class="n">readValue</span><span class="p">(</span><span class="n">force</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">force</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="k">raise</span> <span class="n">e</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_local_changes</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_pending_event_data</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">mg</span><span class="o">.</span><span class="n">_flg_event</span><span class="o">.</span><span class="n">wait</span><span class="p">(</span><span class="n">timeout</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s1">&#39;timeout on applying configuration&#39;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_getValueRefEnabledChannels</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">channels</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">use_fullname</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;get acquisition Enabled channels.</span>

<span class="sd">        :param channels: (seq&lt;str&gt;) a list of channels names to get the</span>
<span class="sd">        Enabled info</span>
<span class="sd">        :param use_fullname: (bool) returns a full name instead sardana</span>
<span class="sd">        element name</span>

<span class="sd">        :return a OrderedDict where the key are the channels and value the</span>
<span class="sd">        Enabled state</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_channels_key</span><span class="p">(</span><span class="s1">&#39;value_ref_enabled&#39;</span><span class="p">,</span> <span class="n">channels</span><span class="p">,</span>
                                      <span class="n">use_fullname</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_setValueRefEnabledChannels</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">state</span><span class="p">,</span> <span class="n">channels</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                                    <span class="n">apply_cfg</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Enable acquisition of the indicated channels.</span>

<span class="sd">        :param state: &lt;bool&gt; The state of the channels to be set.</span>
<span class="sd">        :param channels: (seq&lt;str&gt;) a sequence of strings indicating</span>
<span class="sd">                         channel names</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_set_channels_key</span><span class="p">(</span><span class="s1">&#39;value_ref_enabled&#39;</span><span class="p">,</span> <span class="n">state</span><span class="p">,</span> <span class="n">channels</span><span class="p">,</span> <span class="n">apply_cfg</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_getValueRefPatternChannels</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">channels</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">use_fullname</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;get acquisition Enabled channels.</span>

<span class="sd">        :param channels: (seq&lt;str&gt;) a list of channels names to get the</span>
<span class="sd">        Enabled info</span>
<span class="sd">        :param use_fullname: (bool) returns a full name instead sardana</span>
<span class="sd">        element name</span>

<span class="sd">        :return a OrderedDict where the key are the channels and value the</span>
<span class="sd">        Enabled state</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_channels_key</span><span class="p">(</span><span class="s1">&#39;value_ref_pattern&#39;</span><span class="p">,</span> <span class="n">channels</span><span class="p">,</span>
                                      <span class="n">use_fullname</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_setValueRefPatternChannels</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pattern</span><span class="p">,</span> <span class="n">channels</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                                    <span class="n">apply_cfg</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Enable acquisition of the indicated channels.</span>

<span class="sd">        :param pattern: &lt;str&gt; The state of the channels to be set.</span>
<span class="sd">        :param channels: (seq&lt;str&gt;) a sequence of strings indicating</span>
<span class="sd">                         channel names</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_set_channels_key</span><span class="p">(</span><span class="s1">&#39;value_ref_pattern&#39;</span><span class="p">,</span> <span class="n">pattern</span><span class="p">,</span> <span class="n">channels</span><span class="p">,</span>
                               <span class="n">apply_cfg</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_getEnabledChannels</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">channels</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">use_fullname</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;get acquisition Enabled channels.</span>

<span class="sd">        :param channels: (seq&lt;str&gt;) a list of channels names to get the</span>
<span class="sd">        Enabled info</span>
<span class="sd">        :param use_fullname: (bool) returns a full name instead sardana</span>
<span class="sd">        element name</span>

<span class="sd">        :return a OrderedDict where the key are the channels and value the</span>
<span class="sd">        Enabled state</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_channels_key</span><span class="p">(</span><span class="s1">&#39;enabled&#39;</span><span class="p">,</span> <span class="n">channels</span><span class="p">,</span> <span class="n">use_fullname</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_setEnabledChannels</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">state</span><span class="p">,</span> <span class="n">channels</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">apply_cfg</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Enable acquisition of the indicated channels.</span>

<span class="sd">        :param state: &lt;bool&gt; The state of the channels to be set.</span>
<span class="sd">        :param channels: (seq&lt;str&gt;) a sequence of strings indicating</span>
<span class="sd">                         channel names</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_set_channels_key</span><span class="p">(</span><span class="s1">&#39;enabled&#39;</span><span class="p">,</span> <span class="n">state</span><span class="p">,</span> <span class="n">channels</span><span class="p">,</span> <span class="n">apply_cfg</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_getOutputChannels</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">channels</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">use_fullname</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;get the output State of the channels.</span>

<span class="sd">        :param channels: (list&lt;str&gt;) a string indicating the channel name,</span>
<span class="sd">        in case of None, it will return all the Outputs Info</span>
<span class="sd">        :param use_fullname: (bool) returns a full name instead sardana</span>
<span class="sd">        element name</span>

<span class="sd">        :return a OrderedDict where keys are channel names and</span>
<span class="sd">        value the Outputs configuration</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_channels_key</span><span class="p">(</span><span class="s1">&#39;output&#39;</span><span class="p">,</span> <span class="n">channels</span><span class="p">,</span> <span class="n">use_fullname</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_setOutputChannels</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">state</span><span class="p">,</span> <span class="n">channels</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">apply_cfg</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set the Output state of the indicated channels.</span>

<span class="sd">        :param state: (bool) Indicate the state of the output.</span>
<span class="sd">        :param channels: (seq&lt;str&gt;) a sequence of strings indicating</span>
<span class="sd">                         channel names</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_set_channels_key</span><span class="p">(</span><span class="s1">&#39;output&#39;</span><span class="p">,</span> <span class="n">state</span><span class="p">,</span> <span class="n">channels</span><span class="p">,</span> <span class="n">apply_cfg</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_getPlotTypeChannels</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">channels</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">use_fullname</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;get the Plot Type for the channel indicated. In case of empty</span>
<span class="sd">        channel value it will return  all the Plot Type Info</span>

<span class="sd">        :param channels: (list&lt;str&gt;) Indicate the channel to return the</span>
<span class="sd">        Plot Type Info</span>
<span class="sd">        :param use_fullname: (bool) returns a full name instead sardana</span>
<span class="sd">        element name</span>

<span class="sd">        :return  a OrderedDict where keys are channel names and</span>
<span class="sd">        value the plot axes info</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># TODO: Change to return enum value SEP12</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_channels_key</span><span class="p">(</span><span class="s1">&#39;plot_type&#39;</span><span class="p">,</span> <span class="n">channels</span><span class="p">,</span> <span class="n">use_fullname</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_setPlotTypeChannels</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ptype</span><span class="p">,</span> <span class="n">channels</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">apply_cfg</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set the Plot Type for the indicated channels.</span>

<span class="sd">        :param ptype: &lt;str&gt; string indicating the type name</span>
<span class="sd">        :param channels: (seq&lt;str&gt;) a list of strings indicating the channels</span>
<span class="sd">        to apply the PlotType</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">msg_error</span> <span class="o">=</span> <span class="s1">&#39;Wrong value! PlotType allowed: &#39;</span> \
                    <span class="s1">&#39;</span><span class="si">{0}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">PlotType</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">ptype</span><span class="p">)</span> <span class="o">==</span> <span class="nb">str</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">ptype</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="ow">not</span> <span class="ow">in</span> <span class="nb">map</span><span class="p">(</span><span class="nb">str</span><span class="o">.</span><span class="n">lower</span><span class="p">,</span> <span class="n">PlotType</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">msg_error</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">PlotType</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                <span class="k">if</span> <span class="n">value</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="n">ptype</span><span class="o">.</span><span class="n">lower</span><span class="p">():</span>
                    <span class="n">ptype</span> <span class="o">=</span> <span class="n">PlotType</span><span class="p">[</span><span class="n">value</span><span class="p">]</span>
                    <span class="k">break</span>
        <span class="k">elif</span> <span class="nb">type</span><span class="p">(</span><span class="n">ptype</span><span class="p">)</span> <span class="o">==</span> <span class="nb">int</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">PlotType</span><span class="p">[</span><span class="n">ptype</span><span class="p">]</span>
            <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">msg_error</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_set_channels_key</span><span class="p">(</span><span class="s1">&#39;plot_type&#39;</span><span class="p">,</span> <span class="n">ptype</span><span class="p">,</span> <span class="n">channels</span><span class="p">,</span> <span class="n">apply_cfg</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_getPlotAxesChannels</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">channels</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">use_fullname</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;get the PlotAxes for the channel indicated. In case of empty channel</span>
<span class="sd">        value it will return  all the PlotAxes Info</span>

<span class="sd">        :param channels: (list&lt;str&gt;) Indicate the channel to return the</span>
<span class="sd">        PlotAxes Info</span>
<span class="sd">        :param use_fullname: (bool) returns a full name instead sardana</span>
<span class="sd">        element name</span>

<span class="sd">        :return  a OrderedDict where keys are channel names and</span>
<span class="sd">        value the plot axes info</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_channels_key</span><span class="p">(</span><span class="s1">&#39;plot_axes&#39;</span><span class="p">,</span> <span class="n">channels</span><span class="p">,</span> <span class="n">use_fullname</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_setPlotAxesChannels</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">axes</span><span class="p">,</span> <span class="n">channels_names</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">apply_cfg</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set the PlotAxes for the indicated channels.</span>

<span class="sd">        :param axes: &lt;seq(str)&gt; string indicating the axis name</span>
<span class="sd">        :param channels_names: (seq&lt;str&gt;) a list of strings indicating the</span>
<span class="sd">        channels to apply the PlotAxes</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Validate axes values</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">axes</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">value</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;&lt;idx&gt;&#39;</span><span class="p">,</span> <span class="s1">&#39;&lt;mov&gt;&#39;</span><span class="p">]:</span>
                <span class="k">continue</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">axes</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_channel_data</span><span class="p">(</span><span class="n">value</span><span class="p">)[</span><span class="s2">&quot;full_name&quot;</span><span class="p">]</span>

        <span class="k">if</span> <span class="n">channels_names</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">channels_names</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">channels</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>

        <span class="k">for</span> <span class="n">channel_name</span> <span class="ow">in</span> <span class="n">channels_names</span><span class="p">:</span>
            <span class="n">channel_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_channel_data</span><span class="p">(</span><span class="n">channel_name</span><span class="p">)</span>

            <span class="c1"># Check the current channel plot type</span>
            <span class="n">plot_type</span> <span class="o">=</span> <span class="n">PlotType</span><span class="p">[</span><span class="n">PlotType</span><span class="p">[</span><span class="n">channel_data</span><span class="p">[</span><span class="s1">&#39;plot_type&#39;</span><span class="p">]]]</span>
            <span class="k">if</span> <span class="n">plot_type</span> <span class="o">==</span> <span class="n">PlotType</span><span class="o">.</span><span class="n">No</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s1">&#39;You must set firs the PlotType&#39;</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">plot_type</span> <span class="o">==</span> <span class="n">PlotType</span><span class="o">.</span><span class="n">Spectrum</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">axes</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;The Spectrum Type only allows one axis&#39;</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">plot_type</span> <span class="o">==</span> <span class="n">PlotType</span><span class="o">.</span><span class="n">Image</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">axes</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">2</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;The Image Type only allows two axis&#39;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_set_channels_key</span><span class="p">(</span><span class="s1">&#39;plot_axes&#39;</span><span class="p">,</span>  <span class="n">axes</span><span class="p">,</span> <span class="p">[</span><span class="n">channel_name</span><span class="p">],</span> <span class="n">apply_cfg</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_getCtrlsTimer</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ctrls</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">use_fullname</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;get the acquisition Timer.</span>

<span class="sd">        :param ctrls: &lt;list(str)&gt; list of Controllers names to get the timer</span>
<span class="sd">        info</span>
<span class="sd">        :param use_fullname: &lt;bool&gt; returns a full name instead sardana</span>
<span class="sd">        element name</span>

<span class="sd">        :return a OrderedDict where keys are controller names and</span>
<span class="sd">        value the Timer Info</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_ctrls_key</span><span class="p">(</span><span class="s1">&#39;timer&#39;</span><span class="p">,</span> <span class="n">ctrls</span><span class="p">,</span> <span class="n">use_fullname</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_setCtrlsTimer</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">timers</span><span class="p">,</span> <span class="n">apply_cfg</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set the acquisition Timer to the controllers compatibles,</span>
<span class="sd">        it finds the controller comptible with this timer and set it</span>
<span class="sd">        .</span>
<span class="sd">        :param timer_name: &lt;str&gt; strings indicating the timer name</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_ctrl_for_channel</span><span class="p">(</span><span class="n">timers</span><span class="p">,</span> <span class="n">unique</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">meas_ctrl</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">channels</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">timer</span><span class="p">][</span><span class="s1">&#39;_controller_name&#39;</span><span class="p">]</span>

        <span class="k">for</span> <span class="n">timer</span><span class="p">,</span> <span class="n">ctrl</span> <span class="ow">in</span> <span class="n">result</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">ctrl</span> <span class="o">==</span> <span class="n">meas_ctrl</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_local_changes</span> <span class="o">=</span> <span class="kc">True</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_raw_data</span><span class="p">[</span><span class="s1">&#39;timer&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">timer</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_set_ctrls_key</span><span class="p">(</span><span class="s1">&#39;timer&#39;</span><span class="p">,</span> <span class="n">timer</span><span class="p">,</span> <span class="p">[</span><span class="n">ctrl</span><span class="p">],</span> <span class="n">apply_cfg</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_getCtrlsMonitor</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ctrls</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">use_fullname</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;get the Monitor for the channel indicated. In case of empty channel</span>
<span class="sd">        value it will return  all the Monitor Info</span>

<span class="sd">        :param ctrls: &lt;str&gt; Indicate the controllers to return the Monitor Info</span>
<span class="sd">        :param use_fullname: &lt;bool&gt; returns a full name instead sardana</span>
<span class="sd">        element name</span>

<span class="sd">        :return  a OrderedDict where keys are channel names and</span>
<span class="sd">        value the Monitor Info</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_ctrls_key</span><span class="p">(</span><span class="s1">&#39;monitor&#39;</span><span class="p">,</span> <span class="n">ctrls</span><span class="p">,</span> <span class="n">use_fullname</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_setCtrlsMonitor</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">monitors</span><span class="p">,</span> <span class="n">apply_cfg</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set the Monitor for to the controllers compatibles,</span>
<span class="sd">        it finds the controller comptible with this timer and set it</span>

<span class="sd">        :param monitors: (seq&lt;str&gt;) a list of strings indicating the channels</span>
<span class="sd">        to apply the monitor</span>
<span class="sd">        :param monitor: &lt;str&gt; string indicating the monitor name</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_ctrl_for_channel</span><span class="p">(</span><span class="n">monitors</span><span class="p">,</span> <span class="n">unique</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">meas_ctrl</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">channels</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">monitor</span><span class="p">][</span><span class="s1">&#39;_controller_name&#39;</span><span class="p">]</span>

        <span class="k">for</span> <span class="n">monitor</span><span class="p">,</span> <span class="n">ctrl</span> <span class="ow">in</span> <span class="n">result</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">ctrl</span> <span class="o">==</span> <span class="n">meas_ctrl</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_local_changes</span> <span class="o">=</span> <span class="kc">True</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_raw_data</span><span class="p">[</span><span class="s1">&#39;monitor&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">monitor</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_set_ctrls_key</span><span class="p">(</span><span class="s1">&#39;monitor&#39;</span><span class="p">,</span> <span class="n">monitor</span><span class="p">,</span> <span class="p">[</span><span class="n">ctrl</span><span class="p">],</span> <span class="n">apply_cfg</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_getCtrlsSynchronization</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ctrls</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">use_fullname</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;get the Synchronization for the channel indicated. In case of empty</span>
<span class="sd">        ctrl value it will return  all the Synchronization Info</span>

<span class="sd">        :param ctrl: &lt;str&gt; Indicate the controllers to return the</span>
<span class="sd">        Synchronization Info</span>
<span class="sd">        :param use_fullname: &lt;bool&gt; returns a full name instead sardana</span>
<span class="sd">        element name</span>

<span class="sd">        :return  a OrderedDict where keys are controllers names and</span>
<span class="sd">        value the Synchronization Info</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_ctrls_key</span><span class="p">(</span><span class="s1">&#39;synchronization&#39;</span><span class="p">,</span> <span class="n">ctrls</span><span class="p">,</span> <span class="n">use_fullname</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_setCtrlsSynchronization</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">synchronization</span><span class="p">,</span> <span class="n">ctrls</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                                 <span class="n">apply_cfg</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set the Synchronization to the indicated controllers.</span>

<span class="sd">        :param synchronization: &lt;str&gt; string indicating the synchronization</span>
<span class="sd">        :param ctrls: (seq&lt;str&gt;) a list of strings indicating the channels</span>
<span class="sd">        to apply the Synchronization</span>
<span class="sd">        name</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">msg_error</span> <span class="o">=</span> <span class="s1">&#39;Wrong value! Synchronization allowed: &#39;</span> \
                    <span class="s1">&#39;</span><span class="si">{0}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">AcqSynchType</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">synchronization</span><span class="p">)</span> <span class="o">==</span> <span class="nb">str</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">synchronization</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="ow">not</span> <span class="ow">in</span> <span class="nb">map</span><span class="p">(</span><span class="nb">str</span><span class="o">.</span><span class="n">lower</span><span class="p">,</span>
                                                  <span class="n">AcqSynchType</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">msg_error</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">AcqSynchType</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                <span class="k">if</span> <span class="n">value</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="n">synchronization</span><span class="o">.</span><span class="n">lower</span><span class="p">():</span>
                    <span class="n">synchronization</span> <span class="o">=</span> <span class="n">AcqSynchType</span><span class="p">[</span><span class="n">value</span><span class="p">]</span>
                    <span class="k">break</span>
        <span class="k">elif</span> <span class="nb">type</span><span class="p">(</span><span class="n">synchronization</span><span class="p">)</span> <span class="o">==</span> <span class="nb">int</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">AcqSynchType</span><span class="p">[</span><span class="n">synchronization</span><span class="p">]</span>
            <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">msg_error</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_set_ctrls_key</span><span class="p">(</span><span class="s1">&#39;synchronization&#39;</span><span class="p">,</span> <span class="n">synchronization</span><span class="p">,</span> <span class="n">ctrls</span><span class="p">,</span>
                            <span class="n">apply_cfg</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_getCtrlsSynchronizer</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ctrls</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">use_fullname</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;get the synchronizer for the channel indicated. In case of empty</span>
<span class="sd">        channel value it will return  all the Synchronizers Info</span>

<span class="sd">        :param ctrls: &lt;str&gt; Indicate the controllers to return the</span>
<span class="sd">        Synchronizer Info</span>
<span class="sd">        :param use_fullname: &lt;bool&gt; returns a full name instead sardana</span>
<span class="sd">        element name</span>
<span class="sd">        :return  a OrderedDict where keys are controllers names and</span>
<span class="sd">        value the synchronizer info</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_ctrls_key</span><span class="p">(</span><span class="s1">&#39;synchronizer&#39;</span><span class="p">,</span> <span class="n">ctrls</span><span class="p">,</span> <span class="n">use_fullname</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_setCtrlsSynchronizer</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">synchronizer</span><span class="p">,</span> <span class="n">ctrls</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">apply_cfg</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set the synchronizer for the indicated controollers. In case of</span>
<span class="sd">        empty ctrls value it will be applied to all the controllers</span>

<span class="sd">        :param syncronizer: &lt;str&gt; string indicating the synchronizer name</span>
<span class="sd">        :param ctrls: (seq&lt;str&gt;) a list of strings indicating the</span>
<span class="sd">        controllers to apply the synchronizer</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">synchronizer</span> <span class="o">==</span> <span class="s1">&#39;software&#39;</span><span class="p">:</span>
            <span class="k">pass</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># TODO: Improve how to check if the element is a trigger_gate</span>
            <span class="n">sync</span> <span class="o">=</span> <span class="n">Device</span><span class="p">(</span><span class="n">synchronizer</span><span class="p">)</span>
            <span class="k">if</span> <span class="s1">&#39;triggergate&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">sync</span><span class="o">.</span><span class="n">fullname</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;The &quot;</span><span class="si">{0}</span><span class="s1">&quot; is not a &#39;</span>
                                 <span class="s1">&#39;triggergate&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">synchronizer</span><span class="p">))</span>
            <span class="n">synchronizer</span> <span class="o">=</span> <span class="n">sync</span><span class="o">.</span><span class="n">fullname</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_set_ctrls_key</span><span class="p">(</span><span class="s1">&#39;synchronizer&#39;</span><span class="p">,</span> <span class="n">synchronizer</span><span class="p">,</span> <span class="n">ctrls</span><span class="p">,</span> <span class="n">apply_cfg</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_getTimerName</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_getTimer</span><span class="p">()[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span>

    <span class="k">def</span> <span class="nf">_getTimer</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">channels</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">timer</span><span class="p">]</span>

    <span class="k">def</span> <span class="nf">_getTimerValue</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_getTimerName</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">_getMonitorName</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_getMonitor</span><span class="p">()[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span>

    <span class="k">def</span> <span class="nf">_getMonitor</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">channels</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">monitor</span><span class="p">]</span>

    <span class="k">def</span> <span class="nf">getValues</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parallel</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">parallel</span><span class="o">=</span><span class="n">parallel</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_getCounters</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">c</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">getChannels</span><span class="p">()</span> <span class="k">if</span> <span class="n">c</span><span class="p">[</span><span class="s1">&#39;full_name&#39;</span><span class="p">]</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">timer</span><span class="p">]</span>

    <span class="k">def</span> <span class="nf">_getChannelNames</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">ch</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span> <span class="k">for</span> <span class="n">ch</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">getChannels</span><span class="p">()]</span>

    <span class="k">def</span> <span class="nf">_getCounterNames</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">ch</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span> <span class="k">for</span> <span class="n">ch</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">getCounters</span><span class="p">()]</span>

    <span class="k">def</span> <span class="nf">_getChannelLabels</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">ch</span><span class="p">[</span><span class="s1">&#39;label&#39;</span><span class="p">]</span> <span class="k">for</span> <span class="n">ch</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">getChannels</span><span class="p">()]</span>

    <span class="k">def</span> <span class="nf">_getCounterLabels</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">ch</span><span class="p">[</span><span class="s1">&#39;label&#39;</span><span class="p">]</span> <span class="k">for</span> <span class="n">ch</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">getCounters</span><span class="p">()]</span>

    <span class="k">def</span> <span class="nf">_getChannel</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">channels</span><span class="p">[</span><span class="n">name</span><span class="p">]</span>

    <span class="k">def</span> <span class="nf">getChannelsEnabledInfo</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns information about **only enabled** channels present in the</span>
<span class="sd">        measurement group in a form of ordered, based on the channel index,</span>
<span class="sd">        list.</span>

<span class="sd">        :return: list with channels info</span>
<span class="sd">        :rtype: list&lt;TangoChannelInfo&gt;</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">getChannelsInfoList</span><span class="p">(</span><span class="n">only_enabled</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">getCountersInfo</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">getCountersInfoList</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">setTimer</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">timer</span><span class="p">,</span> <span class="n">apply_cfg</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;DEPRECATED: Set the Global Timer to the measurement group.</span>

<span class="sd">        Also it changes the timer in the controllers with the previous timer.</span>

<span class="sd">        :param timer: &lt;str&gt; timer name</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_mg</span><span class="p">()</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;setTimer() is deprecated since Jul20. &quot;</span>
                           <span class="s2">&quot;Global measurement group timer does not exist&quot;</span><span class="p">)</span>
        <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_ctrl_for_channel</span><span class="p">([</span><span class="n">timer</span><span class="p">],</span> <span class="n">unique</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">timer</span><span class="p">,</span> <span class="n">ctrl</span> <span class="ow">in</span> <span class="n">result</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_local_changes</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_raw_data</span><span class="p">[</span><span class="s1">&#39;timer&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">timer</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_set_ctrls_key</span><span class="p">(</span><span class="s1">&#39;timer&#39;</span><span class="p">,</span> <span class="n">timer</span><span class="p">,</span> <span class="p">[</span><span class="n">ctrl</span><span class="p">],</span> <span class="n">apply_cfg</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">getTimer</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;DEPRECATED&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_mg</span><span class="p">()</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;getTimer() is deprecated since Jul20. &quot;</span>
                           <span class="s2">&quot;Global measurement group timer does not exist&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_getTimer</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">getMonitor</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;DEPRECATED&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_mg</span><span class="p">()</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;getMonitor() is deprecated since Jul20. &quot;</span>
                           <span class="s2">&quot;Global measurement group monitor does not exist&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_getMonitor</span><span class="p">()</span>

    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_raw_data</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">sort_keys</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>


<div class="viewcode-block" id="MeasurementGroup"><a class="viewcode-back" href="../../../../../../devel/api/sardana/taurus/core/tango/sardana/pool.html#sardana.taurus.core.tango.sardana.pool.MeasurementGroup">[docs]</a><span class="k">class</span> <span class="nc">MeasurementGroup</span><span class="p">(</span><span class="n">PoolElement</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;MeasurementGroup Sardana-Taurus extension.</span>

<span class="sd">    Setting configuration parameters using e.g.,</span>
<span class="sd">    `~sardana.taurus.core.tango.sardana.pool.MeasurementGroup.setEnabled` or</span>
<span class="sd">    `~sardana.taurus.core.tango.sardana.pool.MeasurementGroup.setTimer`, etc.</span>
<span class="sd">    by default applies changes on the server. Since setting the configuration</span>
<span class="sd">    means passing to the server all the configuration parameters of</span>
<span class="sd">    the measurement group at once this behavior can be changed with the</span>
<span class="sd">    ``apply=False``. Then the configuration changes are kept locally.</span>
<span class="sd">    This is useful when changing more then one parameter. In this case only</span>
<span class="sd">    setting of the last parameter should use ``apply=True`` or use</span>
<span class="sd">    `~sardana.taurus.core.tango.sardana.pool.MeasurementGroup.applyConfiguration`</span>
<span class="sd">    afterwards::</span>

<span class="sd">        # or in a macro use: meas_grp = self.getMeasurementGroup(&quot;mntgrp01&quot;)</span>
<span class="sd">        meas_grp = taurus.Device(&quot;mntgrp01&quot;)</span>
<span class="sd">        meas_grp.setEnabled(False, apply=False)</span>
<span class="sd">        meas_grp.setEnabled(True, &quot;ct01&quot;, &quot;ct02&quot;)</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;PoolElement initialization.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_configuration</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_channels</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_last_integ_time</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">call__init__</span><span class="p">(</span><span class="n">PoolElement</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_flg_event</span> <span class="o">=</span> <span class="n">threading</span><span class="o">.</span><span class="n">Event</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__cfg_attr</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getAttribute</span><span class="p">(</span><span class="s1">&#39;configuration&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__cfg_attr</span><span class="o">.</span><span class="n">addListener</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">on_configuration_changed</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_value_buffer_cb</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_value_buffer_channels</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">codec_name</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">sardanacustomsettings</span><span class="p">,</span> <span class="s2">&quot;VALUE_BUFFER_CODEC&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_value_buffer_codec</span> <span class="o">=</span> <span class="n">CodecFactory</span><span class="p">()</span><span class="o">.</span><span class="n">getCodec</span><span class="p">(</span><span class="n">codec_name</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_value_ref_buffer_cb</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_value_ref_buffer_channels</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">codec_name</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">sardanacustomsettings</span><span class="p">,</span> <span class="s2">&quot;VALUE_REF_BUFFER_CODEC&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_value_ref_buffer_codec</span> <span class="o">=</span> <span class="n">CodecFactory</span><span class="p">()</span><span class="o">.</span><span class="n">getCodec</span><span class="p">(</span><span class="n">codec_name</span><span class="p">)</span>

<div class="viewcode-block" id="MeasurementGroup.cleanUp"><a class="viewcode-back" href="../../../../../../devel/api/sardana/taurus/core/tango/sardana/pool.html#sardana.taurus.core.tango.sardana.pool.MeasurementGroup.cleanUp">[docs]</a>    <span class="k">def</span> <span class="nf">cleanUp</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">PoolElement</span><span class="o">.</span><span class="n">cleanUp</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="n">f</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">factory</span><span class="p">()</span>
        <span class="n">f</span><span class="o">.</span><span class="n">removeExistingAttribute</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__cfg_attr</span><span class="p">)</span></div>

    <span class="k">def</span> <span class="nf">_create_str_tuple</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">channel_names</span> <span class="o">=</span> <span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">getChannelNames</span><span class="p">())</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">getName</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">getTimerName</span><span class="p">(),</span> <span class="n">channel_names</span>

<div class="viewcode-block" id="MeasurementGroup.getConfigurationAttrEG"><a class="viewcode-back" href="../../../../../../devel/api/sardana/taurus/core/tango/sardana/pool.html#sardana.taurus.core.tango.sardana.pool.MeasurementGroup.getConfigurationAttrEG">[docs]</a>    <span class="k">def</span> <span class="nf">getConfigurationAttrEG</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_getAttrEG</span><span class="p">(</span><span class="s1">&#39;Configuration&#39;</span><span class="p">)</span></div>

<div class="viewcode-block" id="MeasurementGroup.setConfiguration"><a class="viewcode-back" href="../../../../../../devel/api/sardana/taurus/core/tango/sardana/pool.html#sardana.taurus.core.tango.sardana.pool.MeasurementGroup.setConfiguration">[docs]</a>    <span class="k">def</span> <span class="nf">setConfiguration</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">configuration</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_flg_event</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
        <span class="n">codec</span> <span class="o">=</span> <span class="n">CodecFactory</span><span class="p">()</span><span class="o">.</span><span class="n">getCodec</span><span class="p">(</span><span class="s1">&#39;json&#39;</span><span class="p">)</span>
        <span class="n">f</span><span class="p">,</span> <span class="n">data</span> <span class="o">=</span> <span class="n">codec</span><span class="o">.</span><span class="n">encode</span><span class="p">((</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">configuration</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">write_attribute</span><span class="p">(</span><span class="s1">&#39;configuration&#39;</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span></div>

    <span class="k">def</span> <span class="nf">_setConfiguration</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_configuration</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_configuration</span> <span class="o">=</span> <span class="n">MGConfiguration</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_configuration</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

<div class="viewcode-block" id="MeasurementGroup.getConfiguration"><a class="viewcode-back" href="../../../../../../devel/api/sardana/taurus/core/tango/sardana/pool.html#sardana.taurus.core.tango.sardana.pool.MeasurementGroup.getConfiguration">[docs]</a>    <span class="k">def</span> <span class="nf">getConfiguration</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">force</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">force</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">_configuration</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getConfigurationAttrEG</span><span class="p">()</span><span class="o">.</span><span class="n">readValue</span><span class="p">(</span><span class="n">force</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_setConfiguration</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_configuration</span></div>

<div class="viewcode-block" id="MeasurementGroup.on_configuration_changed"><a class="viewcode-back" href="../../../../../../devel/api/sardana/taurus/core/tango/sardana/pool.html#sardana.taurus.core.tango.sardana.pool.MeasurementGroup.on_configuration_changed">[docs]</a>    <span class="k">def</span> <span class="nf">on_configuration_changed</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">evt_src</span><span class="p">,</span> <span class="n">evt_type</span><span class="p">,</span> <span class="n">evt_value</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">evt_type</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">CHANGE_EVT_TYPES</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Configuration changed&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_setConfiguration</span><span class="p">(</span><span class="n">evt_value</span><span class="o">.</span><span class="n">rvalue</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_flg_event</span><span class="o">.</span><span class="n">set</span><span class="p">()</span></div>

<div class="viewcode-block" id="MeasurementGroup.getValueBuffers"><a class="viewcode-back" href="../../../../../../devel/api/sardana/taurus/core/tango/sardana/pool.html#sardana.taurus.core.tango.sardana.pool.MeasurementGroup.getValueBuffers">[docs]</a>    <span class="k">def</span> <span class="nf">getValueBuffers</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">value_buffers</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">channel_info</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">getChannels</span><span class="p">():</span>
            <span class="n">channel</span> <span class="o">=</span> <span class="n">Device</span><span class="p">(</span><span class="n">channel_info</span><span class="p">[</span><span class="s2">&quot;full_name&quot;</span><span class="p">])</span>
            <span class="n">value_buffers</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">channel</span><span class="o">.</span><span class="n">getValueBuffer</span><span class="p">())</span>
        <span class="k">return</span> <span class="n">value_buffers</span></div>

<div class="viewcode-block" id="MeasurementGroup.getIntegrationTime"><a class="viewcode-back" href="../../../../../../devel/api/sardana/taurus/core/tango/sardana/pool.html#sardana.taurus.core.tango.sardana.pool.MeasurementGroup.getIntegrationTime">[docs]</a>    <span class="k">def</span> <span class="nf">getIntegrationTime</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_getAttrValue</span><span class="p">(</span><span class="s1">&#39;IntegrationTime&#39;</span><span class="p">)</span></div>

<div class="viewcode-block" id="MeasurementGroup.getIntegrationTimeObj"><a class="viewcode-back" href="../../../../../../devel/api/sardana/taurus/core/tango/sardana/pool.html#sardana.taurus.core.tango.sardana.pool.MeasurementGroup.getIntegrationTimeObj">[docs]</a>    <span class="k">def</span> <span class="nf">getIntegrationTimeObj</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_getAttrEG</span><span class="p">(</span><span class="s1">&#39;IntegrationTime&#39;</span><span class="p">)</span></div>

<div class="viewcode-block" id="MeasurementGroup.setIntegrationTime"><a class="viewcode-back" href="../../../../../../devel/api/sardana/taurus/core/tango/sardana/pool.html#sardana.taurus.core.tango.sardana.pool.MeasurementGroup.setIntegrationTime">[docs]</a>    <span class="k">def</span> <span class="nf">setIntegrationTime</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ctime</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">getIntegrationTimeObj</span><span class="p">()</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">ctime</span><span class="p">)</span></div>

<div class="viewcode-block" id="MeasurementGroup.putIntegrationTime"><a class="viewcode-back" href="../../../../../../devel/api/sardana/taurus/core/tango/sardana/pool.html#sardana.taurus.core.tango.sardana.pool.MeasurementGroup.putIntegrationTime">[docs]</a>    <span class="k">def</span> <span class="nf">putIntegrationTime</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ctime</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_last_integ_time</span> <span class="o">==</span> <span class="n">ctime</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_last_integ_time</span> <span class="o">=</span> <span class="n">ctime</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">getIntegrationTimeObj</span><span class="p">()</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">ctime</span><span class="p">)</span></div>

<div class="viewcode-block" id="MeasurementGroup.getAcquisitionModeObj"><a class="viewcode-back" href="../../../../../../devel/api/sardana/taurus/core/tango/sardana/pool.html#sardana.taurus.core.tango.sardana.pool.MeasurementGroup.getAcquisitionModeObj">[docs]</a>    <span class="k">def</span> <span class="nf">getAcquisitionModeObj</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_getAttrEG</span><span class="p">(</span><span class="s1">&#39;AcquisitionMode&#39;</span><span class="p">)</span></div>

<div class="viewcode-block" id="MeasurementGroup.getAcquisitionMode"><a class="viewcode-back" href="../../../../../../devel/api/sardana/taurus/core/tango/sardana/pool.html#sardana.taurus.core.tango.sardana.pool.MeasurementGroup.getAcquisitionMode">[docs]</a>    <span class="k">def</span> <span class="nf">getAcquisitionMode</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_getAttrValue</span><span class="p">(</span><span class="s1">&#39;AcquisitionMode&#39;</span><span class="p">)</span></div>

<div class="viewcode-block" id="MeasurementGroup.setAcquisitionMode"><a class="viewcode-back" href="../../../../../../devel/api/sardana/taurus/core/tango/sardana/pool.html#sardana.taurus.core.tango.sardana.pool.MeasurementGroup.setAcquisitionMode">[docs]</a>    <span class="k">def</span> <span class="nf">setAcquisitionMode</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">acqMode</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">getAcquisitionModeObj</span><span class="p">()</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">acqMode</span><span class="p">)</span></div>

<div class="viewcode-block" id="MeasurementGroup.getSynchDescriptionObj"><a class="viewcode-back" href="../../../../../../devel/api/sardana/taurus/core/tango/sardana/pool.html#sardana.taurus.core.tango.sardana.pool.MeasurementGroup.getSynchDescriptionObj">[docs]</a>    <span class="k">def</span> <span class="nf">getSynchDescriptionObj</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_getAttrEG</span><span class="p">(</span><span class="s1">&#39;SynchDescription&#39;</span><span class="p">)</span></div>

<div class="viewcode-block" id="MeasurementGroup.getSynchDescription"><a class="viewcode-back" href="../../../../../../devel/api/sardana/taurus/core/tango/sardana/pool.html#sardana.taurus.core.tango.sardana.pool.MeasurementGroup.getSynchDescription">[docs]</a>    <span class="k">def</span> <span class="nf">getSynchDescription</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_getAttrValue</span><span class="p">(</span><span class="s1">&#39;SynchDescription&#39;</span><span class="p">)</span></div>

<div class="viewcode-block" id="MeasurementGroup.setSynchDescription"><a class="viewcode-back" href="../../../../../../devel/api/sardana/taurus/core/tango/sardana/pool.html#sardana.taurus.core.tango.sardana.pool.MeasurementGroup.setSynchDescription">[docs]</a>    <span class="k">def</span> <span class="nf">setSynchDescription</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">synch_description</span><span class="p">):</span>
        <span class="n">codec</span> <span class="o">=</span> <span class="n">CodecFactory</span><span class="p">()</span><span class="o">.</span><span class="n">getCodec</span><span class="p">(</span><span class="s1">&#39;json&#39;</span><span class="p">)</span>
        <span class="n">_</span><span class="p">,</span> <span class="n">data</span> <span class="o">=</span> <span class="n">codec</span><span class="o">.</span><span class="n">encode</span><span class="p">((</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">synch_description</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">getSynchDescriptionObj</span><span class="p">()</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_last_integ_time</span> <span class="o">=</span> <span class="kc">None</span></div>

    <span class="k">def</span> <span class="nf">_get_channels_for_elements</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">elements</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">elements</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span>
        <span class="n">config</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getConfiguration</span><span class="p">()</span>
        <span class="n">channels</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">element</span> <span class="ow">in</span> <span class="n">elements</span><span class="p">:</span>
            <span class="n">channels</span> <span class="o">+=</span> <span class="n">config</span><span class="o">.</span><span class="n">_get_channels_for_element</span><span class="p">(</span><span class="n">element</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">channels</span>

    <span class="k">def</span> <span class="nf">_get_ctrl_for_elements</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">elements</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">elements</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span>
        <span class="n">ctrls</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">config</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getConfiguration</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">element</span> <span class="ow">in</span> <span class="n">elements</span><span class="p">:</span>
            <span class="n">ctrl</span> <span class="o">=</span> <span class="n">config</span><span class="o">.</span><span class="n">_get_ctrl_for_element</span><span class="p">(</span><span class="n">element</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">ctrl</span> <span class="ow">in</span> <span class="n">ctrls</span><span class="p">:</span>
                <span class="k">continue</span>
            <span class="n">ctrls</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ctrl</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">ctrls</span>

<div class="viewcode-block" id="MeasurementGroup.setOutput"><a class="viewcode-back" href="../../../../../../devel/api/sardana/taurus/core/tango/sardana/pool.html#sardana.taurus.core.tango.sardana.pool.MeasurementGroup.setOutput">[docs]</a>    <span class="k">def</span> <span class="nf">setOutput</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">output</span><span class="p">,</span> <span class="o">*</span><span class="n">elements</span><span class="p">,</span> <span class="n">apply</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set the output configuration for the given elements.</span>

<span class="sd">        Channels and controllers are accepted as elements. Setting the output</span>
<span class="sd">        on the controller means setting it to all channels of this controller</span>
<span class="sd">        present in this measurement group.</span>

<span class="sd">        :param output: `True` - output enabled, `False` - output disabled</span>
<span class="sd">        :type output: bool</span>
<span class="sd">        :param elements: sequence of element names or full names, no elements</span>
<span class="sd">            means set to all</span>
<span class="sd">        :type elements: list(str)</span>
<span class="sd">        :param apply: `True` - apply on the server, `False` - do not apply yet</span>
<span class="sd">            on the server and keep locally (default: `True`)</span>
<span class="sd">        :type apply: bool</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">channels</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_channels_for_elements</span><span class="p">(</span><span class="n">elements</span><span class="p">)</span>
        <span class="n">config</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getConfiguration</span><span class="p">()</span>
        <span class="n">config</span><span class="o">.</span><span class="n">_setOutputChannels</span><span class="p">(</span><span class="n">output</span><span class="p">,</span> <span class="n">channels</span><span class="p">,</span> <span class="n">apply_cfg</span><span class="o">=</span><span class="n">apply</span><span class="p">)</span></div>

<div class="viewcode-block" id="MeasurementGroup.getOutput"><a class="viewcode-back" href="../../../../../../devel/api/sardana/taurus/core/tango/sardana/pool.html#sardana.taurus.core.tango.sardana.pool.MeasurementGroup.getOutput">[docs]</a>    <span class="k">def</span> <span class="nf">getOutput</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">elements</span><span class="p">,</span> <span class="n">ret_full_name</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get the output configuration of the given elements.</span>

<span class="sd">        Channels and controllers are accepted as elements. Getting the output</span>
<span class="sd">        from the controller means getting it from all channels of this</span>
<span class="sd">        controller present in this measurement group.</span>

<span class="sd">        :param elements: sequence of element names or full names, no elements</span>
<span class="sd">            means get from all</span>
<span class="sd">        :type elements: list(str)</span>
<span class="sd">        :param ret_full_name: whether keys in the returned dictionary are</span>
<span class="sd">            full names or names (default: `False` means return names)</span>
<span class="sd">        :type ret_full_name: bool</span>
<span class="sd">        :return: ordered dictionary where keys are **channel** names (or full</span>
<span class="sd">            names if `ret_full_name=True`) and values are their output</span>
<span class="sd">            configurations. Note that even if the *elements* contained</span>
<span class="sd">            controllers, the returned configuration will always contain</span>
<span class="sd">            only channels.</span>
<span class="sd">        :rtype: dict(str, bool)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">channels</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_channels_for_elements</span><span class="p">(</span><span class="n">elements</span><span class="p">)</span>
        <span class="n">config</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getConfiguration</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">config</span><span class="o">.</span><span class="n">_getOutputChannels</span><span class="p">(</span><span class="n">channels</span><span class="p">,</span> <span class="n">use_fullname</span><span class="o">=</span><span class="n">ret_full_name</span><span class="p">)</span></div>

<div class="viewcode-block" id="MeasurementGroup.setEnabled"><a class="viewcode-back" href="../../../../../../devel/api/sardana/taurus/core/tango/sardana/pool.html#sardana.taurus.core.tango.sardana.pool.MeasurementGroup.setEnabled">[docs]</a>    <span class="k">def</span> <span class="nf">setEnabled</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">enabled</span><span class="p">,</span> <span class="o">*</span><span class="n">elements</span><span class="p">,</span> <span class="n">apply</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set the enabled configuration for the given elements.</span>

<span class="sd">        Channels and controllers are accepted as elements. Setting the enabled</span>
<span class="sd">        on the controller means setting it to all channels of this controller</span>
<span class="sd">        present in this measurement group.</span>

<span class="sd">        :param enabled: `True` - element enabled, `False` - element disabled</span>
<span class="sd">        :type enabled: bool</span>
<span class="sd">        :param elements: sequence of element names or full names, no elements</span>
<span class="sd">            means set to all</span>
<span class="sd">        :type elements: list(str)</span>
<span class="sd">        :param apply: `True` - apply on the server, `False` - do not apply yet</span>
<span class="sd">            on the server and keep locally (default: `True`)</span>
<span class="sd">        :type apply: bool</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">channels</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_channels_for_elements</span><span class="p">(</span><span class="n">elements</span><span class="p">)</span>
        <span class="n">config</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getConfiguration</span><span class="p">()</span>
        <span class="n">config</span><span class="o">.</span><span class="n">_setEnabledChannels</span><span class="p">(</span><span class="n">enabled</span><span class="p">,</span> <span class="n">channels</span><span class="p">,</span> <span class="n">apply_cfg</span><span class="o">=</span><span class="n">apply</span><span class="p">)</span></div>

<div class="viewcode-block" id="MeasurementGroup.getEnabled"><a class="viewcode-back" href="../../../../../../devel/api/sardana/taurus/core/tango/sardana/pool.html#sardana.taurus.core.tango.sardana.pool.MeasurementGroup.getEnabled">[docs]</a>    <span class="k">def</span> <span class="nf">getEnabled</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">elements</span><span class="p">,</span> <span class="n">ret_full_name</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get the output configuration of the given elements.</span>

<span class="sd">        Channels and controllers are accepted as elements. Getting the enabled</span>
<span class="sd">        from the controller means getting it from all channels of this</span>
<span class="sd">        controller present in this measurement group.</span>

<span class="sd">        :param elements: sequence of element names or full names, no elements</span>
<span class="sd">            means get from all</span>
<span class="sd">        :type elements: list(str)</span>
<span class="sd">        :param ret_full_name: whether keys in the returned dictionary are</span>
<span class="sd">            full names or names (default: `False` means return names)</span>
<span class="sd">        :type ret_full_name: bool</span>
<span class="sd">        :return: ordered dictionary where keys are **channel** names (or full</span>
<span class="sd">            names if `ret_full_name=True`) and values are their output</span>
<span class="sd">            configurations. Note that even if the *elements* contained</span>
<span class="sd">            controllers, the returned configuration will always contain</span>
<span class="sd">            only channels.</span>
<span class="sd">        :rtype: dict(str, bool)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">channels</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_channels_for_elements</span><span class="p">(</span><span class="n">elements</span><span class="p">)</span>
        <span class="n">config</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getConfiguration</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">config</span><span class="o">.</span><span class="n">_getEnabledChannels</span><span class="p">(</span><span class="n">channels</span><span class="p">,</span> <span class="n">use_fullname</span><span class="o">=</span><span class="n">ret_full_name</span><span class="p">)</span></div>

<div class="viewcode-block" id="MeasurementGroup.setPlotType"><a class="viewcode-back" href="../../../../../../devel/api/sardana/taurus/core/tango/sardana/pool.html#sardana.taurus.core.tango.sardana.pool.MeasurementGroup.setPlotType">[docs]</a>    <span class="k">def</span> <span class="nf">setPlotType</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">plot_type</span><span class="p">,</span> <span class="o">*</span><span class="n">elements</span><span class="p">,</span> <span class="n">apply</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set the enabled configuration for the given elements.</span>

<span class="sd">        Channels and controllers are accepted as elements. Setting the plot</span>
<span class="sd">        type on the controller means setting it to all channels of this</span>
<span class="sd">        controller present in this measurement group.</span>

<span class="sd">        :param plot_type: &#39;No&#39;/0 , &#39;Spectrum&#39;/1, &#39;Image&#39;/2</span>
<span class="sd">        :type plot_type: str or int</span>
<span class="sd">        :param elements: sequence of element names or full names, no elements</span>
<span class="sd">            means set to all</span>
<span class="sd">        :type elements: list(str)</span>
<span class="sd">        :param apply: `True` - apply on the server, `False` - do not apply yet</span>
<span class="sd">            on the server and keep locally (default: `True`)</span>
<span class="sd">        :type apply: bool</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">channels</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_channels_for_elements</span><span class="p">(</span><span class="n">elements</span><span class="p">)</span>
        <span class="n">config</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getConfiguration</span><span class="p">()</span>
        <span class="n">config</span><span class="o">.</span><span class="n">_setPlotTypeChannels</span><span class="p">(</span><span class="n">plot_type</span><span class="p">,</span> <span class="n">channels</span><span class="p">,</span> <span class="n">apply_cfg</span><span class="o">=</span><span class="n">apply</span><span class="p">)</span></div>

<div class="viewcode-block" id="MeasurementGroup.getPlotType"><a class="viewcode-back" href="../../../../../../devel/api/sardana/taurus/core/tango/sardana/pool.html#sardana.taurus.core.tango.sardana.pool.MeasurementGroup.getPlotType">[docs]</a>    <span class="k">def</span> <span class="nf">getPlotType</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">elements</span><span class="p">,</span> <span class="n">ret_full_name</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get the output configuration of the given elements.</span>

<span class="sd">        Channels and controllers are accepted as elements. Getting the plot</span>
<span class="sd">        type from the controller means getting it from all channels of this</span>
<span class="sd">        controller present in this measurement group.</span>

<span class="sd">        :param elements: sequence of element names or full names, no elements</span>
<span class="sd">            means get from all</span>
<span class="sd">        :type elements: list(str)</span>
<span class="sd">        :param ret_full_name: whether keys in the returned dictionary are</span>
<span class="sd">            full names or names (default: `False` means return names)</span>
<span class="sd">        :type ret_full_name: bool</span>
<span class="sd">        :return: ordered dictionary where keys are **channel** names (or full</span>
<span class="sd">            names if `ret_full_name=True`) and values are their output</span>
<span class="sd">            configurations. Note that even if the *elements* contained</span>
<span class="sd">            controllers, the returned configuration will always contain</span>
<span class="sd">            only channels.</span>
<span class="sd">        :rtype: dict(str, int)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">channels</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_channels_for_elements</span><span class="p">(</span><span class="n">elements</span><span class="p">)</span>
        <span class="n">config</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getConfiguration</span><span class="p">()</span>
        <span class="c1"># TODO Change the documentation when _getPlotTypeChannels return enum</span>
        <span class="c1">#  value</span>
        <span class="k">return</span> <span class="n">config</span><span class="o">.</span><span class="n">_getPlotTypeChannels</span><span class="p">(</span><span class="n">channels</span><span class="p">,</span>
                                           <span class="n">use_fullname</span><span class="o">=</span><span class="n">ret_full_name</span><span class="p">)</span></div>

<div class="viewcode-block" id="MeasurementGroup.setPlotAxes"><a class="viewcode-back" href="../../../../../../devel/api/sardana/taurus/core/tango/sardana/pool.html#sardana.taurus.core.tango.sardana.pool.MeasurementGroup.setPlotAxes">[docs]</a>    <span class="k">def</span> <span class="nf">setPlotAxes</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">plot_axes</span><span class="p">,</span> <span class="o">*</span><span class="n">elements</span><span class="p">,</span> <span class="n">apply</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set the enabled configuration for the given elements.</span>

<span class="sd">        Channels and controllers are accepted as elements. Setting the plot</span>
<span class="sd">        axes on the controller means setting it to all channels of this</span>
<span class="sd">        controller present in this measurement group.</span>

<span class="sd">        :param plot_axes: [&#39;&lt;mov&gt;&#39;] / [&#39;&lt;mov&gt;&#39;, &#39;&lt;idx&gt;&#39;]</span>
<span class="sd">        :type plot_axes: list(str)</span>
<span class="sd">        :param elements: sequence of element names or full names, no elements</span>
<span class="sd">            means set to all</span>
<span class="sd">        :type elements: list(str)</span>
<span class="sd">        :param apply: `True` - apply on the server, `False` - do not apply yet</span>
<span class="sd">            on the server and keep locally (default: `True`)</span>
<span class="sd">        :type apply: bool</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">channels</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_channels_for_elements</span><span class="p">(</span><span class="n">elements</span><span class="p">)</span>
        <span class="n">config</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getConfiguration</span><span class="p">()</span>
        <span class="n">config</span><span class="o">.</span><span class="n">_setPlotAxesChannels</span><span class="p">(</span><span class="n">plot_axes</span><span class="p">,</span> <span class="n">channels</span><span class="p">,</span> <span class="n">apply_cfg</span><span class="o">=</span><span class="n">apply</span><span class="p">)</span></div>

<div class="viewcode-block" id="MeasurementGroup.getPlotAxes"><a class="viewcode-back" href="../../../../../../devel/api/sardana/taurus/core/tango/sardana/pool.html#sardana.taurus.core.tango.sardana.pool.MeasurementGroup.getPlotAxes">[docs]</a>    <span class="k">def</span> <span class="nf">getPlotAxes</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">elements</span><span class="p">,</span> <span class="n">ret_full_name</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get the output configuration of the given elements.</span>

<span class="sd">        Channels and controllers are accepted as elements. Getting the plot</span>
<span class="sd">        axes from the controller means getting it from all channels of this</span>
<span class="sd">        controller present in this measurement group.</span>

<span class="sd">        :param elements: sequence of element names or full names, no elements</span>
<span class="sd">            means get from all</span>
<span class="sd">        :type elements: list(str)</span>
<span class="sd">        :param ret_full_name: whether keys in the returned dictionary are</span>
<span class="sd">            full names or names (default: `False` means return names)</span>
<span class="sd">        :type ret_full_name: bool</span>
<span class="sd">        :return: ordered dictionary where keys are **channel** names (or full</span>
<span class="sd">            names if `ret_full_name=True`) and values are their output</span>
<span class="sd">            configurations. Note that even if the *elements* contained</span>
<span class="sd">            controllers, the returned configuration will always contain</span>
<span class="sd">            only channels.</span>
<span class="sd">        :rtype: dict(str, str)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">channels</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_channels_for_elements</span><span class="p">(</span><span class="n">elements</span><span class="p">)</span>
        <span class="n">config</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getConfiguration</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">config</span><span class="o">.</span><span class="n">_getPlotAxesChannels</span><span class="p">(</span><span class="n">channels</span><span class="p">,</span>
                                           <span class="n">use_fullname</span><span class="o">=</span><span class="n">ret_full_name</span><span class="p">)</span></div>

<div class="viewcode-block" id="MeasurementGroup.setValueRefEnabled"><a class="viewcode-back" href="../../../../../../devel/api/sardana/taurus/core/tango/sardana/pool.html#sardana.taurus.core.tango.sardana.pool.MeasurementGroup.setValueRefEnabled">[docs]</a>    <span class="k">def</span> <span class="nf">setValueRefEnabled</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value_ref_enabled</span><span class="p">,</span> <span class="o">*</span><span class="n">elements</span><span class="p">,</span> <span class="n">apply</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set the output configuration for the given elements.</span>

<span class="sd">        Channels and controllers are accepted as elements. Setting the value</span>
<span class="sd">        reference enabled on the controller means setting it to all channels</span>
<span class="sd">        of this controller present in this measurement group.</span>

<span class="sd">        :param value_ref_enabled: `True` - enabled, `False` - disabled</span>
<span class="sd">        :type value_ref_enabled: bool</span>
<span class="sd">        :param elements: sequence of element names or full names, no elements</span>
<span class="sd">            means set to all</span>
<span class="sd">        :type elements: list(str)</span>
<span class="sd">        :param apply: `True` - apply on the server, `False` - do not apply yet</span>
<span class="sd">            on the server and keep locally (default: `True`)</span>
<span class="sd">        :type apply: bool</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">channels</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_channels_for_elements</span><span class="p">(</span><span class="n">elements</span><span class="p">)</span>
        <span class="n">config</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getConfiguration</span><span class="p">()</span>
        <span class="n">config</span><span class="o">.</span><span class="n">_setValueRefEnabledChannels</span><span class="p">(</span><span class="n">value_ref_enabled</span><span class="p">,</span> <span class="n">channels</span><span class="p">,</span>
                                           <span class="n">apply_cfg</span><span class="o">=</span><span class="n">apply</span><span class="p">)</span></div>

<div class="viewcode-block" id="MeasurementGroup.getValueRefEnabled"><a class="viewcode-back" href="../../../../../../devel/api/sardana/taurus/core/tango/sardana/pool.html#sardana.taurus.core.tango.sardana.pool.MeasurementGroup.getValueRefEnabled">[docs]</a>    <span class="k">def</span> <span class="nf">getValueRefEnabled</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">elements</span><span class="p">,</span> <span class="n">ret_full_name</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get the value reference enabled configuration of the given elements.</span>

<span class="sd">        Channels and controllers are accepted as elements. Getting the value</span>
<span class="sd">        from the controller means getting it from all channels of this</span>
<span class="sd">        controller present in this measurement group.</span>

<span class="sd">        :param elements: sequence of element names or full names, no elements</span>
<span class="sd">            means get from all</span>
<span class="sd">        :type elements: list(str)</span>
<span class="sd">        :param ret_full_name: whether keys in the returned dictionary are</span>
<span class="sd">            full names or names (default: `False` means return names)</span>
<span class="sd">        :type ret_full_name: bool</span>
<span class="sd">        :return: ordered dictionary where keys are **channel** names (or full</span>
<span class="sd">            names if `ret_full_name=True`) and values are their output</span>
<span class="sd">            configurations. Note that even if the *elements* contained</span>
<span class="sd">            controllers, the returned configuration will always contain</span>
<span class="sd">            only channels.</span>
<span class="sd">        :rtype: dict(str, bool)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">channels</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_channels_for_elements</span><span class="p">(</span><span class="n">elements</span><span class="p">)</span>
        <span class="n">config</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getConfiguration</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">config</span><span class="o">.</span><span class="n">_getValueRefEnabledChannels</span><span class="p">(</span><span class="n">channels</span><span class="p">,</span>
                                                  <span class="n">use_fullname</span><span class="o">=</span><span class="n">ret_full_name</span><span class="p">)</span></div>

<div class="viewcode-block" id="MeasurementGroup.setValueRefPattern"><a class="viewcode-back" href="../../../../../../devel/api/sardana/taurus/core/tango/sardana/pool.html#sardana.taurus.core.tango.sardana.pool.MeasurementGroup.setValueRefPattern">[docs]</a>    <span class="k">def</span> <span class="nf">setValueRefPattern</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value_ref_pattern</span><span class="p">,</span> <span class="o">*</span><span class="n">elements</span><span class="p">,</span> <span class="n">apply</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set the output configuration for the given elements.</span>

<span class="sd">        Channels and controllers are accepted as elements. Setting the value</span>
<span class="sd">        reference pattern on the controller means setting it to all channels</span>
<span class="sd">        of this controller present in this measurement group.</span>

<span class="sd">        :param value_ref_pattern: `/path/file{index:03d}.txt`</span>
<span class="sd">        :type value_ref_pattern: :py:obj:`str`</span>
<span class="sd">        :param elements: sequence of element names or full names, no elements</span>
<span class="sd">            means set to all</span>
<span class="sd">        :type elements: list(str)</span>
<span class="sd">        :param apply: `True` - apply on the server, `False` - do not apply yet</span>
<span class="sd">            on the server and keep locally (default: `True`)</span>
<span class="sd">        :type apply: bool</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">channels</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_channels_for_elements</span><span class="p">(</span><span class="n">elements</span><span class="p">)</span>
        <span class="n">config</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getConfiguration</span><span class="p">()</span>
        <span class="n">config</span><span class="o">.</span><span class="n">_setValueRefPatternChannels</span><span class="p">(</span><span class="n">value_ref_pattern</span><span class="p">,</span> <span class="n">channels</span><span class="p">,</span>
                                           <span class="n">apply_cfg</span><span class="o">=</span><span class="n">apply</span><span class="p">)</span></div>

<div class="viewcode-block" id="MeasurementGroup.getValueRefPattern"><a class="viewcode-back" href="../../../../../../devel/api/sardana/taurus/core/tango/sardana/pool.html#sardana.taurus.core.tango.sardana.pool.MeasurementGroup.getValueRefPattern">[docs]</a>    <span class="k">def</span> <span class="nf">getValueRefPattern</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">elements</span><span class="p">,</span> <span class="n">ret_full_name</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get the value reference enabled configuration of the given elements.</span>

<span class="sd">        Channels and controllers are accepted as elements. Getting the value</span>
<span class="sd">        from the controller means getting it from all channels of this</span>
<span class="sd">        controller present in this measurement group.</span>

<span class="sd">        :param elements: sequence of element names or full names, no elements</span>
<span class="sd">            means get from all</span>
<span class="sd">        :type elements: list(str)</span>
<span class="sd">        :param ret_full_name: whether keys in the returned dictionary are</span>
<span class="sd">            full names or names (default: `False` means return names)</span>
<span class="sd">        :type ret_full_name: bool</span>
<span class="sd">        :return: ordered dictionary where keys are **channel** names (or full</span>
<span class="sd">            names if `ret_full_name=True`) and values are their output</span>
<span class="sd">            configurations. Note that even if the *elements* contained</span>
<span class="sd">            controllers, the returned configuration will always contain</span>
<span class="sd">            only channels.</span>
<span class="sd">        :rtype: dict(str, str)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">channels</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_channels_for_elements</span><span class="p">(</span><span class="n">elements</span><span class="p">)</span>
        <span class="n">config</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getConfiguration</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">config</span><span class="o">.</span><span class="n">_getValueRefPatternChannels</span><span class="p">(</span><span class="n">channels</span><span class="p">,</span>
                                                  <span class="n">use_fullname</span><span class="o">=</span><span class="n">ret_full_name</span><span class="p">)</span></div>

    <span class="k">def</span> <span class="nf">_get_value_per_channel</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">config</span><span class="p">,</span> <span class="n">ctrls_values</span><span class="p">,</span> <span class="n">use_fullname</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="n">channels_values</span> <span class="o">=</span> <span class="n">collections</span><span class="o">.</span><span class="n">OrderedDict</span><span class="p">({})</span>
        <span class="k">for</span> <span class="n">ctrl</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">ctrls_values</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">for</span> <span class="n">channel</span> <span class="ow">in</span> <span class="n">config</span><span class="o">.</span><span class="n">_get_ctrl_channels</span><span class="p">(</span><span class="n">ctrl</span><span class="p">,</span> <span class="n">use_fullname</span><span class="p">):</span>
                <span class="n">channels_values</span><span class="p">[</span><span class="n">channel</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
        <span class="k">return</span> <span class="n">channels_values</span>

<div class="viewcode-block" id="MeasurementGroup.setTimer"><a class="viewcode-back" href="../../../../../../devel/api/sardana/taurus/core/tango/sardana/pool.html#sardana.taurus.core.tango.sardana.pool.MeasurementGroup.setTimer">[docs]</a>    <span class="k">def</span> <span class="nf">setTimer</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">timer</span><span class="p">,</span> <span class="o">*</span><span class="n">elements</span><span class="p">,</span> <span class="n">apply</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set the timer configuration for the given channels of the same</span>
<span class="sd">        controller.</span>

<span class="sd">        .. note:: Currently the controller&#39;s timer must be unique. Hence this</span>
<span class="sd">           method will set it for the whole controller regardless of the</span>
<span class="sd">           ``elements`` argument.</span>

<span class="sd">        :param timer: channel use as timer</span>
<span class="sd">        :type timer: :py:obj:`str`</span>
<span class="sd">        :param elements: sequence of channels names or full names, no elements</span>
<span class="sd">            means set to all</span>
<span class="sd">        :type elements: list(str)</span>
<span class="sd">        :param apply: `True` - apply on the server, `False` - do not apply yet</span>
<span class="sd">            on the server and keep locally (default: `True`)</span>
<span class="sd">        :type apply: bool</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">config</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getConfiguration</span><span class="p">()</span>
        <span class="c1"># TODO: Implement solution to set the timer per channel when it is</span>
        <span class="c1">#  allowed.</span>
        <span class="n">config</span><span class="o">.</span><span class="n">_setCtrlsTimer</span><span class="p">([</span><span class="n">timer</span><span class="p">],</span> <span class="n">apply_cfg</span><span class="o">=</span><span class="n">apply</span><span class="p">)</span></div>

<div class="viewcode-block" id="MeasurementGroup.getTimer"><a class="viewcode-back" href="../../../../../../devel/api/sardana/taurus/core/tango/sardana/pool.html#sardana.taurus.core.tango.sardana.pool.MeasurementGroup.getTimer">[docs]</a>    <span class="k">def</span> <span class="nf">getTimer</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">elements</span><span class="p">,</span> <span class="n">ret_full_name</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">ret_by_ctrl</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get the timer configuration of the given elements.</span>

<span class="sd">        Channels and controllers are accepted as elements. Getting the output</span>
<span class="sd">        from the controller means getting it from all channels of this</span>
<span class="sd">        controller present in this measurement group, unless</span>
<span class="sd">        `ret_by_ctrl=True`.</span>

<span class="sd">        :param elements: sequence of element names or full names, no elements</span>
<span class="sd">            means get from all</span>
<span class="sd">        :type elements: list(str)</span>
<span class="sd">        :param ret_full_name: whether keys in the returned dictionary are</span>
<span class="sd">            full names or names (default: `False` means return names)</span>
<span class="sd">        :type ret_full_name: bool</span>
<span class="sd">        :param ret_by_ctrl: whether keys in the returned dictionary are</span>
<span class="sd">            controllers or channels (default: `False` means return channels)</span>
<span class="sd">        :type ret_by_ctrl: bool</span>
<span class="sd">        :return: ordered dictionary where keys are **channel** names (or full</span>
<span class="sd">            names if `ret_full_name=True`) and values are their timer</span>
<span class="sd">            configurations</span>
<span class="sd">        :rtype: dict(str, str)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># TODO: Implement solution to set the timer per channel when it is</span>
        <span class="c1">#  allowed.</span>
        <span class="n">ctrls</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_ctrl_for_elements</span><span class="p">(</span><span class="n">elements</span><span class="p">)</span>
        <span class="n">config</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getConfiguration</span><span class="p">()</span>
        <span class="n">ctrls_timers</span> <span class="o">=</span> <span class="n">config</span><span class="o">.</span><span class="n">_getCtrlsTimer</span><span class="p">(</span><span class="n">ctrls</span><span class="p">,</span> <span class="n">use_fullname</span><span class="o">=</span><span class="n">ret_full_name</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">ret_by_ctrl</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">ctrls_timers</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_value_per_channel</span><span class="p">(</span><span class="n">config</span><span class="p">,</span> <span class="n">ctrls_timers</span><span class="p">,</span>
                                               <span class="n">use_fullname</span><span class="o">=</span><span class="n">ret_full_name</span><span class="p">)</span></div>

<div class="viewcode-block" id="MeasurementGroup.setMonitor"><a class="viewcode-back" href="../../../../../../devel/api/sardana/taurus/core/tango/sardana/pool.html#sardana.taurus.core.tango.sardana.pool.MeasurementGroup.setMonitor">[docs]</a>    <span class="k">def</span> <span class="nf">setMonitor</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">monitor</span><span class="p">,</span> <span class="o">*</span><span class="n">elements</span><span class="p">,</span> <span class="n">apply</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set the monitor configuration for the given channels of the same</span>
<span class="sd">        controller.</span>

<span class="sd">        .. note:: Currently the controller&#39;s monitor must be unique.</span>
<span class="sd">           Hence this method will set it for the whole controller regardless of</span>
<span class="sd">           the ``elements`` argument.</span>

<span class="sd">        :param monitor: channel use as monitor</span>
<span class="sd">        :type monitor: :py:obj:`str`</span>
<span class="sd">        :param elements: sequence of channels names or full names, no elements</span>
<span class="sd">            means set to all</span>
<span class="sd">        :type elements: list(str)</span>
<span class="sd">        :param apply: `True` - apply on the server, `False` - do not apply yet</span>
<span class="sd">            on the server and keep locally (default: `True`)</span>
<span class="sd">        :type apply: bool</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">config</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getConfiguration</span><span class="p">()</span>
        <span class="c1"># TODO: Implement solution to set the moniotor per channel when it is</span>
        <span class="c1">#  allowed.</span>
        <span class="n">config</span><span class="o">.</span><span class="n">_setCtrlsMonitor</span><span class="p">([</span><span class="n">monitor</span><span class="p">],</span> <span class="n">apply_cfg</span><span class="o">=</span><span class="n">apply</span><span class="p">)</span></div>

<div class="viewcode-block" id="MeasurementGroup.getMonitor"><a class="viewcode-back" href="../../../../../../devel/api/sardana/taurus/core/tango/sardana/pool.html#sardana.taurus.core.tango.sardana.pool.MeasurementGroup.getMonitor">[docs]</a>    <span class="k">def</span> <span class="nf">getMonitor</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">elements</span><span class="p">,</span> <span class="n">ret_full_name</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">ret_by_ctrl</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get the monitor configuration of the given elements.</span>

<span class="sd">        Channels and controllers are accepted as elements. Getting the output</span>
<span class="sd">        from the controller means getting it from all channels of this</span>
<span class="sd">        controller present in this measurement group, unless</span>
<span class="sd">        `ret_by_ctrl=True`.</span>

<span class="sd">        :param elements: sequence of element names or full names, no elements</span>
<span class="sd">            means get from all</span>
<span class="sd">        :type elements: list(str)</span>
<span class="sd">        :param ret_full_name: whether keys in the returned dictionary are</span>
<span class="sd">            full names or names (default: `False` means return names)</span>
<span class="sd">        :type ret_full_name: bool</span>
<span class="sd">        :param ret_by_ctrl: whether keys in the returned dictionary are</span>
<span class="sd">            controllers or channels (default: `False` means return channels)</span>
<span class="sd">        :type ret_by_ctrl: bool</span>
<span class="sd">        :return: ordered dictionary where keys are **channel** names (or full</span>
<span class="sd">            names if `ret_full_name=True`) and values are their monitor</span>
<span class="sd">            configurations</span>
<span class="sd">        :rtype: dict(str, str)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># TODO: Implement solution to set the timer per channel when it is</span>
        <span class="c1">#  allowed.</span>
        <span class="n">ctrls</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_ctrl_for_elements</span><span class="p">(</span><span class="n">elements</span><span class="p">)</span>
        <span class="n">config</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getConfiguration</span><span class="p">()</span>
        <span class="n">ctrls_monitor</span> <span class="o">=</span> <span class="n">config</span><span class="o">.</span><span class="n">_getCtrlsMonitor</span><span class="p">(</span><span class="n">ctrls</span><span class="p">,</span>
                                                <span class="n">use_fullname</span><span class="o">=</span><span class="n">ret_full_name</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">ret_by_ctrl</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">ctrls_monitor</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_value_per_channel</span><span class="p">(</span><span class="n">config</span><span class="p">,</span> <span class="n">ctrls_monitor</span><span class="p">,</span>
                                               <span class="n">use_fullname</span><span class="o">=</span><span class="n">ret_full_name</span><span class="p">)</span></div>

<div class="viewcode-block" id="MeasurementGroup.setSynchronizer"><a class="viewcode-back" href="../../../../../../devel/api/sardana/taurus/core/tango/sardana/pool.html#sardana.taurus.core.tango.sardana.pool.MeasurementGroup.setSynchronizer">[docs]</a>    <span class="k">def</span> <span class="nf">setSynchronizer</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">synchronizer</span><span class="p">,</span> <span class="o">*</span><span class="n">elements</span><span class="p">,</span> <span class="n">apply</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set the synchronizer configuration for the given channels or</span>
<span class="sd">        controller.</span>

<span class="sd">        .. note:: Currently the controller&#39;s synchronizer must be unique.</span>
<span class="sd">           Hence this method will set it for the whole controller regardless of</span>
<span class="sd">           the ``elements`` argument.</span>

<span class="sd">        :param synchronizer: triger/gate element name or software</span>
<span class="sd">        :type synchronizer: :py:obj:`str`</span>
<span class="sd">        :param elements: sequence of channels names or full names, no elements</span>
<span class="sd">            means set to all</span>
<span class="sd">        :type elements: list(str)</span>
<span class="sd">        :param apply: `True` - apply on the server, `False` - do not apply yet</span>
<span class="sd">            on the server and keep locally (default: `True`)</span>
<span class="sd">        :type apply: bool</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">config</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getConfiguration</span><span class="p">()</span>
        <span class="c1"># TODO: Implement solution to set the timer per channel when it is</span>
        <span class="c1">#  allowed.</span>
        <span class="n">ctrls</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_ctrl_for_elements</span><span class="p">(</span><span class="n">elements</span><span class="p">)</span>
        <span class="n">config</span><span class="o">.</span><span class="n">_setCtrlsSynchronizer</span><span class="p">(</span><span class="n">synchronizer</span><span class="p">,</span> <span class="n">ctrls</span><span class="p">,</span> <span class="n">apply_cfg</span><span class="o">=</span><span class="n">apply</span><span class="p">)</span></div>

<div class="viewcode-block" id="MeasurementGroup.getSynchronizer"><a class="viewcode-back" href="../../../../../../devel/api/sardana/taurus/core/tango/sardana/pool.html#sardana.taurus.core.tango.sardana.pool.MeasurementGroup.getSynchronizer">[docs]</a>    <span class="k">def</span> <span class="nf">getSynchronizer</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">elements</span><span class="p">,</span> <span class="n">ret_full_name</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                        <span class="n">ret_by_ctrl</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get the synchronizer configuration of the given elements.</span>

<span class="sd">        Channels and controllers are accepted as elements. Getting the output</span>
<span class="sd">        from the controller means getting it from all channels of this</span>
<span class="sd">        controller present in this measurement group, unless</span>
<span class="sd">        `ret_by_ctrl=True`.</span>

<span class="sd">        :param elements: sequence of element names or full names, no elements</span>
<span class="sd">            means get from all</span>
<span class="sd">        :type elements: list(str)</span>
<span class="sd">        :param ret_full_name: whether keys in the returned dictionary are</span>
<span class="sd">            full names or names (default: `False` means return names)</span>
<span class="sd">        :type ret_full_name: bool</span>
<span class="sd">        :param ret_by_ctrl: whether keys in the returned dictionary are</span>
<span class="sd">            controllers or channels (default: `False` means return channels)</span>
<span class="sd">        :type ret_by_ctrl: bool</span>
<span class="sd">        :return: ordered dictionary where keys are **channel** names (or full</span>
<span class="sd">            names if `ret_full_name=True`) and values are their synchronizer</span>
<span class="sd">            configurations</span>
<span class="sd">        :rtype: dict(str, str)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># TODO: Implement solution to set the synchronizer per channel when it</span>
        <span class="c1">#  is allowed.</span>
        <span class="n">ctrls</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_ctrl_for_elements</span><span class="p">(</span><span class="n">elements</span><span class="p">)</span>
        <span class="n">config</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getConfiguration</span><span class="p">()</span>
        <span class="n">ctrls_sync</span> <span class="o">=</span> <span class="n">config</span><span class="o">.</span><span class="n">_getCtrlsSynchronizer</span><span class="p">(</span><span class="n">ctrls</span><span class="p">,</span>
                                                  <span class="n">use_fullname</span><span class="o">=</span><span class="n">ret_full_name</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">ret_by_ctrl</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">ctrls_sync</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_value_per_channel</span><span class="p">(</span><span class="n">config</span><span class="p">,</span> <span class="n">ctrls_sync</span><span class="p">,</span>
                                               <span class="n">use_fullname</span><span class="o">=</span><span class="n">ret_full_name</span><span class="p">)</span></div>

<div class="viewcode-block" id="MeasurementGroup.setSynchronization"><a class="viewcode-back" href="../../../../../../devel/api/sardana/taurus/core/tango/sardana/pool.html#sardana.taurus.core.tango.sardana.pool.MeasurementGroup.setSynchronization">[docs]</a>    <span class="k">def</span> <span class="nf">setSynchronization</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">synchronization</span><span class="p">,</span> <span class="o">*</span><span class="n">elements</span><span class="p">,</span> <span class="n">apply</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set the synchronization configuration for the given channels or</span>
<span class="sd">        controller.</span>

<span class="sd">        .. note:: Currently the controller&#39;s synchronization must be unique.</span>
<span class="sd">           Hence this method will set it for the whole controller regardless of</span>
<span class="sd">           the ``elements`` argument.</span>

<span class="sd">        :param synchronization: synchronization type e.g. Trigger, Gate or</span>
<span class="sd">          Start</span>
<span class="sd">        :type synchronization: `sardana.pool.AcqSynchType`</span>
<span class="sd">        :param elements: sequence of channels names or full names, no elements</span>
<span class="sd">            means set to all</span>
<span class="sd">        :type elements: list(str)</span>
<span class="sd">        :param apply: `True` - apply on the server, `False` - do not apply yet</span>
<span class="sd">            on the server and keep locally (default: `True`)</span>
<span class="sd">        :type apply: bool</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">config</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getConfiguration</span><span class="p">()</span>
        <span class="c1"># TODO: Implement solution to set the synchronization per channel when</span>
        <span class="c1">#  it is allowed.</span>
        <span class="n">ctrls</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_ctrl_for_elements</span><span class="p">(</span><span class="n">elements</span><span class="p">)</span>
        <span class="n">config</span><span class="o">.</span><span class="n">_setCtrlsSynchronization</span><span class="p">(</span><span class="n">synchronization</span><span class="p">,</span> <span class="n">ctrls</span><span class="p">,</span>
                                        <span class="n">apply_cfg</span><span class="o">=</span><span class="n">apply</span><span class="p">)</span></div>

<div class="viewcode-block" id="MeasurementGroup.getSynchronization"><a class="viewcode-back" href="../../../../../../devel/api/sardana/taurus/core/tango/sardana/pool.html#sardana.taurus.core.tango.sardana.pool.MeasurementGroup.getSynchronization">[docs]</a>    <span class="k">def</span> <span class="nf">getSynchronization</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">elements</span><span class="p">,</span> <span class="n">ret_full_name</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                           <span class="n">ret_by_ctrl</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get the synchronization configuration of the given elements.</span>

<span class="sd">        Channels and controllers are accepted as elements. Getting the output</span>
<span class="sd">        from the controller means getting it from all channels of this</span>
<span class="sd">        controller present in this measurement group, unless</span>
<span class="sd">        `ret_by_ctrl=True`.</span>

<span class="sd">        :param elements: sequence of element names or full names, no elements</span>
<span class="sd">            means get from all</span>
<span class="sd">        :type elements: list(str)</span>
<span class="sd">        :param ret_full_name: whether keys in the returned dictionary are</span>
<span class="sd">            full names or names (default: `False` means return names)</span>
<span class="sd">        :type ret_full_name: bool</span>
<span class="sd">        :param ret_by_ctrl: whether keys in the returned dictionary are</span>
<span class="sd">            controllers or channels (default: `False` means return channels)</span>
<span class="sd">        :type ret_by_ctrl: bool</span>
<span class="sd">        :return: ordered dictionary where keys are **channel** names (or full</span>
<span class="sd">            names if `ret_full_name=True`) and values are their</span>
<span class="sd">            synchronization configurations</span>
<span class="sd">        :rtype: dict&lt;`str`, `sardana.pool.AcqSynchType`&gt;</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># TODO: Implement solution to set the synchronization per channel</span>
        <span class="c1">#  when it is allowed.</span>
        <span class="n">ctrls</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_ctrl_for_elements</span><span class="p">(</span><span class="n">elements</span><span class="p">)</span>
        <span class="n">config</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getConfiguration</span><span class="p">()</span>
        <span class="n">ctrls_sync</span> <span class="o">=</span> \
            <span class="n">config</span><span class="o">.</span><span class="n">_getCtrlsSynchronization</span><span class="p">(</span><span class="n">ctrls</span><span class="p">,</span> <span class="n">use_fullname</span><span class="o">=</span><span class="n">ret_full_name</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">ret_by_ctrl</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">ctrls_sync</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_value_per_channel</span><span class="p">(</span><span class="n">config</span><span class="p">,</span> <span class="n">ctrls_sync</span><span class="p">,</span>
                                               <span class="n">use_fullname</span><span class="o">=</span><span class="n">ret_full_name</span><span class="p">)</span></div>

<div class="viewcode-block" id="MeasurementGroup.applyConfiguration"><a class="viewcode-back" href="../../../../../../devel/api/sardana/taurus/core/tango/sardana/pool.html#sardana.taurus.core.tango.sardana.pool.MeasurementGroup.applyConfiguration">[docs]</a>    <span class="k">def</span> <span class="nf">applyConfiguration</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Apply configuration changes kept locally on the server.</span>

<span class="sd">        Setting configuration parameters using e.g.,</span>
<span class="sd">        `~sardana.taurus.core.tango.sardana.pool.MeasurementGroup.setEnabled`</span>
<span class="sd">        or</span>
<span class="sd">        `~sardana.taurus.core.tango.sardana.pool.MeasurementGroup.setTimer`,</span>
<span class="sd">        etc.</span>
<span class="sd">        with ``apply=False`` keeps the changes locally. Use this method to</span>
<span class="sd">        apply them on the server afterwards.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">getConfiguration</span><span class="p">()</span><span class="o">.</span><span class="n">applyConfiguration</span><span class="p">()</span></div>

    <span class="c1">#########################################################################</span>
    <span class="c1"># TODO: review the following API</span>

<div class="viewcode-block" id="MeasurementGroup.getChannelsEnabledInfo"><a class="viewcode-back" href="../../../../../../devel/api/sardana/taurus/core/tango/sardana/pool.html#sardana.taurus.core.tango.sardana.pool.MeasurementGroup.getChannelsEnabledInfo">[docs]</a>    <span class="k">def</span> <span class="nf">getChannelsEnabledInfo</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns information about **only enabled** channels present in the</span>
<span class="sd">        measurement group in a form of ordered, based on the channel index,</span>
<span class="sd">        list.</span>
<span class="sd">        :return: list with channels info</span>
<span class="sd">        :rtype: list&lt;TangoChannelInfo&gt;</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">getConfiguration</span><span class="p">()</span><span class="o">.</span><span class="n">getChannelsInfoList</span><span class="p">(</span><span class="n">only_enabled</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></div>

<div class="viewcode-block" id="MeasurementGroup.getCountersInfo"><a class="viewcode-back" href="../../../../../../devel/api/sardana/taurus/core/tango/sardana/pool.html#sardana.taurus.core.tango.sardana.pool.MeasurementGroup.getCountersInfo">[docs]</a>    <span class="k">def</span> <span class="nf">getCountersInfo</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">getConfiguration</span><span class="p">()</span><span class="o">.</span><span class="n">getCountersInfoList</span><span class="p">()</span></div>

<div class="viewcode-block" id="MeasurementGroup.getValues"><a class="viewcode-back" href="../../../../../../devel/api/sardana/taurus/core/tango/sardana/pool.html#sardana.taurus.core.tango.sardana.pool.MeasurementGroup.getValues">[docs]</a>    <span class="k">def</span> <span class="nf">getValues</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parallel</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">getConfiguration</span><span class="p">()</span><span class="o">.</span><span class="n">getValues</span><span class="p">(</span><span class="n">parallel</span><span class="p">)</span></div>

<div class="viewcode-block" id="MeasurementGroup.getChannels"><a class="viewcode-back" href="../../../../../../devel/api/sardana/taurus/core/tango/sardana/pool.html#sardana.taurus.core.tango.sardana.pool.MeasurementGroup.getChannels">[docs]</a>    <span class="k">def</span> <span class="nf">getChannels</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">getConfiguration</span><span class="p">()</span><span class="o">.</span><span class="n">getChannels</span><span class="p">()</span></div>

<div class="viewcode-block" id="MeasurementGroup.getCounters"><a class="viewcode-back" href="../../../../../../devel/api/sardana/taurus/core/tango/sardana/pool.html#sardana.taurus.core.tango.sardana.pool.MeasurementGroup.getCounters">[docs]</a>    <span class="k">def</span> <span class="nf">getCounters</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">getConfiguration</span><span class="p">()</span><span class="o">.</span><span class="n">_getCounters</span><span class="p">()</span></div>

<div class="viewcode-block" id="MeasurementGroup.getChannelNames"><a class="viewcode-back" href="../../../../../../devel/api/sardana/taurus/core/tango/sardana/pool.html#sardana.taurus.core.tango.sardana.pool.MeasurementGroup.getChannelNames">[docs]</a>    <span class="k">def</span> <span class="nf">getChannelNames</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">getConfiguration</span><span class="p">()</span><span class="o">.</span><span class="n">_getChannelNames</span><span class="p">()</span></div>

<div class="viewcode-block" id="MeasurementGroup.getCounterNames"><a class="viewcode-back" href="../../../../../../devel/api/sardana/taurus/core/tango/sardana/pool.html#sardana.taurus.core.tango.sardana.pool.MeasurementGroup.getCounterNames">[docs]</a>    <span class="k">def</span> <span class="nf">getCounterNames</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">getConfiguration</span><span class="p">()</span><span class="o">.</span><span class="n">_getCounterNames</span><span class="p">()</span></div>

<div class="viewcode-block" id="MeasurementGroup.getChannelLabels"><a class="viewcode-back" href="../../../../../../devel/api/sardana/taurus/core/tango/sardana/pool.html#sardana.taurus.core.tango.sardana.pool.MeasurementGroup.getChannelLabels">[docs]</a>    <span class="k">def</span> <span class="nf">getChannelLabels</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">getConfiguration</span><span class="p">()</span><span class="o">.</span><span class="n">_getChannelLabels</span><span class="p">()</span></div>

<div class="viewcode-block" id="MeasurementGroup.getCounterLabels"><a class="viewcode-back" href="../../../../../../devel/api/sardana/taurus/core/tango/sardana/pool.html#sardana.taurus.core.tango.sardana.pool.MeasurementGroup.getCounterLabels">[docs]</a>    <span class="k">def</span> <span class="nf">getCounterLabels</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">getConfiguration</span><span class="p">()</span><span class="o">.</span><span class="n">_getCounterLabels</span><span class="p">()</span></div>

<div class="viewcode-block" id="MeasurementGroup.getChannel"><a class="viewcode-back" href="../../../../../../devel/api/sardana/taurus/core/tango/sardana/pool.html#sardana.taurus.core.tango.sardana.pool.MeasurementGroup.getChannel">[docs]</a>    <span class="k">def</span> <span class="nf">getChannel</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">getConfiguration</span><span class="p">()</span><span class="o">.</span><span class="n">_getChannel</span><span class="p">(</span><span class="n">name</span><span class="p">)</span></div>

<div class="viewcode-block" id="MeasurementGroup.getChannelInfo"><a class="viewcode-back" href="../../../../../../devel/api/sardana/taurus/core/tango/sardana/pool.html#sardana.taurus.core.tango.sardana.pool.MeasurementGroup.getChannelInfo">[docs]</a>    <span class="k">def</span> <span class="nf">getChannelInfo</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">getConfiguration</span><span class="p">()</span><span class="o">.</span><span class="n">getChannelInfo</span><span class="p">(</span><span class="n">name</span><span class="p">)</span></div>

    <span class="c1">#########################################################################</span>

<div class="viewcode-block" id="MeasurementGroup.getChannelsInfo"><a class="viewcode-back" href="../../../../../../devel/api/sardana/taurus/core/tango/sardana/pool.html#sardana.taurus.core.tango.sardana.pool.MeasurementGroup.getChannelsInfo">[docs]</a>    <span class="k">def</span> <span class="nf">getChannelsInfo</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;DEPRECATED&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s1">&#39;Deprecation warning: you should use &#39;</span>
                     <span class="s1">&#39;&quot;getChannelsInfoList&quot; instead of &quot;getChannelsInfo&quot;&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">getConfiguration</span><span class="p">()</span><span class="o">.</span><span class="n">getChannelsInfoList</span><span class="p">()</span></div>

<div class="viewcode-block" id="MeasurementGroup.getMonitorName"><a class="viewcode-back" href="../../../../../../devel/api/sardana/taurus/core/tango/sardana/pool.html#sardana.taurus.core.tango.sardana.pool.MeasurementGroup.getMonitorName">[docs]</a>    <span class="k">def</span> <span class="nf">getMonitorName</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;DEPRECATED&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;getMonitorName() is deprecated since Jul20. &quot;</span>
                     <span class="s2">&quot;Global measurement group monitor does not exist.&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">getConfiguration</span><span class="p">()</span><span class="o">.</span><span class="n">_getMonitorName</span><span class="p">()</span></div>

<div class="viewcode-block" id="MeasurementGroup.getTimerName"><a class="viewcode-back" href="../../../../../../devel/api/sardana/taurus/core/tango/sardana/pool.html#sardana.taurus.core.tango.sardana.pool.MeasurementGroup.getTimerName">[docs]</a>    <span class="k">def</span> <span class="nf">getTimerName</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;DEPRECATED&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;getTimerName() is deprecated since Jul20. &quot;</span>
                     <span class="s2">&quot;Global measurement group timer does not exist.&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">getConfiguration</span><span class="p">()</span><span class="o">.</span><span class="n">_getTimerName</span><span class="p">()</span></div>

<div class="viewcode-block" id="MeasurementGroup.getTimerValue"><a class="viewcode-back" href="../../../../../../devel/api/sardana/taurus/core/tango/sardana/pool.html#sardana.taurus.core.tango.sardana.pool.MeasurementGroup.getTimerValue">[docs]</a>    <span class="k">def</span> <span class="nf">getTimerValue</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;DEPRECATED&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;getTimerValue() is deprecated since Jul20. &quot;</span>
                     <span class="s2">&quot;Global measurement group timer does not exist.&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">getConfiguration</span><span class="p">()</span><span class="o">.</span><span class="n">_getTimerValue</span><span class="p">()</span></div>

<div class="viewcode-block" id="MeasurementGroup.enableChannels"><a class="viewcode-back" href="../../../../../../devel/api/sardana/taurus/core/tango/sardana/pool.html#sardana.taurus.core.tango.sardana.pool.MeasurementGroup.enableChannels">[docs]</a>    <span class="k">def</span> <span class="nf">enableChannels</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">channels</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;DEPRECATED: Enable acquisition of the indicated channels.</span>

<span class="sd">        :param channels: (seq&lt;str&gt;) a sequence of strings indicating</span>
<span class="sd">           channel names</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;enableChannels() in deprecated since Jul20. &quot;</span>
                     <span class="s2">&quot;Use setEnabled() instead.&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="o">*</span><span class="n">channels</span><span class="p">)</span></div>

<div class="viewcode-block" id="MeasurementGroup.disableChannels"><a class="viewcode-back" href="../../../../../../devel/api/sardana/taurus/core/tango/sardana/pool.html#sardana.taurus.core.tango.sardana.pool.MeasurementGroup.disableChannels">[docs]</a>    <span class="k">def</span> <span class="nf">disableChannels</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">channels</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;DEPRECATED: Disable acquisition of the indicated channels.</span>

<span class="sd">        :param channels: (seq&lt;str&gt;) a sequence of strings indicating</span>
<span class="sd">           channel names</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;enableChannels() in deprecated since Jul20. &quot;</span>
                     <span class="s2">&quot;Use setEnabled() instead.&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="kc">False</span><span class="p">,</span> <span class="o">*</span><span class="n">channels</span><span class="p">)</span></div>

    <span class="c1"># NbStarts Methods</span>
<div class="viewcode-block" id="MeasurementGroup.getNbStartsObj"><a class="viewcode-back" href="../../../../../../devel/api/sardana/taurus/core/tango/sardana/pool.html#sardana.taurus.core.tango.sardana.pool.MeasurementGroup.getNbStartsObj">[docs]</a>    <span class="k">def</span> <span class="nf">getNbStartsObj</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_getAttrEG</span><span class="p">(</span><span class="s1">&#39;NbStarts&#39;</span><span class="p">)</span></div>

<div class="viewcode-block" id="MeasurementGroup.setNbStarts"><a class="viewcode-back" href="../../../../../../devel/api/sardana/taurus/core/tango/sardana/pool.html#sardana.taurus.core.tango.sardana.pool.MeasurementGroup.setNbStarts">[docs]</a>    <span class="k">def</span> <span class="nf">setNbStarts</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">starts</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">getNbStartsObj</span><span class="p">()</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">starts</span><span class="p">)</span></div>

<div class="viewcode-block" id="MeasurementGroup.getNbStarts"><a class="viewcode-back" href="../../../../../../devel/api/sardana/taurus/core/tango/sardana/pool.html#sardana.taurus.core.tango.sardana.pool.MeasurementGroup.getNbStarts">[docs]</a>    <span class="k">def</span> <span class="nf">getNbStarts</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_getAttrValue</span><span class="p">(</span><span class="s1">&#39;NbStarts&#39;</span><span class="p">)</span></div>

<div class="viewcode-block" id="MeasurementGroup.getMoveableObj"><a class="viewcode-back" href="../../../../../../devel/api/sardana/taurus/core/tango/sardana/pool.html#sardana.taurus.core.tango.sardana.pool.MeasurementGroup.getMoveableObj">[docs]</a>    <span class="k">def</span> <span class="nf">getMoveableObj</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_getAttrEG</span><span class="p">(</span><span class="s1">&#39;Moveable&#39;</span><span class="p">)</span></div>

<div class="viewcode-block" id="MeasurementGroup.getMoveable"><a class="viewcode-back" href="../../../../../../devel/api/sardana/taurus/core/tango/sardana/pool.html#sardana.taurus.core.tango.sardana.pool.MeasurementGroup.getMoveable">[docs]</a>    <span class="k">def</span> <span class="nf">getMoveable</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_getAttrValue</span><span class="p">(</span><span class="s1">&#39;Moveable&#39;</span><span class="p">)</span></div>

<div class="viewcode-block" id="MeasurementGroup.getLatencyTimeObj"><a class="viewcode-back" href="../../../../../../devel/api/sardana/taurus/core/tango/sardana/pool.html#sardana.taurus.core.tango.sardana.pool.MeasurementGroup.getLatencyTimeObj">[docs]</a>    <span class="k">def</span> <span class="nf">getLatencyTimeObj</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_getAttrEG</span><span class="p">(</span><span class="s1">&#39;LatencyTime&#39;</span><span class="p">)</span></div>

<div class="viewcode-block" id="MeasurementGroup.getLatencyTime"><a class="viewcode-back" href="../../../../../../devel/api/sardana/taurus/core/tango/sardana/pool.html#sardana.taurus.core.tango.sardana.pool.MeasurementGroup.getLatencyTime">[docs]</a>    <span class="k">def</span> <span class="nf">getLatencyTime</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_getAttrValue</span><span class="p">(</span><span class="s1">&#39;LatencyTime&#39;</span><span class="p">)</span></div>

<div class="viewcode-block" id="MeasurementGroup.setMoveable"><a class="viewcode-back" href="../../../../../../devel/api/sardana/taurus/core/tango/sardana/pool.html#sardana.taurus.core.tango.sardana.pool.MeasurementGroup.setMoveable">[docs]</a>    <span class="k">def</span> <span class="nf">setMoveable</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">moveable</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">moveable</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">moveable</span> <span class="o">=</span> <span class="s1">&#39;None&#39;</span>  <span class="c1"># Tango attribute is of type DevString</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">getMoveableObj</span><span class="p">()</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">moveable</span><span class="p">)</span></div>

<div class="viewcode-block" id="MeasurementGroup.valueBufferChanged"><a class="viewcode-back" href="../../../../../../devel/api/sardana/taurus/core/tango/sardana/pool.html#sardana.taurus.core.tango.sardana.pool.MeasurementGroup.valueBufferChanged">[docs]</a>    <span class="k">def</span> <span class="nf">valueBufferChanged</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">channel</span><span class="p">,</span> <span class="n">value_buffer</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Receive value buffer updates, pre-process them, and call</span>
<span class="sd">        the subscribed callback.</span>

<span class="sd">        :param channel: channel that reports value buffer update</span>
<span class="sd">        :type channel: ExpChannel</span>
<span class="sd">        :param value_buffer: json encoded value buffer update, it contains</span>
<span class="sd">            at least values and indexes</span>
<span class="sd">        :type value_buffer: :obj:`str`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">value_buffer</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="n">_</span><span class="p">,</span> <span class="n">value_buffer</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_value_buffer_codec</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="n">value_buffer</span><span class="p">)</span>
        <span class="n">values</span> <span class="o">=</span> <span class="n">value_buffer</span><span class="p">[</span><span class="s2">&quot;value&quot;</span><span class="p">]</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="nb">list</span><span class="p">):</span>
            <span class="n">np_values</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">,</span> <span class="n">values</span><span class="p">))</span>
            <span class="n">value_buffer</span><span class="p">[</span><span class="s2">&quot;value&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np_values</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_value_buffer_cb</span><span class="p">(</span><span class="n">channel</span><span class="p">,</span> <span class="n">value_buffer</span><span class="p">)</span></div>

<div class="viewcode-block" id="MeasurementGroup.subscribeValueBuffer"><a class="viewcode-back" href="../../../../../../devel/api/sardana/taurus/core/tango/sardana/pool.html#sardana.taurus.core.tango.sardana.pool.MeasurementGroup.subscribeValueBuffer">[docs]</a>    <span class="k">def</span> <span class="nf">subscribeValueBuffer</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cb</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Subscribe to channels&#39; value buffer update events. If no</span>
<span class="sd">        callback is passed, the default channel&#39;s callback is subscribed which</span>
<span class="sd">        will store the data in the channel&#39;s value_buffer attribute.</span>

<span class="sd">        :param cb: callback to be subscribed, None means subscribe the default</span>
<span class="sd">            channel&#39;s callback</span>
<span class="sd">        :type cb: callable</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_value_buffer_channels</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">channel_info</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">getChannels</span><span class="p">():</span>
            <span class="n">full_name</span> <span class="o">=</span> <span class="n">channel_info</span><span class="p">[</span><span class="s2">&quot;full_name&quot;</span><span class="p">]</span>
            <span class="n">value_ref_enabled</span> <span class="o">=</span> <span class="n">channel_info</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;value_ref_enabled&quot;</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
            <span class="c1"># Use DeviceProxy instead of taurus to avoid crashes in Py3</span>
            <span class="c1"># See: tango-controls/pytango#292</span>
            <span class="k">if</span> <span class="n">_is_referable</span><span class="p">(</span><span class="n">full_name</span><span class="p">)</span> <span class="ow">and</span> <span class="n">value_ref_enabled</span><span class="p">:</span>
                <span class="k">continue</span>
            <span class="n">channel</span> <span class="o">=</span> <span class="n">Device</span><span class="p">(</span><span class="n">full_name</span><span class="p">)</span>
            <span class="n">value_buffer_obj</span> <span class="o">=</span> <span class="n">channel</span><span class="o">.</span><span class="n">getValueBufferObj</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">cb</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_value_buffer_cb</span> <span class="o">=</span> <span class="n">cb</span>
                <span class="n">value_buffer_obj</span><span class="o">.</span><span class="n">subscribeEvent</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">valueBufferChanged</span><span class="p">,</span>
                                                <span class="n">channel</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">value_buffer_obj</span><span class="o">.</span><span class="n">subscribeEvent</span><span class="p">(</span><span class="n">channel</span><span class="o">.</span><span class="n">valueBufferChanged</span><span class="p">,</span>
                                                <span class="n">with_first_event</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_value_buffer_channels</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">channel</span><span class="p">)</span></div>

<div class="viewcode-block" id="MeasurementGroup.unsubscribeValueBuffer"><a class="viewcode-back" href="../../../../../../devel/api/sardana/taurus/core/tango/sardana/pool.html#sardana.taurus.core.tango.sardana.pool.MeasurementGroup.unsubscribeValueBuffer">[docs]</a>    <span class="k">def</span> <span class="nf">unsubscribeValueBuffer</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cb</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Unsubscribe from channels&#39; value buffer events. If no callback is</span>
<span class="sd">        passed, unsubscribe the channel&#39;s default callback.</span>

<span class="sd">        :param cb: callback to be unsubscribed, None means unsubscribe the</span>
<span class="sd">            default channel&#39;s callback</span>
<span class="sd">        :type cb: callable</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">channel_info</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">getChannels</span><span class="p">():</span>
            <span class="n">full_name</span> <span class="o">=</span> <span class="n">channel_info</span><span class="p">[</span><span class="s2">&quot;full_name&quot;</span><span class="p">]</span>
            <span class="n">value_ref_enabled</span> <span class="o">=</span> <span class="n">channel_info</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;value_ref_enabled&quot;</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
            <span class="c1"># Use DeviceProxy instead of taurus to avoid crashes in Py3</span>
            <span class="c1"># See: tango-controls/pytango#292</span>
            <span class="k">if</span> <span class="n">_is_referable</span><span class="p">(</span><span class="n">full_name</span><span class="p">)</span> <span class="ow">and</span> <span class="n">value_ref_enabled</span><span class="p">:</span>
                <span class="k">continue</span>
            <span class="n">channel</span> <span class="o">=</span> <span class="n">Device</span><span class="p">(</span><span class="n">full_name</span><span class="p">)</span>
            <span class="n">value_buffer_obj</span> <span class="o">=</span> <span class="n">channel</span><span class="o">.</span><span class="n">getValueBufferObj</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">cb</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">value_buffer_obj</span><span class="o">.</span><span class="n">unsubscribeEvent</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">valueBufferChanged</span><span class="p">,</span>
                                                  <span class="n">channel</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_value_buffer_cb</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">value_buffer_obj</span><span class="o">.</span><span class="n">unsubscribeEvent</span><span class="p">(</span><span class="n">channel</span><span class="o">.</span><span class="n">valueBufferChanged</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_value_buffer_channels</span> <span class="o">=</span> <span class="kc">None</span></div>

<div class="viewcode-block" id="MeasurementGroup.valueRefBufferChanged"><a class="viewcode-back" href="../../../../../../devel/api/sardana/taurus/core/tango/sardana/pool.html#sardana.taurus.core.tango.sardana.pool.MeasurementGroup.valueRefBufferChanged">[docs]</a>    <span class="k">def</span> <span class="nf">valueRefBufferChanged</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">channel</span><span class="p">,</span> <span class="n">value_ref_buffer</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Receive value ref buffer updates, pre-process them, and call</span>
<span class="sd">        the subscribed callback.</span>

<span class="sd">        :param channel: channel that reports value ref buffer update</span>
<span class="sd">        :type channel: ExpChannel</span>
<span class="sd">        :param value_ref_buffer: json encoded value ref buffer update,</span>
<span class="sd">            it contains at least value refs and indexes</span>
<span class="sd">        :type value_ref_buffer: :obj:`str`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">value_ref_buffer</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="n">_</span><span class="p">,</span> <span class="n">value_ref_buffer</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_value_ref_buffer_codec</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span>
            <span class="n">value_ref_buffer</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_value_ref_buffer_cb</span><span class="p">(</span><span class="n">channel</span><span class="p">,</span> <span class="n">value_ref_buffer</span><span class="p">)</span></div>

<div class="viewcode-block" id="MeasurementGroup.subscribeValueRefBuffer"><a class="viewcode-back" href="../../../../../../devel/api/sardana/taurus/core/tango/sardana/pool.html#sardana.taurus.core.tango.sardana.pool.MeasurementGroup.subscribeValueRefBuffer">[docs]</a>    <span class="k">def</span> <span class="nf">subscribeValueRefBuffer</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cb</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Subscribe to channels&#39; value ref buffer update events. If no</span>
<span class="sd">        callback is passed, the default channel&#39;s callback is subscribed which</span>
<span class="sd">        will store the data in the channel&#39;s value_buffer attribute.</span>

<span class="sd">        :param cb: callback to be subscribed, None means subscribe the default</span>
<span class="sd">            channel&#39;s callback</span>
<span class="sd">        :type cb: callable</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_value_ref_buffer_channels</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">channel_info</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">getChannels</span><span class="p">():</span>
            <span class="n">full_name</span> <span class="o">=</span> <span class="n">channel_info</span><span class="p">[</span><span class="s2">&quot;full_name&quot;</span><span class="p">]</span>
            <span class="n">value_ref_enabled</span> <span class="o">=</span> <span class="n">channel_info</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;value_ref_enabled&quot;</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
            <span class="c1"># Use DeviceProxy instead of taurus to avoid crashes in Py3</span>
            <span class="c1"># See: tango-controls/pytango#292</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">_is_referable</span><span class="p">(</span><span class="n">full_name</span><span class="p">):</span>
                <span class="k">continue</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">value_ref_enabled</span><span class="p">:</span>
                <span class="k">continue</span>
            <span class="n">channel</span> <span class="o">=</span> <span class="n">Device</span><span class="p">(</span><span class="n">full_name</span><span class="p">)</span>
            <span class="n">value_ref_buffer_obj</span> <span class="o">=</span> <span class="n">channel</span><span class="o">.</span><span class="n">getValueRefBufferObj</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">cb</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_value_ref_buffer_cb</span> <span class="o">=</span> <span class="n">cb</span>
                <span class="n">value_ref_buffer_obj</span><span class="o">.</span><span class="n">subscribeEvent</span><span class="p">(</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">valueRefBufferChanged</span><span class="p">,</span> <span class="n">channel</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">value_ref_buffer_obj</span><span class="o">.</span><span class="n">subscribeEvent</span><span class="p">(</span>
                    <span class="n">channel</span><span class="o">.</span><span class="n">valueRefBufferChanged</span><span class="p">,</span> <span class="n">with_first_event</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_value_ref_buffer_channels</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">channel</span><span class="p">)</span></div>

<div class="viewcode-block" id="MeasurementGroup.unsubscribeValueRefBuffer"><a class="viewcode-back" href="../../../../../../devel/api/sardana/taurus/core/tango/sardana/pool.html#sardana.taurus.core.tango.sardana.pool.MeasurementGroup.unsubscribeValueRefBuffer">[docs]</a>    <span class="k">def</span> <span class="nf">unsubscribeValueRefBuffer</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cb</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Unsubscribe from channels&#39; value ref buffer events. If no</span>
<span class="sd">        callback is passed, unsubscribe the channel&#39;s default callback.</span>

<span class="sd">        :param cb: callback to be unsubscribed, None means unsubscribe the</span>
<span class="sd">            default channel&#39;s callback</span>
<span class="sd">        :type cb: callable</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">channel_info</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">getChannels</span><span class="p">():</span>
            <span class="n">full_name</span> <span class="o">=</span> <span class="n">channel_info</span><span class="p">[</span><span class="s2">&quot;full_name&quot;</span><span class="p">]</span>
            <span class="n">value_ref_enabled</span> <span class="o">=</span> <span class="n">channel_info</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;value_ref_enabled&quot;</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
            <span class="c1"># Use DeviceProxy instead of taurus to avoid crashes in Py3</span>
            <span class="c1"># See: tango-controls/pytango#292</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">_is_referable</span><span class="p">(</span><span class="n">full_name</span><span class="p">):</span>
                <span class="k">continue</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">value_ref_enabled</span><span class="p">:</span>
                <span class="k">continue</span>
            <span class="n">channel</span> <span class="o">=</span> <span class="n">Device</span><span class="p">(</span><span class="n">full_name</span><span class="p">)</span>
            <span class="n">value_ref_buffer_obj</span> <span class="o">=</span> <span class="n">channel</span><span class="o">.</span><span class="n">getValueRefBufferObj</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">cb</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">value_ref_buffer_obj</span><span class="o">.</span><span class="n">unsubscribeEvent</span><span class="p">(</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">valueRefBufferChanged</span><span class="p">,</span> <span class="n">channel</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_value_ref_buffer_cb</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">value_ref_buffer_obj</span><span class="o">.</span><span class="n">unsubscribeEvent</span><span class="p">(</span>
                    <span class="n">channel</span><span class="o">.</span><span class="n">valueRefBufferChanged</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_value_ref_buffer_channels</span> <span class="o">=</span> <span class="kc">None</span></div>

    <span class="k">def</span> <span class="nf">_start</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">Start</span><span class="p">()</span>
        <span class="k">except</span> <span class="n">DevFailed</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="c1"># TODO: Workaround for CORBA timeout on measurement group start</span>
            <span class="c1"># remove it whenever sardana-org/sardana#93 gets implemented</span>
            <span class="k">if</span> <span class="n">e</span><span class="o">.</span><span class="n">args</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">reason</span> <span class="o">==</span> <span class="s2">&quot;API_DeviceTimedOut&quot;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;start timed out, trying to stop&quot;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">stop</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;stopped&quot;</span><span class="p">)</span>
            <span class="k">raise</span> <span class="n">e</span>

<div class="viewcode-block" id="MeasurementGroup.prepare"><a class="viewcode-back" href="../../../../../../devel/api/sardana/taurus/core/tango/sardana/pool.html#sardana.taurus.core.tango.sardana.pool.MeasurementGroup.prepare">[docs]</a>    <span class="k">def</span> <span class="nf">prepare</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">command_inout</span><span class="p">(</span><span class="s2">&quot;Prepare&quot;</span><span class="p">)</span></div>

<div class="viewcode-block" id="MeasurementGroup.count_raw"><a class="viewcode-back" href="../../../../../../devel/api/sardana/taurus/core/tango/sardana/pool.html#sardana.taurus.core.tango.sardana.pool.MeasurementGroup.count_raw">[docs]</a>    <span class="k">def</span> <span class="nf">count_raw</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">start_time</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Raw count and report count values.</span>

<span class="sd">        Simply start and wait until finish, no configuration nor preparation.</span>

<span class="sd">        .. note::</span>
<span class="sd">            The count_raw method API is partially experimental (value</span>
<span class="sd">            references may be changed to values whenever possible in the</span>
<span class="sd">            future). Backwards incompatible changes may occur if deemed</span>
<span class="sd">            necessary by the core developers.</span>

<span class="sd">        :param start_time: start time of the whole count operation, if not</span>
<span class="sd">          passed a current timestamp will be used</span>
<span class="sd">        :type start_time: :obj:`float`</span>
<span class="sd">        :return: channel names and values (or value references - experimental)</span>
<span class="sd">        :rtype: :obj:`dict` where keys are channel full names and values are</span>
<span class="sd">          channel values (or value references - experimental)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">start_time</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">start_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
        <span class="n">PoolElement</span><span class="o">.</span><span class="n">go</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="n">state</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getStateEG</span><span class="p">()</span><span class="o">.</span><span class="n">readValue</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">state</span> <span class="o">==</span> <span class="n">Fault</span><span class="p">:</span>
            <span class="n">msg</span> <span class="o">=</span> <span class="s2">&quot;Measurement group ended acquisition with Fault state&quot;</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
        <span class="n">values</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getValues</span><span class="p">()</span>
        <span class="n">ret</span> <span class="o">=</span> <span class="n">state</span><span class="p">,</span> <span class="n">values</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_total_go_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start_time</span>
        <span class="k">return</span> <span class="n">ret</span></div>

<div class="viewcode-block" id="MeasurementGroup.go"><a class="viewcode-back" href="../../../../../../devel/api/sardana/taurus/core/tango/sardana/pool.html#sardana.taurus.core.tango.sardana.pool.MeasurementGroup.go">[docs]</a>    <span class="k">def</span> <span class="nf">go</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Count and report count values.</span>

<span class="sd">        Configuration and prepare for measurement, then start and wait until</span>
<span class="sd">        finish.</span>

<span class="sd">        .. note::</span>
<span class="sd">            The count (go) method API is partially experimental (value</span>
<span class="sd">            references may be changed to values whenever possible in the</span>
<span class="sd">            future). Backwards incompatible changes may occur if deemed</span>
<span class="sd">            necessary by the core developers.</span>

<span class="sd">        :return: channel names and values (or value references - experimental)</span>
<span class="sd">        :rtype: :obj:`dict` where keys are channel full names and values are</span>
<span class="sd">          channel values (or value references - experimental)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">start_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
        <span class="n">cfg</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getConfiguration</span><span class="p">()</span>
        <span class="n">cfg</span><span class="o">.</span><span class="n">prepare</span><span class="p">()</span>
        <span class="n">integration_time</span> <span class="o">=</span> <span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">integration_time</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">integration_time</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">getStateEG</span><span class="p">()</span><span class="o">.</span><span class="n">readValue</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">getValues</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">putIntegrationTime</span><span class="p">(</span><span class="n">integration_time</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setMoveable</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setNbStarts</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">prepare</span><span class="p">()</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">count_raw</span><span class="p">(</span><span class="n">start_time</span><span class="p">)</span></div>

<div class="viewcode-block" id="MeasurementGroup.count_continuous"><a class="viewcode-back" href="../../../../../../devel/api/sardana/taurus/core/tango/sardana/pool.html#sardana.taurus.core.tango.sardana.pool.MeasurementGroup.count_continuous">[docs]</a>    <span class="k">def</span> <span class="nf">count_continuous</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">synch_description</span><span class="p">,</span> <span class="n">value_buffer_cb</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Execute measurement process according to the given synchronization</span>
<span class="sd">        description.</span>

<span class="sd">        :param synch_description: synchronization description</span>
<span class="sd">        :type synch_description: list of groups with equidistant</span>
<span class="sd">          synchronizations</span>
<span class="sd">        :param value_buffer_cb: callback on value buffer updates</span>
<span class="sd">        :type value_buffer_cb: callable</span>
<span class="sd">        :return: state and eventually value buffers if no callback was passed</span>
<span class="sd">        :rtype: tuple&lt;list&lt;DevState&gt;,&lt;list&gt;&gt;</span>

<span class="sd">        .. todo:: Think of unifying measure with count.</span>

<span class="sd">        .. note:: The measure method has been included in MeasurementGroup</span>
<span class="sd">            class on a provisional basis. Backwards incompatible changes</span>
<span class="sd">            (up to and including removal of the method) may occur if</span>
<span class="sd">            deemed necessary by the core developers.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">start_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
        <span class="n">cfg</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getConfiguration</span><span class="p">()</span>
        <span class="n">cfg</span><span class="o">.</span><span class="n">prepare</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setSynchDescription</span><span class="p">(</span><span class="n">synch_description</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">prepare</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">subscribeValueBuffer</span><span class="p">(</span><span class="n">value_buffer_cb</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">count_raw</span><span class="p">(</span><span class="n">start_time</span><span class="p">)</span>
        <span class="k">finally</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">unsubscribeValueBuffer</span><span class="p">(</span><span class="n">value_buffer_cb</span><span class="p">)</span>
        <span class="n">state</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getStateEG</span><span class="p">()</span><span class="o">.</span><span class="n">readValue</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">state</span> <span class="o">==</span> <span class="n">Fault</span><span class="p">:</span>
            <span class="n">msg</span> <span class="o">=</span> <span class="s2">&quot;Measurement group ended acquisition with Fault state&quot;</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">value_buffer_cb</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">value_buffers</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getValueBuffers</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">value_buffers</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">ret</span> <span class="o">=</span> <span class="n">state</span><span class="p">,</span> <span class="n">value_buffers</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_total_go_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start_time</span>
        <span class="k">return</span> <span class="n">ret</span></div>

    <span class="n">startCount</span> <span class="o">=</span> <span class="n">PoolElement</span><span class="o">.</span><span class="n">start</span>
    <span class="n">waitCount</span> <span class="o">=</span> <span class="n">PoolElement</span><span class="o">.</span><span class="n">waitFinish</span>
    <span class="n">count</span> <span class="o">=</span> <span class="n">go</span>
    <span class="n">stopCount</span> <span class="o">=</span> <span class="n">PoolElement</span><span class="o">.</span><span class="n">abort</span>
    <span class="n">stop</span> <span class="o">=</span> <span class="n">PoolElement</span><span class="o">.</span><span class="n">stop</span></div>


<div class="viewcode-block" id="IORegister"><a class="viewcode-back" href="../../../../../../devel/api/sardana/taurus/core/tango/sardana/pool.html#sardana.taurus.core.tango.sardana.pool.IORegister">[docs]</a><span class="k">class</span> <span class="nc">IORegister</span><span class="p">(</span><span class="n">PoolElement</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Class encapsulating IORegister functionality.&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;IORegister initialization.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">call__init__</span><span class="p">(</span><span class="n">PoolElement</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">)</span>

<div class="viewcode-block" id="IORegister.getValueObj"><a class="viewcode-back" href="../../../../../../devel/api/sardana/taurus/core/tango/sardana/pool.html#sardana.taurus.core.tango.sardana.pool.IORegister.getValueObj">[docs]</a>    <span class="k">def</span> <span class="nf">getValueObj</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_getAttrEG</span><span class="p">(</span><span class="s1">&#39;value&#39;</span><span class="p">)</span></div>

<div class="viewcode-block" id="IORegister.readValue"><a class="viewcode-back" href="../../../../../../devel/api/sardana/taurus/core/tango/sardana/pool.html#sardana.taurus.core.tango.sardana.pool.IORegister.readValue">[docs]</a>    <span class="k">def</span> <span class="nf">readValue</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">force</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_getAttrValue</span><span class="p">(</span><span class="s1">&#39;value&#39;</span><span class="p">,</span> <span class="n">force</span><span class="o">=</span><span class="n">force</span><span class="p">)</span></div>

<div class="viewcode-block" id="IORegister.startWriteValue"><a class="viewcode-back" href="../../../../../../devel/api/sardana/taurus/core/tango/sardana/pool.html#sardana.taurus.core.tango.sardana.pool.IORegister.startWriteValue">[docs]</a>    <span class="k">def</span> <span class="nf">startWriteValue</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">new_value</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">getValueObj</span><span class="p">()</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">new_value</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">final_val</span> <span class="o">=</span> <span class="n">new_value</span>
        <span class="k">except</span> <span class="n">DevFailed</span> <span class="k">as</span> <span class="n">err_traceback</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">err</span> <span class="ow">in</span> <span class="n">err_traceback</span><span class="o">.</span><span class="n">args</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">err</span><span class="o">.</span><span class="n">reason</span> <span class="o">==</span> <span class="s1">&#39;API_AttrNotAllowed&#39;</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%s</span><span class="s1"> is already chaging&#39;</span> <span class="o">%</span> <span class="bp">self</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">raise</span></div>

<div class="viewcode-block" id="IORegister.waitWriteValue"><a class="viewcode-back" href="../../../../../../devel/api/sardana/taurus/core/tango/sardana/pool.html#sardana.taurus.core.tango.sardana.pool.IORegister.waitWriteValue">[docs]</a>    <span class="k">def</span> <span class="nf">waitWriteValue</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">pass</span></div>

<div class="viewcode-block" id="IORegister.writeValue"><a class="viewcode-back" href="../../../../../../devel/api/sardana/taurus/core/tango/sardana/pool.html#sardana.taurus.core.tango.sardana.pool.IORegister.writeValue">[docs]</a>    <span class="k">def</span> <span class="nf">writeValue</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">new_value</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">startWriteValue</span><span class="p">(</span><span class="n">new_value</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="n">timeout</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">waitWriteValue</span><span class="p">(</span><span class="n">timeout</span><span class="o">=</span><span class="n">timeout</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">getStateEG</span><span class="p">()</span><span class="o">.</span><span class="n">readValue</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">readValue</span><span class="p">()</span></div>

    <span class="n">writeIORegister</span> <span class="o">=</span> <span class="n">writeIOR</span> <span class="o">=</span> <span class="n">writeValue</span>
    <span class="n">readIORegister</span> <span class="o">=</span> <span class="n">readIOR</span> <span class="o">=</span> <span class="n">getValue</span> <span class="o">=</span> <span class="n">readValue</span></div>


<div class="viewcode-block" id="Instrument"><a class="viewcode-back" href="../../../../../../devel/api/sardana/taurus/core/tango/sardana/pool.html#sardana.taurus.core.tango.sardana.pool.Instrument">[docs]</a><span class="k">class</span> <span class="nc">Instrument</span><span class="p">(</span><span class="n">BaseElement</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="vm">__dict__</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">kw</span><span class="p">)</span>

<div class="viewcode-block" id="Instrument.getFullName"><a class="viewcode-back" href="../../../../../../devel/api/sardana/taurus/core/tango/sardana/pool.html#sardana.taurus.core.tango.sardana.pool.Instrument.getFullName">[docs]</a>    <span class="k">def</span> <span class="nf">getFullName</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">full_name</span></div>

<div class="viewcode-block" id="Instrument.getParentInstrument"><a class="viewcode-back" href="../../../../../../devel/api/sardana/taurus/core/tango/sardana/pool.html#sardana.taurus.core.tango.sardana.pool.Instrument.getParentInstrument">[docs]</a>    <span class="k">def</span> <span class="nf">getParentInstrument</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">getPoolObj</span><span class="p">()</span><span class="o">.</span><span class="n">getObj</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parent_instrument</span><span class="p">)</span></div>

<div class="viewcode-block" id="Instrument.getParentInstrumentName"><a class="viewcode-back" href="../../../../../../devel/api/sardana/taurus/core/tango/sardana/pool.html#sardana.taurus.core.tango.sardana.pool.Instrument.getParentInstrumentName">[docs]</a>    <span class="k">def</span> <span class="nf">getParentInstrumentName</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent_instrument</span></div>

<div class="viewcode-block" id="Instrument.getChildrenInstruments"><a class="viewcode-back" href="../../../../../../devel/api/sardana/taurus/core/tango/sardana/pool.html#sardana.taurus.core.tango.sardana.pool.Instrument.getChildrenInstruments">[docs]</a>    <span class="k">def</span> <span class="nf">getChildrenInstruments</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_children</span></div>

<div class="viewcode-block" id="Instrument.getElements"><a class="viewcode-back" href="../../../../../../devel/api/sardana/taurus/core/tango/sardana/pool.html#sardana.taurus.core.tango.sardana.pool.Instrument.getElements">[docs]</a>    <span class="k">def</span> <span class="nf">getElements</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_elements</span></div>

<div class="viewcode-block" id="Instrument.getType"><a class="viewcode-back" href="../../../../../../devel/api/sardana/taurus/core/tango/sardana/pool.html#sardana.taurus.core.tango.sardana.pool.Instrument.getType">[docs]</a>    <span class="k">def</span> <span class="nf">getType</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">klass</span></div></div>


<div class="viewcode-block" id="Pool"><a class="viewcode-back" href="../../../../../../devel/api/sardana/taurus/core/tango/sardana/pool.html#sardana.taurus.core.tango.sardana.pool.Pool">[docs]</a><span class="k">class</span> <span class="nc">Pool</span><span class="p">(</span><span class="n">TangoDevice</span><span class="p">,</span> <span class="n">MoveableSource</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Class encapsulating device Pool functionality.&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">call__init__</span><span class="p">(</span><span class="n">TangoDevice</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">call__init__</span><span class="p">(</span><span class="n">MoveableSource</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_elements</span> <span class="o">=</span> <span class="n">BaseSardanaElementContainer</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__elements_attr</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getAttribute</span><span class="p">(</span><span class="s2">&quot;Elements&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__elements_attr</span><span class="o">.</span><span class="n">addListener</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">on_elements_changed</span><span class="p">)</span>

<div class="viewcode-block" id="Pool.cleanUp"><a class="viewcode-back" href="../../../../../../devel/api/sardana/taurus/core/tango/sardana/pool.html#sardana.taurus.core.tango.sardana.pool.Pool.cleanUp">[docs]</a>    <span class="k">def</span> <span class="nf">cleanUp</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">TangoDevice</span><span class="o">.</span><span class="n">cleanUp</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="n">f</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">factory</span><span class="p">()</span>
        <span class="n">f</span><span class="o">.</span><span class="n">removeExistingAttribute</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__elements_attr</span><span class="p">)</span></div>

<div class="viewcode-block" id="Pool.getObject"><a class="viewcode-back" href="../../../../../../devel/api/sardana/taurus/core/tango/sardana/pool.html#sardana.taurus.core.tango.sardana.pool.Pool.getObject">[docs]</a>    <span class="k">def</span> <span class="nf">getObject</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">element_info</span><span class="p">):</span>
        <span class="n">elem_type</span> <span class="o">=</span> <span class="n">element_info</span><span class="o">.</span><span class="n">getType</span><span class="p">()</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">element_info</span><span class="o">.</span><span class="n">_data</span>
        <span class="k">if</span> <span class="n">elem_type</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;ControllerClass&#39;</span><span class="p">,</span> <span class="s1">&#39;ControllerLibrary&#39;</span><span class="p">,</span> <span class="s1">&#39;Instrument&#39;</span><span class="p">):</span>
            <span class="n">klass</span> <span class="o">=</span> <span class="nb">globals</span><span class="p">()[</span><span class="n">elem_type</span><span class="p">]</span>
            <span class="n">kwargs</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
            <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;_pool_data&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span>
            <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;_pool_obj&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span>
            <span class="k">return</span> <span class="n">klass</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">obj</span> <span class="o">=</span> <span class="n">Factory</span><span class="p">()</span><span class="o">.</span><span class="n">getDevice</span><span class="p">(</span><span class="n">element_info</span><span class="o">.</span><span class="n">full_name</span><span class="p">,</span> <span class="n">_pool_obj</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span>
                                  <span class="n">_pool_data</span><span class="o">=</span><span class="n">data</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">obj</span></div>

<div class="viewcode-block" id="Pool.on_elements_changed"><a class="viewcode-back" href="../../../../../../devel/api/sardana/taurus/core/tango/sardana/pool.html#sardana.taurus.core.tango.sardana.pool.Pool.on_elements_changed">[docs]</a>    <span class="k">def</span> <span class="nf">on_elements_changed</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">evt_src</span><span class="p">,</span> <span class="n">evt_type</span><span class="p">,</span> <span class="n">evt_value</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">evt_type</span> <span class="o">==</span> <span class="n">TaurusEventType</span><span class="o">.</span><span class="n">Error</span><span class="p">:</span>
            <span class="n">msg</span> <span class="o">=</span> <span class="n">evt_value</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">msg</span><span class="p">,</span> <span class="n">DevFailed</span><span class="p">):</span>
                <span class="n">d</span> <span class="o">=</span> <span class="n">msg</span><span class="o">.</span><span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                <span class="c1"># skip configuration errors</span>
                <span class="k">if</span> <span class="n">d</span><span class="o">.</span><span class="n">reason</span> <span class="o">==</span> <span class="s2">&quot;API_BadConfigurationProperty&quot;</span><span class="p">:</span>
                    <span class="k">return</span>
                <span class="k">if</span> <span class="n">d</span><span class="o">.</span><span class="n">reason</span> <span class="ow">in</span> <span class="p">(</span><span class="s2">&quot;API_DeviceNotExported&quot;</span><span class="p">,</span>
                                <span class="s2">&quot;API_CantConnectToDevice&quot;</span><span class="p">):</span>
                    <span class="n">msg</span> <span class="o">=</span> <span class="s2">&quot;Pool was shutdown or is inaccessible&quot;</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">msg</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">{0}</span><span class="s2">: </span><span class="si">{1}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">d</span><span class="o">.</span><span class="n">reason</span><span class="p">,</span> <span class="n">d</span><span class="o">.</span><span class="n">desc</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;Received elements error event </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">msg</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="n">evt_value</span><span class="p">)</span>
            <span class="k">return</span>
        <span class="k">elif</span> <span class="n">evt_type</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">CHANGE_EVT_TYPES</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">elems</span> <span class="o">=</span> <span class="n">CodecFactory</span><span class="p">()</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="n">evt_value</span><span class="o">.</span><span class="n">rvalue</span><span class="p">)</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;Could not decode element info&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;value: &#39;</span><span class="si">%s</span><span class="s2">&#39;&quot;</span><span class="p">,</span> <span class="n">evt_value</span><span class="o">.</span><span class="n">rvalue</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Details:&quot;</span><span class="p">,</span> <span class="n">exc_info</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
            <span class="k">return</span>
        <span class="n">elements</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getElementsInfo</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">element_data</span> <span class="ow">in</span> <span class="n">elems</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;new&#39;</span><span class="p">,</span> <span class="p">()):</span>
            <span class="n">element_data</span><span class="p">[</span><span class="s1">&#39;manager&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span>
            <span class="n">element</span> <span class="o">=</span> <span class="n">BaseSardanaElement</span><span class="p">(</span><span class="o">**</span><span class="n">element_data</span><span class="p">)</span>
            <span class="n">elements</span><span class="o">.</span><span class="n">addElement</span><span class="p">(</span><span class="n">element</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">element_data</span> <span class="ow">in</span> <span class="n">elems</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;del&#39;</span><span class="p">,</span> <span class="p">()):</span>
            <span class="n">element</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getElementInfo</span><span class="p">(</span><span class="n">element_data</span><span class="p">[</span><span class="s1">&#39;full_name&#39;</span><span class="p">])</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">elements</span><span class="o">.</span><span class="n">removeElement</span><span class="p">(</span><span class="n">element</span><span class="p">)</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;Failed to remove </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">element_data</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">element_data</span> <span class="ow">in</span> <span class="n">elems</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;change&#39;</span><span class="p">,</span> <span class="p">()):</span>
            <span class="c1"># TODO: element is assigned but not used!! (check)</span>
            <span class="n">element</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_removeElement</span><span class="p">(</span><span class="n">element_data</span><span class="p">)</span>
            <span class="n">element</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_addElement</span><span class="p">(</span><span class="n">element_data</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">elems</span></div>

    <span class="k">def</span> <span class="nf">_addElement</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">element_data</span><span class="p">):</span>
        <span class="n">element_data</span><span class="p">[</span><span class="s1">&#39;manager&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span>
        <span class="n">element</span> <span class="o">=</span> <span class="n">BaseSardanaElement</span><span class="p">(</span><span class="o">**</span><span class="n">element_data</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">getElementsInfo</span><span class="p">()</span><span class="o">.</span><span class="n">addElement</span><span class="p">(</span><span class="n">element</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">element</span>

    <span class="k">def</span> <span class="nf">_removeElement</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">element_data</span><span class="p">):</span>
        <span class="n">name</span> <span class="o">=</span> <span class="n">element_data</span><span class="p">[</span><span class="s1">&#39;full_name&#39;</span><span class="p">]</span>
        <span class="n">element</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getElementInfo</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">getElementsInfo</span><span class="p">()</span><span class="o">.</span><span class="n">removeElement</span><span class="p">(</span><span class="n">element</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">element</span>

<div class="viewcode-block" id="Pool.getElementsInfo"><a class="viewcode-back" href="../../../../../../devel/api/sardana/taurus/core/tango/sardana/pool.html#sardana.taurus.core.tango.sardana.pool.Pool.getElementsInfo">[docs]</a>    <span class="k">def</span> <span class="nf">getElementsInfo</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_elements</span></div>

<div class="viewcode-block" id="Pool.getElements"><a class="viewcode-back" href="../../../../../../devel/api/sardana/taurus/core/tango/sardana/pool.html#sardana.taurus.core.tango.sardana.pool.Pool.getElements">[docs]</a>    <span class="k">def</span> <span class="nf">getElements</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">getElementsInfo</span><span class="p">()</span><span class="o">.</span><span class="n">getElements</span><span class="p">()</span></div>

<div class="viewcode-block" id="Pool.getElementInfo"><a class="viewcode-back" href="../../../../../../devel/api/sardana/taurus/core/tango/sardana/pool.html#sardana.taurus.core.tango.sardana.pool.Pool.getElementInfo">[docs]</a>    <span class="k">def</span> <span class="nf">getElementInfo</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">getElementsInfo</span><span class="p">()</span><span class="o">.</span><span class="n">getElement</span><span class="p">(</span><span class="n">name</span><span class="p">)</span></div>

<div class="viewcode-block" id="Pool.getElementNamesOfType"><a class="viewcode-back" href="../../../../../../devel/api/sardana/taurus/core/tango/sardana/pool.html#sardana.taurus.core.tango.sardana.pool.Pool.getElementNamesOfType">[docs]</a>    <span class="k">def</span> <span class="nf">getElementNamesOfType</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">elem_type</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">getElementsInfo</span><span class="p">()</span><span class="o">.</span><span class="n">getElementNamesOfType</span><span class="p">(</span><span class="n">elem_type</span><span class="p">)</span></div>

<div class="viewcode-block" id="Pool.getElementsOfType"><a class="viewcode-back" href="../../../../../../devel/api/sardana/taurus/core/tango/sardana/pool.html#sardana.taurus.core.tango.sardana.pool.Pool.getElementsOfType">[docs]</a>    <span class="k">def</span> <span class="nf">getElementsOfType</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">elem_type</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">getElementsInfo</span><span class="p">()</span><span class="o">.</span><span class="n">getElementsOfType</span><span class="p">(</span><span class="n">elem_type</span><span class="p">)</span></div>

<div class="viewcode-block" id="Pool.getElementsWithInterface"><a class="viewcode-back" href="../../../../../../devel/api/sardana/taurus/core/tango/sardana/pool.html#sardana.taurus.core.tango.sardana.pool.Pool.getElementsWithInterface">[docs]</a>    <span class="k">def</span> <span class="nf">getElementsWithInterface</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">interface</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">getElementsInfo</span><span class="p">()</span><span class="o">.</span><span class="n">getElementsWithInterface</span><span class="p">(</span><span class="n">interface</span><span class="p">)</span></div>

<div class="viewcode-block" id="Pool.getElementWithInterface"><a class="viewcode-back" href="../../../../../../devel/api/sardana/taurus/core/tango/sardana/pool.html#sardana.taurus.core.tango.sardana.pool.Pool.getElementWithInterface">[docs]</a>    <span class="k">def</span> <span class="nf">getElementWithInterface</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">elem_name</span><span class="p">,</span> <span class="n">interface</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">getElementsInfo</span><span class="p">()</span><span class="o">.</span><span class="n">getElementWithInterface</span><span class="p">(</span><span class="n">elem_name</span><span class="p">,</span>
                                                              <span class="n">interface</span><span class="p">)</span></div>

<div class="viewcode-block" id="Pool.getObj"><a class="viewcode-back" href="../../../../../../devel/api/sardana/taurus/core/tango/sardana/pool.html#sardana.taurus.core.tango.sardana.pool.Pool.getObj">[docs]</a>    <span class="k">def</span> <span class="nf">getObj</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">elem_type</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">elem_type</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">getElementInfo</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">elem_type</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="n">elem_types</span> <span class="o">=</span> <span class="n">elem_type</span><span class="p">,</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">elem_types</span> <span class="o">=</span> <span class="n">elem_type</span>
        <span class="n">name</span> <span class="o">=</span> <span class="n">name</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">e_type</span> <span class="ow">in</span> <span class="n">elem_types</span><span class="p">:</span>
            <span class="n">elems</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getElementsOfType</span><span class="p">(</span><span class="n">e_type</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">elem</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">elems</span><span class="o">.</span><span class="n">values</span><span class="p">()):</span>
                <span class="k">if</span> <span class="n">elem</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="n">name</span><span class="p">:</span>
                    <span class="k">return</span> <span class="n">elem</span>
            <span class="n">elem</span> <span class="o">=</span> <span class="n">elems</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">elem</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">elem</span></div>

    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">getNormalName</span><span class="p">()</span>

    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">repr</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

    <span class="c1"># -~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-</span>
    <span class="c1"># MoveableSource interface</span>
    <span class="c1">#</span>

<div class="viewcode-block" id="Pool.getMoveable"><a class="viewcode-back" href="../../../../../../devel/api/sardana/taurus/core/tango/sardana/pool.html#sardana.taurus.core.tango.sardana.pool.Pool.getMoveable">[docs]</a>    <span class="k">def</span> <span class="nf">getMoveable</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">names</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;getMoveable(seq&lt;string&gt; names) -&gt; Moveable</span>

<span class="sd">        Returns a moveable object that handles all the moveable items given in</span>
<span class="sd">        names.&quot;&quot;&quot;</span>
        <span class="c1"># if simple motor just return it (if the pool has it)</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">names</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="n">names</span> <span class="o">=</span> <span class="n">names</span><span class="p">,</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">names</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">name</span> <span class="o">=</span> <span class="n">names</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">getObj</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">elem_type</span><span class="o">=</span><span class="n">MOVEABLE_TYPES</span><span class="p">)</span>

        <span class="c1"># find a motor group that contains elements</span>
        <span class="n">moveable</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__findMotorGroupWithElems</span><span class="p">(</span><span class="n">names</span><span class="p">)</span>

        <span class="c1"># if none exists create one</span>
        <span class="k">if</span> <span class="n">moveable</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">mgs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getElementsOfType</span><span class="p">(</span><span class="s1">&#39;MotorGroup&#39;</span><span class="p">)</span>
            <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span>
            <span class="n">pid</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">getpid</span><span class="p">()</span>
            <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
                <span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;_mg_ms_</span><span class="si">{0}</span><span class="s2">_</span><span class="si">{1}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">pid</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span>
                <span class="n">exists</span> <span class="o">=</span> <span class="kc">False</span>
                <span class="k">for</span> <span class="n">mg</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">mgs</span><span class="o">.</span><span class="n">values</span><span class="p">()):</span>
                    <span class="k">if</span> <span class="n">mg</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="n">name</span><span class="p">:</span>
                        <span class="n">exists</span> <span class="o">=</span> <span class="kc">True</span>
                        <span class="k">break</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">exists</span><span class="p">:</span>
                    <span class="k">break</span>
                <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="n">moveable</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">createMotorGroup</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">names</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">moveable</span></div>

    <span class="k">def</span> <span class="nf">__findMotorGroupWithElems</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">names</span><span class="p">):</span>
        <span class="n">names_lower</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">str</span><span class="o">.</span><span class="n">lower</span><span class="p">,</span> <span class="n">names</span><span class="p">))</span>
        <span class="n">len_names</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">names</span><span class="p">)</span>
        <span class="n">mgs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getElementsOfType</span><span class="p">(</span><span class="s1">&#39;MotorGroup&#39;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">mg</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">mgs</span><span class="o">.</span><span class="n">values</span><span class="p">()):</span>
            <span class="n">mg_elems</span> <span class="o">=</span> <span class="n">mg</span><span class="o">.</span><span class="n">elements</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">mg_elems</span><span class="p">)</span> <span class="o">!=</span> <span class="n">len_names</span><span class="p">:</span>
                <span class="k">continue</span>
            <span class="k">for</span> <span class="n">mg_elem</span><span class="p">,</span> <span class="n">name</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">mg_elems</span><span class="p">,</span> <span class="n">names_lower</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">mg_elem</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">!=</span> <span class="n">name</span><span class="p">:</span>
                    <span class="k">break</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">mg</span>

    <span class="c1">#</span>
    <span class="c1"># End of MoveableSource interface</span>
    <span class="c1"># -~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-</span>

    <span class="k">def</span> <span class="nf">_wait_for_element_in_container</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">container</span><span class="p">,</span> <span class="n">elem_name</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
                                       <span class="n">contains</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="n">start</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
        <span class="n">cond</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="n">nap</span> <span class="o">=</span> <span class="mf">0.01</span>
        <span class="k">if</span> <span class="n">timeout</span><span class="p">:</span>
            <span class="n">nap</span> <span class="o">=</span> <span class="n">timeout</span> <span class="o">/</span> <span class="mi">10</span>
        <span class="k">while</span> <span class="n">cond</span><span class="p">:</span>
            <span class="n">elem</span> <span class="o">=</span> <span class="n">container</span><span class="o">.</span><span class="n">getElement</span><span class="p">(</span><span class="n">elem_name</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">contains</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">elem</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="k">return</span> <span class="n">elem</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">elem</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="k">return</span> <span class="kc">True</span>
            <span class="k">if</span> <span class="n">timeout</span><span class="p">:</span>
                <span class="n">dt</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start</span>
                <span class="k">if</span> <span class="n">dt</span> <span class="o">&gt;</span> <span class="n">timeout</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Timed out waiting for &#39;</span><span class="si">%s</span><span class="s2">&#39; in container&quot;</span><span class="p">,</span>
                              <span class="n">elem_name</span><span class="p">)</span>
                    <span class="k">return</span>
            <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="n">nap</span><span class="p">)</span>

<div class="viewcode-block" id="Pool.createMotorGroup"><a class="viewcode-back" href="../../../../../../devel/api/sardana/taurus/core/tango/sardana/pool.html#sardana.taurus.core.tango.sardana.pool.Pool.createMotorGroup">[docs]</a>    <span class="k">def</span> <span class="nf">createMotorGroup</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mg_name</span><span class="p">,</span> <span class="n">elements</span><span class="p">):</span>
        <span class="n">params</span> <span class="o">=</span> <span class="p">[</span><span class="n">mg_name</span><span class="p">,</span> <span class="p">]</span> <span class="o">+</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="n">elements</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s1">&#39;trying to create motor group for elements: </span><span class="si">%s</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">params</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">command_inout</span><span class="p">(</span><span class="s1">&#39;CreateMotorGroup&#39;</span><span class="p">,</span> <span class="n">params</span><span class="p">)</span>
        <span class="n">elements_info</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getElementsInfo</span><span class="p">()</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_wait_for_element_in_container</span><span class="p">(</span><span class="n">elements_info</span><span class="p">,</span> <span class="n">mg_name</span><span class="p">)</span></div>

<div class="viewcode-block" id="Pool.createMeasurementGroup"><a class="viewcode-back" href="../../../../../../devel/api/sardana/taurus/core/tango/sardana/pool.html#sardana.taurus.core.tango.sardana.pool.Pool.createMeasurementGroup">[docs]</a>    <span class="k">def</span> <span class="nf">createMeasurementGroup</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mg_name</span><span class="p">,</span> <span class="n">elements</span><span class="p">):</span>
        <span class="n">params</span> <span class="o">=</span> <span class="p">[</span><span class="n">mg_name</span><span class="p">,</span> <span class="p">]</span> <span class="o">+</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="n">elements</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s1">&#39;trying to create measurement group: </span><span class="si">%s</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">params</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">command_inout</span><span class="p">(</span><span class="s1">&#39;CreateMeasurementGroup&#39;</span><span class="p">,</span> <span class="n">params</span><span class="p">)</span>
        <span class="n">elements_info</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getElementsInfo</span><span class="p">()</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_wait_for_element_in_container</span><span class="p">(</span><span class="n">elements_info</span><span class="p">,</span> <span class="n">mg_name</span><span class="p">)</span></div>

<div class="viewcode-block" id="Pool.deleteMeasurementGroup"><a class="viewcode-back" href="../../../../../../devel/api/sardana/taurus/core/tango/sardana/pool.html#sardana.taurus.core.tango.sardana.pool.Pool.deleteMeasurementGroup">[docs]</a>    <span class="k">def</span> <span class="nf">deleteMeasurementGroup</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">deleteElement</span><span class="p">(</span><span class="n">name</span><span class="p">)</span></div>

<div class="viewcode-block" id="Pool.createElement"><a class="viewcode-back" href="../../../../../../devel/api/sardana/taurus/core/tango/sardana/pool.html#sardana.taurus.core.tango.sardana.pool.Pool.createElement">[docs]</a>    <span class="k">def</span> <span class="nf">createElement</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">ctrl</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="n">ctrl_type</span> <span class="o">=</span> <span class="n">ctrl</span><span class="o">.</span><span class="n">types</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">axis</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">last_axis</span> <span class="o">=</span> <span class="n">ctrl</span><span class="o">.</span><span class="n">getLastUsedAxis</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">last_axis</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">axis</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">axis</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">last_axis</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">axis</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">axis</span><span class="p">)</span>
        <span class="n">cmd</span> <span class="o">=</span> <span class="s2">&quot;CreateElement&quot;</span>
        <span class="n">pars</span> <span class="o">=</span> <span class="n">ctrl_type</span><span class="p">,</span> <span class="n">ctrl</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">axis</span><span class="p">,</span> <span class="n">name</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">command_inout</span><span class="p">(</span><span class="n">cmd</span><span class="p">,</span> <span class="n">pars</span><span class="p">)</span>
        <span class="n">elements_info</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getElementsInfo</span><span class="p">()</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_wait_for_element_in_container</span><span class="p">(</span><span class="n">elements_info</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span></div>

<div class="viewcode-block" id="Pool.renameElement"><a class="viewcode-back" href="../../../../../../devel/api/sardana/taurus/core/tango/sardana/pool.html#sardana.taurus.core.tango.sardana.pool.Pool.renameElement">[docs]</a>    <span class="k">def</span> <span class="nf">renameElement</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">old_name</span><span class="p">,</span> <span class="n">new_name</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s1">&#39;trying to rename element: </span><span class="si">%s</span><span class="s1"> to: </span><span class="si">%s</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">old_name</span><span class="p">,</span> <span class="n">new_name</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">command_inout</span><span class="p">(</span><span class="s1">&#39;RenameElement&#39;</span><span class="p">,</span> <span class="p">[</span><span class="n">old_name</span><span class="p">,</span> <span class="n">new_name</span><span class="p">])</span>
        <span class="n">elements_info</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getElementsInfo</span><span class="p">()</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_wait_for_element_in_container</span><span class="p">(</span><span class="n">elements_info</span><span class="p">,</span> <span class="n">new_name</span><span class="p">,</span>
                                                   <span class="n">contains</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></div>

<div class="viewcode-block" id="Pool.deleteElement"><a class="viewcode-back" href="../../../../../../devel/api/sardana/taurus/core/tango/sardana/pool.html#sardana.taurus.core.tango.sardana.pool.Pool.deleteElement">[docs]</a>    <span class="k">def</span> <span class="nf">deleteElement</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s1">&#39;trying to delete element: </span><span class="si">%s</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">command_inout</span><span class="p">(</span><span class="s1">&#39;DeleteElement&#39;</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
        <span class="n">elements_info</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getElementsInfo</span><span class="p">()</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_wait_for_element_in_container</span><span class="p">(</span><span class="n">elements_info</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span>
                                                   <span class="n">contains</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></div>

<div class="viewcode-block" id="Pool.createController"><a class="viewcode-back" href="../../../../../../devel/api/sardana/taurus/core/tango/sardana/pool.html#sardana.taurus.core.tango.sardana.pool.Pool.createController">[docs]</a>    <span class="k">def</span> <span class="nf">createController</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">class_name</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="o">*</span><span class="n">props</span><span class="p">):</span>
        <span class="n">ctrl_class</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getObj</span><span class="p">(</span><span class="n">class_name</span><span class="p">,</span> <span class="n">elem_type</span><span class="o">=</span><span class="s1">&#39;ControllerClass&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">ctrl_class</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;Controller class </span><span class="si">%s</span><span class="s2"> not found&quot;</span> <span class="o">%</span> <span class="n">class_name</span><span class="p">)</span>
        <span class="n">cmd</span> <span class="o">=</span> <span class="s2">&quot;CreateController&quot;</span>
        <span class="n">pars</span> <span class="o">=</span> <span class="p">[</span><span class="n">ctrl_class</span><span class="o">.</span><span class="n">types</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">ctrl_class</span><span class="o">.</span><span class="n">file_name</span><span class="p">,</span> <span class="n">class_name</span><span class="p">,</span> <span class="n">name</span><span class="p">]</span>
        <span class="n">pars</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="n">props</span><span class="p">)))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">command_inout</span><span class="p">(</span><span class="n">cmd</span><span class="p">,</span> <span class="n">pars</span><span class="p">)</span>
        <span class="n">elements_info</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getElementsInfo</span><span class="p">()</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_wait_for_element_in_container</span><span class="p">(</span><span class="n">elements_info</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span></div>

<div class="viewcode-block" id="Pool.deleteController"><a class="viewcode-back" href="../../../../../../devel/api/sardana/taurus/core/tango/sardana/pool.html#sardana.taurus.core.tango.sardana.pool.Pool.deleteController">[docs]</a>    <span class="k">def</span> <span class="nf">deleteController</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">deleteElement</span><span class="p">(</span><span class="n">name</span><span class="p">)</span></div>

<div class="viewcode-block" id="Pool.createInstrument"><a class="viewcode-back" href="../../../../../../devel/api/sardana/taurus/core/tango/sardana/pool.html#sardana.taurus.core.tango.sardana.pool.Pool.createInstrument">[docs]</a>    <span class="k">def</span> <span class="nf">createInstrument</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">full_name</span><span class="p">,</span> <span class="n">class_name</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">command_inout</span><span class="p">(</span><span class="s2">&quot;CreateInstrument&quot;</span><span class="p">,</span> <span class="p">[</span><span class="n">full_name</span><span class="p">,</span> <span class="n">class_name</span><span class="p">])</span>
        <span class="n">elements_info</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getElementsInfo</span><span class="p">()</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_wait_for_element_in_container</span><span class="p">(</span><span class="n">elements_info</span><span class="p">,</span> <span class="n">full_name</span><span class="p">)</span></div></div>


<div class="viewcode-block" id="registerExtensions"><a class="viewcode-back" href="../../../../../../devel/api/sardana/taurus/core/tango/sardana/pool.html#sardana.taurus.core.tango.sardana.pool.registerExtensions">[docs]</a><span class="k">def</span> <span class="nf">registerExtensions</span><span class="p">():</span>
    <span class="n">factory</span> <span class="o">=</span> <span class="n">Factory</span><span class="p">()</span>
    <span class="n">factory</span><span class="o">.</span><span class="n">registerDeviceClass</span><span class="p">(</span><span class="s2">&quot;Pool&quot;</span><span class="p">,</span> <span class="n">Pool</span><span class="p">)</span>

    <span class="n">hw_type_names</span> <span class="o">=</span> <span class="p">[</span>
        <span class="s1">&#39;Controller&#39;</span><span class="p">,</span>
        <span class="s1">&#39;ComChannel&#39;</span><span class="p">,</span> <span class="s1">&#39;Motor&#39;</span><span class="p">,</span> <span class="s1">&#39;PseudoMotor&#39;</span><span class="p">,</span> <span class="s1">&#39;TriggerGate&#39;</span><span class="p">,</span>
        <span class="s1">&#39;CTExpChannel&#39;</span><span class="p">,</span> <span class="s1">&#39;ZeroDExpChannel&#39;</span><span class="p">,</span> <span class="s1">&#39;OneDExpChannel&#39;</span><span class="p">,</span> <span class="s1">&#39;TwoDExpChannel&#39;</span><span class="p">,</span>
        <span class="s1">&#39;PseudoCounter&#39;</span><span class="p">,</span> <span class="s1">&#39;IORegister&#39;</span><span class="p">,</span> <span class="s1">&#39;MotorGroup&#39;</span><span class="p">,</span> <span class="s1">&#39;MeasurementGroup&#39;</span><span class="p">]</span>

    <span class="n">hw_type_map</span> <span class="o">=</span> <span class="p">[(</span><span class="n">name</span><span class="p">,</span> <span class="nb">globals</span><span class="p">()[</span><span class="n">name</span><span class="p">])</span> <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">hw_type_names</span><span class="p">]</span>

    <span class="k">for</span> <span class="n">klass_name</span><span class="p">,</span> <span class="n">klass</span> <span class="ow">in</span> <span class="n">hw_type_map</span><span class="p">:</span>
        <span class="n">factory</span><span class="o">.</span><span class="n">registerDeviceClass</span><span class="p">(</span><span class="n">klass_name</span><span class="p">,</span> <span class="n">klass</span><span class="p">)</span></div>


<div class="viewcode-block" id="unregisterExtensions"><a class="viewcode-back" href="../../../../../../devel/api/sardana/taurus/core/tango/sardana/pool.html#sardana.taurus.core.tango.sardana.pool.unregisterExtensions">[docs]</a><span class="k">def</span> <span class="nf">unregisterExtensions</span><span class="p">():</span>
    <span class="n">factory</span> <span class="o">=</span> <span class="n">Factory</span><span class="p">()</span>
    <span class="n">factory</span><span class="o">.</span><span class="n">unregisterDeviceClass</span><span class="p">(</span><span class="s2">&quot;Pool&quot;</span><span class="p">)</span>

    <span class="n">hw_type_names</span> <span class="o">=</span> <span class="p">[</span>
        <span class="s1">&#39;Controller&#39;</span><span class="p">,</span>
        <span class="s1">&#39;ComChannel&#39;</span><span class="p">,</span> <span class="s1">&#39;Motor&#39;</span><span class="p">,</span> <span class="s1">&#39;PseudoMotor&#39;</span><span class="p">,</span> <span class="s1">&#39;TriggerGate&#39;</span><span class="p">,</span>
        <span class="s1">&#39;CTExpChannel&#39;</span><span class="p">,</span> <span class="s1">&#39;ZeroDExpChannel&#39;</span><span class="p">,</span> <span class="s1">&#39;OneDExpChannel&#39;</span><span class="p">,</span> <span class="s1">&#39;TwoDExpChannel&#39;</span><span class="p">,</span>
        <span class="s1">&#39;PseudoCounter&#39;</span><span class="p">,</span> <span class="s1">&#39;IORegister&#39;</span><span class="p">,</span> <span class="s1">&#39;MotorGroup&#39;</span><span class="p">,</span> <span class="s1">&#39;MeasurementGroup&#39;</span><span class="p">]</span>

    <span class="k">for</span> <span class="n">klass_name</span> <span class="ow">in</span> <span class="n">hw_type_names</span><span class="p">:</span>
        <span class="n">factory</span><span class="o">.</span><span class="n">unregisterDeviceClass</span><span class="p">(</span><span class="n">klass_name</span><span class="p">)</span></div>
</pre></div>

           </div>
           
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright Except where otherwise noted, content on this site is
licensed under a Creative Commons Attribution 3.0 License

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>