

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>sardana.tango.pool.Pool &mdash; sardana 3.0.2-alpha documentation</title>
  

  
  <link rel="stylesheet" href="../../../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../../../_static/graphviz.css" type="text/css" />

  
  
  
  

  
  <!--[if lt IE 9]>
    <script src="../../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../../../" src="../../../../_static/documentation_options.js"></script>
        <script src="../../../../_static/jquery.js"></script>
        <script src="../../../../_static/underscore.js"></script>
        <script src="../../../../_static/doctools.js"></script>
        <script src="../../../../_static/language_data.js"></script>
    
    <script type="text/javascript" src="../../../../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../search.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../../../index.html" class="icon icon-home" alt="Documentation Home"> sardana
          

          
            
            <img src="../../../../_static/logo.png" class="logo" alt="Logo"/>
          
          </a>

          
            
            
              <div class="version">
                3.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul>
<li class="toctree-l1"><a class="reference external" href="http://www.sardana-controls.org">Home Page</a></li>
<li class="toctree-l1"><a class="reference external" href="https://github.com/sardana-org/sardana">Project Page</a></li>
<li class="toctree-l1"><a class="reference external" href="http://pypi.python.org/pypi/sardana">Download from PyPI</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../docs.html">Documentation</a></li>
<li class="toctree-l1"><a class="reference external" href="http://github.com/sardana-org/sardana-plugins">Plugins Catalogue</a></li>
<li class="toctree-l1"><a class="reference external" href="http://github.com/sardana-org/sardana/wiki">Wiki</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../../index.html">sardana</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../../../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="../../../index.html">Module code</a> &raquo;</li>
        
      <li>sardana.tango.pool.Pool</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <h1>Source code for sardana.tango.pool.Pool</h1><div class="highlight"><pre>
<span></span><span class="ch">#!/usr/bin/env python</span>

<span class="c1">##############################################################################</span>
<span class="c1">##</span>
<span class="c1"># This file is part of Sardana</span>
<span class="c1">##</span>
<span class="c1"># http://www.sardana-controls.org/</span>
<span class="c1">##</span>
<span class="c1"># Copyright 2011 CELLS / ALBA Synchrotron, Bellaterra, Spain</span>
<span class="c1">##</span>
<span class="c1"># Sardana is free software: you can redistribute it and/or modify</span>
<span class="c1"># it under the terms of the GNU Lesser General Public License as published by</span>
<span class="c1"># the Free Software Foundation, either version 3 of the License, or</span>
<span class="c1"># (at your option) any later version.</span>
<span class="c1">##</span>
<span class="c1"># Sardana is distributed in the hope that it will be useful,</span>
<span class="c1"># but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
<span class="c1"># MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span>
<span class="c1"># GNU Lesser General Public License for more details.</span>
<span class="c1">##</span>
<span class="c1"># You should have received a copy of the GNU Lesser General Public License</span>
<span class="c1"># along with Sardana.  If not, see &lt;http://www.gnu.org/licenses/&gt;.</span>
<span class="c1">##</span>
<span class="c1">##############################################################################</span>

<span class="sd">&quot;&quot;&quot; &quot;&quot;&quot;</span>

<span class="n">__all__</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Pool&quot;</span><span class="p">,</span> <span class="s2">&quot;PoolClass&quot;</span><span class="p">]</span>

<span class="n">__docformat__</span> <span class="o">=</span> <span class="s1">&#39;restructuredtext&#39;</span>

<span class="kn">import</span> <span class="nn">json</span>
<span class="kn">import</span> <span class="nn">operator</span>
<span class="kn">import</span> <span class="nn">os.path</span>

<span class="kn">import</span> <span class="nn">PyTango</span>

<span class="kn">from</span> <span class="nn">taurus</span> <span class="kn">import</span> <span class="n">Factory</span>
<span class="kn">from</span> <span class="nn">taurus.core.util.containers</span> <span class="kn">import</span> <span class="n">CaselessDict</span>
<span class="kn">from</span> <span class="nn">taurus.core.util.codecs</span> <span class="kn">import</span> <span class="n">CodecFactory</span>
<span class="kn">from</span> <span class="nn">taurus.core.util.log</span> <span class="kn">import</span> <span class="n">Logger</span><span class="p">,</span> <span class="n">DebugIt</span>

<span class="kn">from</span> <span class="nn">sardana</span> <span class="kn">import</span> <span class="n">State</span><span class="p">,</span> <span class="n">SardanaServer</span><span class="p">,</span> <span class="n">ElementType</span><span class="p">,</span> <span class="n">Interface</span><span class="p">,</span> \
    <span class="n">TYPE_ACQUIRABLE_ELEMENTS</span><span class="p">,</span> <span class="n">TYPE_PSEUDO_ELEMENTS</span>
<span class="kn">from</span> <span class="nn">sardana.pool.pool</span> <span class="kn">import</span> <span class="n">Pool</span> <span class="k">as</span> <span class="n">POOL</span>
<span class="kn">from</span> <span class="nn">sardana.pool.poolmetacontroller</span> <span class="kn">import</span> <span class="n">TYPE_MAP_OBJ</span>
<span class="kn">from</span> <span class="nn">sardana.tango.core.util</span> <span class="kn">import</span> <span class="n">get_tango_version_number</span>
<span class="kn">import</span> <span class="nn">collections</span>


<div class="viewcode-block" id="Pool"><a class="viewcode-back" href="../../../../devel/api/sardana/tango/pool/Pool.html#sardana.tango.pool.Pool.Pool">[docs]</a><span class="k">class</span> <span class="nc">Pool</span><span class="p">(</span><span class="n">PyTango</span><span class="o">.</span><span class="n">Device_4Impl</span><span class="p">,</span> <span class="n">Logger</span><span class="p">):</span>

    <span class="n">ElementsCache</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cl</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
        <span class="n">PyTango</span><span class="o">.</span><span class="n">Device_4Impl</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cl</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
        <span class="n">Logger</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">init</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">init_device</span><span class="p">()</span>

<div class="viewcode-block" id="Pool.init"><a class="viewcode-back" href="../../../../devel/api/sardana/tango/pool/Pool.html#sardana.tango.pool.Pool.Pool.init">[docs]</a>    <span class="k">def</span> <span class="nf">init</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">full_name</span><span class="p">):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">db</span> <span class="o">=</span> <span class="n">Factory</span><span class="p">()</span><span class="o">.</span><span class="n">getDatabase</span><span class="p">()</span>
            <span class="n">alias</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">get_alias</span><span class="p">(</span><span class="n">full_name</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">alias</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="s1">&#39;nada&#39;</span><span class="p">:</span>
                <span class="n">alias</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="n">alias</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="k">if</span> <span class="n">alias</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">alias</span> <span class="o">=</span> <span class="n">PyTango</span><span class="o">.</span><span class="n">Util</span><span class="o">.</span><span class="n">instance</span><span class="p">()</span><span class="o">.</span><span class="n">get_ds_inst_name</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_pool</span> <span class="o">=</span> <span class="n">POOL</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_full_name</span><span class="p">(),</span> <span class="n">alias</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_pool</span><span class="o">.</span><span class="n">add_listener</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">on_pool_changed</span><span class="p">)</span></div>

<div class="viewcode-block" id="Pool.get_full_name"><a class="viewcode-back" href="../../../../devel/api/sardana/tango/pool/Pool.html#sardana.tango.pool.Pool.Pool.get_full_name">[docs]</a>    <span class="k">def</span> <span class="nf">get_full_name</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Compose full name from the TANGO_HOST information and device name.</span>

<span class="sd">        In case Sardana is used with Taurus 3 the full name is of format</span>
<span class="sd">        &quot;dbhost:dbport/&lt;domain&gt;/&lt;family&gt;/&lt;member&gt;&quot; where dbhost may be either</span>
<span class="sd">        FQDN or PQDN, depending on the TANGO_HOST configuration.</span>

<span class="sd">        In case Sardana is used with Taurus 4 the full name is of format</span>
<span class="sd">        &quot;tango://dbhost:dbport/&lt;domain&gt;/&lt;family&gt;/&lt;member&gt;&quot; where dbhost is</span>
<span class="sd">        always FQDN.</span>

<span class="sd">        :return: this device full name</span>
<span class="sd">        :rtype: :obj:`str`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">db</span> <span class="o">=</span> <span class="n">PyTango</span><span class="o">.</span><span class="n">Util</span><span class="o">.</span><span class="n">instance</span><span class="p">()</span><span class="o">.</span><span class="n">get_database</span><span class="p">()</span>
        <span class="n">db_name</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">get_db_host</span><span class="p">()</span> <span class="o">+</span> <span class="s2">&quot;:&quot;</span> <span class="o">+</span> <span class="n">db</span><span class="o">.</span><span class="n">get_db_port</span><span class="p">()</span>
        <span class="c1"># try to use Taurus 4 to retrieve FQDN</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="kn">from</span> <span class="nn">taurus.core.tango.tangovalidator</span> <span class="kn">import</span> \
                <span class="n">TangoAuthorityNameValidator</span>
            <span class="n">db_name</span> <span class="o">=</span> <span class="s2">&quot;//</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">db_name</span>
            <span class="n">db_name</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">TangoAuthorityNameValidator</span><span class="p">()</span><span class="o">.</span><span class="n">getNames</span><span class="p">(</span><span class="n">db_name</span><span class="p">)</span>
        <span class="c1"># if Taurus3 in use just continue</span>
        <span class="k">except</span> <span class="ne">ImportError</span><span class="p">:</span>
            <span class="k">pass</span>
        <span class="n">full_name</span> <span class="o">=</span> <span class="n">db_name</span> <span class="o">+</span> <span class="s2">&quot;/&quot;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_name</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">full_name</span></div>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">pool</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_pool</span>

<div class="viewcode-block" id="Pool.delete_device"><a class="viewcode-back" href="../../../../devel/api/sardana/tango/pool/Pool.html#sardana.tango.pool.Pool.Pool.delete_device">[docs]</a>    <span class="nd">@DebugIt</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">delete_device</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># self.pool.monitor.pause()</span>
        <span class="k">pass</span></div>

<div class="viewcode-block" id="Pool.init_device"><a class="viewcode-back" href="../../../../devel/api/sardana/tango/pool/Pool.html#sardana.tango.pool.Pool.Pool.init_device">[docs]</a>    <span class="nd">@DebugIt</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">init_device</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_state</span><span class="p">(</span><span class="n">PyTango</span><span class="o">.</span><span class="n">DevState</span><span class="o">.</span><span class="n">INIT</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">get_device_properties</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_device_class</span><span class="p">())</span>
        <span class="n">p</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pool</span>
        <span class="n">p</span><span class="o">.</span><span class="n">set_python_path</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">PythonPath</span><span class="p">)</span>
        <span class="n">p</span><span class="o">.</span><span class="n">set_path</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">PoolPath</span><span class="p">)</span>
        <span class="n">p</span><span class="o">.</span><span class="n">set_motion_loop_sleep_time</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">MotionLoop_SleepTime</span> <span class="o">/</span> <span class="mi">1000</span><span class="p">)</span>
        <span class="n">p</span><span class="o">.</span><span class="n">set_motion_loop_states_per_position</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">MotionLoop_StatesPerPosition</span><span class="p">)</span>
        <span class="n">p</span><span class="o">.</span><span class="n">set_acq_loop_sleep_time</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">AcqLoop_SleepTime</span> <span class="o">/</span> <span class="mi">1000</span><span class="p">)</span>
        <span class="n">p</span><span class="o">.</span><span class="n">set_acq_loop_states_per_value</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">AcqLoop_StatesPerValue</span><span class="p">)</span>
        <span class="n">p</span><span class="o">.</span><span class="n">set_drift_correction</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">DriftCorrection</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">RemoteLog</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">p</span><span class="o">.</span><span class="n">clear_remote_logging</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">h_p</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">RemoteLog</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;:&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">h_p</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                    <span class="n">host</span> <span class="o">=</span> <span class="n">h_p</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                    <span class="n">port</span> <span class="o">=</span> <span class="kc">None</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">host</span><span class="p">,</span> <span class="n">port</span> <span class="o">=</span> <span class="n">h_p</span>
                    <span class="n">port</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">port</span><span class="p">)</span>
                <span class="n">p</span><span class="o">.</span><span class="n">init_remote_logging</span><span class="p">(</span><span class="n">host</span><span class="o">=</span><span class="n">host</span><span class="p">,</span> <span class="n">port</span><span class="o">=</span><span class="n">port</span><span class="p">)</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;Invalid property value for &#39;RemoteLog&#39;: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span>
                             <span class="bp">self</span><span class="o">.</span><span class="n">RemoteLog</span><span class="p">)</span>
                <span class="n">p</span><span class="o">.</span><span class="n">clear_remote_logging</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_recalculate_instruments</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">attr</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_device_class</span><span class="p">()</span><span class="o">.</span><span class="n">attr_list</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">attr</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">&quot;list&quot;</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">set_change_event</span><span class="p">(</span><span class="n">attr</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_change_event</span><span class="p">(</span><span class="s2">&quot;State&quot;</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_change_event</span><span class="p">(</span><span class="s2">&quot;Status&quot;</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_change_event</span><span class="p">(</span><span class="s2">&quot;Elements&quot;</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
        <span class="c1"># hold the monitor thread for now!</span>
        <span class="c1"># self.pool.monitor.resume()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_state</span><span class="p">(</span><span class="n">PyTango</span><span class="o">.</span><span class="n">DevState</span><span class="o">.</span><span class="n">ON</span><span class="p">)</span></div>

    <span class="k">def</span> <span class="nf">_recalculate_instruments</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">il</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">InstrumentList</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">InstrumentList</span><span class="p">)</span>
        <span class="n">p</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pool</span>
        <span class="n">instruments</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">get_element_type_map</span><span class="p">()</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">ElementType</span><span class="o">.</span><span class="n">Instrument</span><span class="p">,</span> <span class="p">{})</span>
        <span class="n">ids</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">il</span><span class="p">),</span> <span class="mi">3</span><span class="p">):</span>
            <span class="n">iklass</span><span class="p">,</span> <span class="n">iname</span><span class="p">,</span> <span class="n">iid</span> <span class="o">=</span> <span class="n">il</span><span class="p">[</span><span class="n">i</span><span class="p">:</span><span class="n">i</span> <span class="o">+</span> <span class="mi">3</span><span class="p">]</span>
            <span class="n">iid</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">iid</span><span class="p">)</span>
            <span class="n">ids</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">iid</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">iid</span> <span class="ow">in</span> <span class="n">instruments</span><span class="p">:</span>
                <span class="c1"># TODO make sure the instrument didn&#39;t change</span>
                <span class="k">pass</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">p</span><span class="o">.</span><span class="n">create_instrument</span><span class="p">(</span><span class="n">iname</span><span class="p">,</span> <span class="n">iklass</span><span class="p">,</span> <span class="nb">id</span><span class="o">=</span><span class="n">iid</span><span class="p">)</span>

    <span class="c1">#@DebugIt()</span>
<div class="viewcode-block" id="Pool.always_executed_hook"><a class="viewcode-back" href="../../../../devel/api/sardana/tango/pool/Pool.html#sardana.tango.pool.Pool.Pool.always_executed_hook">[docs]</a>    <span class="k">def</span> <span class="nf">always_executed_hook</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">pass</span></div>

    <span class="c1">#@DebugIt()</span>
    <span class="k">def</span> <span class="nf">read_attr_hardware</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
        <span class="k">pass</span>

    <span class="c1">#@DebugIt()</span>
<div class="viewcode-block" id="Pool.read_ControllerLibList"><a class="viewcode-back" href="../../../../devel/api/sardana/tango/pool/Pool.html#sardana.tango.pool.Pool.Pool.read_ControllerLibList">[docs]</a>    <span class="k">def</span> <span class="nf">read_ControllerLibList</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">attr</span><span class="p">):</span>
        <span class="n">info</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pool</span><span class="o">.</span><span class="n">get_elements_str_info</span><span class="p">(</span><span class="n">ElementType</span><span class="o">.</span><span class="n">ControllerLibrary</span><span class="p">)</span>
        <span class="n">attr</span><span class="o">.</span><span class="n">set_value</span><span class="p">(</span><span class="n">info</span><span class="p">)</span></div>

    <span class="c1">#@DebugIt()</span>
<div class="viewcode-block" id="Pool.read_ControllerClassList"><a class="viewcode-back" href="../../../../devel/api/sardana/tango/pool/Pool.html#sardana.tango.pool.Pool.Pool.read_ControllerClassList">[docs]</a>    <span class="k">def</span> <span class="nf">read_ControllerClassList</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">attr</span><span class="p">):</span>
        <span class="n">info</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pool</span><span class="o">.</span><span class="n">get_elements_str_info</span><span class="p">(</span><span class="n">ElementType</span><span class="o">.</span><span class="n">ControllerClass</span><span class="p">)</span>
        <span class="n">attr</span><span class="o">.</span><span class="n">set_value</span><span class="p">(</span><span class="n">info</span><span class="p">)</span></div>

    <span class="c1">#@PyTango.DebugIt(show_args=True,show_ret=True)</span>
<div class="viewcode-block" id="Pool.read_ControllerList"><a class="viewcode-back" href="../../../../devel/api/sardana/tango/pool/Pool.html#sardana.tango.pool.Pool.Pool.read_ControllerList">[docs]</a>    <span class="k">def</span> <span class="nf">read_ControllerList</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">attr</span><span class="p">):</span>
        <span class="n">info</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pool</span><span class="o">.</span><span class="n">get_elements_str_info</span><span class="p">(</span><span class="n">ElementType</span><span class="o">.</span><span class="n">Controller</span><span class="p">)</span>
        <span class="n">attr</span><span class="o">.</span><span class="n">set_value</span><span class="p">(</span><span class="n">info</span><span class="p">)</span></div>

<div class="viewcode-block" id="Pool.read_InstrumentList"><a class="viewcode-back" href="../../../../devel/api/sardana/tango/pool/Pool.html#sardana.tango.pool.Pool.Pool.read_InstrumentList">[docs]</a>    <span class="k">def</span> <span class="nf">read_InstrumentList</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">attr</span><span class="p">):</span>
        <span class="c1">#instruments = self._pool.get_elements_by_type(ElementType.Instrument)</span>
        <span class="c1">#instrument_names = map(PoolInstrument.get_full_name, instruments)</span>
        <span class="c1"># attr.set_value(instrument_names)</span>
        <span class="n">info</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pool</span><span class="o">.</span><span class="n">get_elements_str_info</span><span class="p">(</span><span class="n">ElementType</span><span class="o">.</span><span class="n">Instrument</span><span class="p">)</span>
        <span class="n">attr</span><span class="o">.</span><span class="n">set_value</span><span class="p">(</span><span class="n">info</span><span class="p">)</span></div>

    <span class="c1">#@DebugIt()</span>
<div class="viewcode-block" id="Pool.read_ExpChannelList"><a class="viewcode-back" href="../../../../devel/api/sardana/tango/pool/Pool.html#sardana.tango.pool.Pool.Pool.read_ExpChannelList">[docs]</a>    <span class="k">def</span> <span class="nf">read_ExpChannelList</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">attr</span><span class="p">):</span>
        <span class="n">info</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">info</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pool</span><span class="o">.</span><span class="n">get_elements_str_info</span><span class="p">(</span><span class="n">ElementType</span><span class="o">.</span><span class="n">CTExpChannel</span><span class="p">))</span>
        <span class="n">info</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pool</span><span class="o">.</span><span class="n">get_elements_str_info</span><span class="p">(</span>
            <span class="n">ElementType</span><span class="o">.</span><span class="n">ZeroDExpChannel</span><span class="p">))</span>
        <span class="n">info</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pool</span><span class="o">.</span><span class="n">get_elements_str_info</span><span class="p">(</span>
            <span class="n">ElementType</span><span class="o">.</span><span class="n">OneDExpChannel</span><span class="p">))</span>
        <span class="n">info</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pool</span><span class="o">.</span><span class="n">get_elements_str_info</span><span class="p">(</span>
            <span class="n">ElementType</span><span class="o">.</span><span class="n">TwoDExpChannel</span><span class="p">))</span>
        <span class="n">info</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pool</span><span class="o">.</span><span class="n">get_elements_str_info</span><span class="p">(</span><span class="n">ElementType</span><span class="o">.</span><span class="n">PseudoCounter</span><span class="p">))</span>
        <span class="n">attr</span><span class="o">.</span><span class="n">set_value</span><span class="p">(</span><span class="n">info</span><span class="p">)</span></div>

    <span class="c1">#@DebugIt()</span>
<div class="viewcode-block" id="Pool.read_AcqChannelList"><a class="viewcode-back" href="../../../../devel/api/sardana/tango/pool/Pool.html#sardana.tango.pool.Pool.Pool.read_AcqChannelList">[docs]</a>    <span class="k">def</span> <span class="nf">read_AcqChannelList</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">attr</span><span class="p">):</span>
        <span class="n">info</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pool</span><span class="o">.</span><span class="n">get_acquisition_elements_str_info</span><span class="p">()</span>
        <span class="n">attr</span><span class="o">.</span><span class="n">set_value</span><span class="p">(</span><span class="n">info</span><span class="p">)</span></div>

    <span class="c1">#@DebugIt()</span>
<div class="viewcode-block" id="Pool.read_MotorGroupList"><a class="viewcode-back" href="../../../../devel/api/sardana/tango/pool/Pool.html#sardana.tango.pool.Pool.Pool.read_MotorGroupList">[docs]</a>    <span class="k">def</span> <span class="nf">read_MotorGroupList</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">attr</span><span class="p">):</span>
        <span class="n">info</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pool</span><span class="o">.</span><span class="n">get_elements_str_info</span><span class="p">(</span><span class="n">ElementType</span><span class="o">.</span><span class="n">MotorGroup</span><span class="p">)</span>
        <span class="n">attr</span><span class="o">.</span><span class="n">set_value</span><span class="p">(</span><span class="n">info</span><span class="p">)</span></div>

    <span class="c1">#@DebugIt()</span>
<div class="viewcode-block" id="Pool.read_MotorList"><a class="viewcode-back" href="../../../../devel/api/sardana/tango/pool/Pool.html#sardana.tango.pool.Pool.Pool.read_MotorList">[docs]</a>    <span class="k">def</span> <span class="nf">read_MotorList</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">attr</span><span class="p">):</span>
        <span class="n">info</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pool</span><span class="o">.</span><span class="n">get_elements_str_info</span><span class="p">(</span><span class="n">ElementType</span><span class="o">.</span><span class="n">Motor</span><span class="p">)</span>
        <span class="n">info</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pool</span><span class="o">.</span><span class="n">get_elements_str_info</span><span class="p">(</span><span class="n">ElementType</span><span class="o">.</span><span class="n">PseudoMotor</span><span class="p">))</span>
        <span class="n">attr</span><span class="o">.</span><span class="n">set_value</span><span class="p">(</span><span class="n">info</span><span class="p">)</span></div>

    <span class="c1">#@DebugIt()</span>
<div class="viewcode-block" id="Pool.read_TriggerGateList"><a class="viewcode-back" href="../../../../devel/api/sardana/tango/pool/Pool.html#sardana.tango.pool.Pool.Pool.read_TriggerGateList">[docs]</a>    <span class="k">def</span> <span class="nf">read_TriggerGateList</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">attr</span><span class="p">):</span>
        <span class="n">info</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pool</span><span class="o">.</span><span class="n">get_elements_str_info</span><span class="p">(</span><span class="n">ElementType</span><span class="o">.</span><span class="n">TriggerGate</span><span class="p">)</span>
        <span class="n">attr</span><span class="o">.</span><span class="n">set_value</span><span class="p">(</span><span class="n">info</span><span class="p">)</span></div>

    <span class="c1">#@DebugIt()</span>
<div class="viewcode-block" id="Pool.read_MeasurementGroupList"><a class="viewcode-back" href="../../../../devel/api/sardana/tango/pool/Pool.html#sardana.tango.pool.Pool.Pool.read_MeasurementGroupList">[docs]</a>    <span class="k">def</span> <span class="nf">read_MeasurementGroupList</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">attr</span><span class="p">):</span>
        <span class="n">info</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pool</span><span class="o">.</span><span class="n">get_elements_str_info</span><span class="p">(</span><span class="n">ElementType</span><span class="o">.</span><span class="n">MeasurementGroup</span><span class="p">)</span>
        <span class="n">attr</span><span class="o">.</span><span class="n">set_value</span><span class="p">(</span><span class="n">info</span><span class="p">)</span></div>

    <span class="c1">#@DebugIt()</span>
<div class="viewcode-block" id="Pool.read_IORegisterList"><a class="viewcode-back" href="../../../../devel/api/sardana/tango/pool/Pool.html#sardana.tango.pool.Pool.Pool.read_IORegisterList">[docs]</a>    <span class="k">def</span> <span class="nf">read_IORegisterList</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">attr</span><span class="p">):</span>
        <span class="n">info</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pool</span><span class="o">.</span><span class="n">get_elements_str_info</span><span class="p">(</span><span class="n">ElementType</span><span class="o">.</span><span class="n">IORegister</span><span class="p">)</span>
        <span class="n">attr</span><span class="o">.</span><span class="n">set_value</span><span class="p">(</span><span class="n">info</span><span class="p">)</span></div>

    <span class="c1">#@DebugIt()</span>
<div class="viewcode-block" id="Pool.read_ComChannelList"><a class="viewcode-back" href="../../../../devel/api/sardana/tango/pool/Pool.html#sardana.tango.pool.Pool.Pool.read_ComChannelList">[docs]</a>    <span class="k">def</span> <span class="nf">read_ComChannelList</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">attr</span><span class="p">):</span>
        <span class="n">info</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pool</span><span class="o">.</span><span class="n">get_elements_str_info</span><span class="p">(</span><span class="n">ElementType</span><span class="o">.</span><span class="n">Communication</span><span class="p">)</span>
        <span class="n">attr</span><span class="o">.</span><span class="n">set_value</span><span class="p">(</span><span class="n">info</span><span class="p">)</span></div>

    <span class="c1">#@DebugIt()</span>
<div class="viewcode-block" id="Pool.getElements"><a class="viewcode-back" href="../../../../devel/api/sardana/tango/pool/Pool.html#sardana.tango.pool.Pool.Pool.getElements">[docs]</a>    <span class="k">def</span> <span class="nf">getElements</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cache</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="n">value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ElementsCache</span>
        <span class="k">if</span> <span class="n">cache</span> <span class="ow">and</span> <span class="n">value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">value</span>
        <span class="n">value</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">new</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">pool</span><span class="o">.</span><span class="n">get_elements_info</span><span class="p">())</span>
        <span class="n">value</span> <span class="o">=</span> <span class="n">CodecFactory</span><span class="p">()</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s1">&#39;utf8_json&#39;</span><span class="p">,</span> <span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">value</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ElementsCache</span> <span class="o">=</span> <span class="n">value</span>
        <span class="k">return</span> <span class="n">value</span></div>

    <span class="c1">#@DebugIt()</span>
<div class="viewcode-block" id="Pool.read_Elements"><a class="viewcode-back" href="../../../../devel/api/sardana/tango/pool/Pool.html#sardana.tango.pool.Pool.Pool.read_Elements">[docs]</a>    <span class="k">def</span> <span class="nf">read_Elements</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">attr</span><span class="p">):</span>
        <span class="n">element_list</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getElements</span><span class="p">()</span>
        <span class="n">attr</span><span class="o">.</span><span class="n">set_value</span><span class="p">(</span><span class="o">*</span><span class="n">element_list</span><span class="p">)</span></div>

<div class="viewcode-block" id="Pool.is_Elements_allowed"><a class="viewcode-back" href="../../../../devel/api/sardana/tango/pool/Pool.html#sardana.tango.pool.Pool.Pool.is_Elements_allowed">[docs]</a>    <span class="k">def</span> <span class="nf">is_Elements_allowed</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">req_type</span><span class="p">):</span>
        <span class="k">return</span> <span class="kc">True</span>
        <span class="k">return</span> <span class="n">SardanaServer</span><span class="o">.</span><span class="n">server_state</span> <span class="o">==</span> <span class="n">State</span><span class="o">.</span><span class="n">Running</span></div>

    <span class="n">is_ControllerLibList_allowed</span> <span class="o">=</span> \
        <span class="n">is_ControllerClassList_allowed</span> <span class="o">=</span> \
        <span class="n">is_ControllerList_allowed</span> <span class="o">=</span> \
        <span class="n">is_InstrumentList_allowed</span> <span class="o">=</span> \
        <span class="n">is_ExpChannelList_allowed</span> <span class="o">=</span> \
        <span class="n">is_TriggerGateList_allowed</span> <span class="o">=</span> \
        <span class="n">is_AcqChannelList_allowed</span> <span class="o">=</span> \
        <span class="n">is_MotorGroupList_allowed</span> <span class="o">=</span> \
        <span class="n">is_MotorList_allowed</span> <span class="o">=</span> \
        <span class="n">is_MeasurementGroupList_allowed</span> <span class="o">=</span> \
        <span class="n">is_IORegisterList_allowed</span> <span class="o">=</span> \
        <span class="n">is_ComChannelList_allowed</span> <span class="o">=</span> <span class="n">is_Elements_allowed</span>

    <span class="k">def</span> <span class="nf">_get_interface_ids</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">interface</span><span class="p">,</span> <span class="n">elem_names</span><span class="p">):</span>
        <span class="n">_pool</span><span class="p">,</span> <span class="n">motor_ids</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pool</span><span class="p">,</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">elem_name</span> <span class="ow">in</span> <span class="n">elem_names</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">element</span> <span class="o">=</span> <span class="n">_pool</span><span class="o">.</span><span class="n">get_element_by_name</span><span class="p">(</span><span class="n">elem_name</span><span class="p">)</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="n">element</span> <span class="o">=</span> <span class="n">_pool</span><span class="o">.</span><span class="n">get_element_by_full_name</span><span class="p">(</span><span class="n">elem_name</span><span class="p">)</span>
            <span class="n">elem_interface</span> <span class="o">=</span> <span class="n">element</span><span class="o">.</span><span class="n">get_interface</span><span class="p">()</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">Interface</span><span class="o">.</span><span class="n">Moveable</span> <span class="o">&amp;</span> <span class="n">elem_interface</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%s</span><span class="s2"> is a </span><span class="si">%s</span><span class="s2">. It MUST be a moveable&quot;</span>
                                <span class="o">%</span> <span class="p">(</span><span class="n">element</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">Interface</span><span class="p">[</span><span class="n">elem_interface</span><span class="p">]))</span>
            <span class="n">motor_ids</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">element</span><span class="o">.</span><span class="n">id</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">motor_ids</span>

    <span class="k">def</span> <span class="nf">_get_moveable_ids</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">elem_names</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_interface_ids</span><span class="p">(</span><span class="n">Interface</span><span class="o">.</span><span class="n">Moveable</span><span class="p">,</span> <span class="n">elem_names</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_get_acquirable_ids</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">elem_names</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_interface_ids</span><span class="p">(</span><span class="n">Interface</span><span class="o">.</span><span class="n">Acquirable</span><span class="p">,</span> <span class="n">elem_names</span><span class="p">)</span>

    <span class="c1">#@DebugIt()</span>
<div class="viewcode-block" id="Pool.CreateController"><a class="viewcode-back" href="../../../../devel/api/sardana/tango/pool/Pool.html#sardana.tango.pool.Pool.Pool.CreateController">[docs]</a>    <span class="k">def</span> <span class="nf">CreateController</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">argin</span><span class="p">):</span>
        <span class="n">kwargs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_format_CreateController_arguments</span><span class="p">(</span><span class="n">argin</span><span class="p">)</span>
        <span class="c1"># TODO: Support in future sequence of elements</span>
        <span class="n">kwargs</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

        <span class="n">type_str</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]</span>
        <span class="n">lib</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;library&#39;</span><span class="p">]</span>
        <span class="n">class_name</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;klass&#39;</span><span class="p">]</span>
        <span class="n">name</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span>
        <span class="n">properties</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;properties&#39;</span><span class="p">]</span>
        <span class="n">elem_type</span> <span class="o">=</span> <span class="n">ElementType</span><span class="p">[</span><span class="n">type_str</span><span class="p">]</span>
        <span class="n">mod_name</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">splitext</span><span class="p">(</span><span class="n">lib</span><span class="p">)</span>
        <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;module&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">mod_name</span>

        <span class="n">td</span> <span class="o">=</span> <span class="n">TYPE_MAP_OBJ</span><span class="p">[</span><span class="n">ElementType</span><span class="o">.</span><span class="n">Controller</span><span class="p">]</span>
        <span class="n">auto_full_name</span> <span class="o">=</span> <span class="n">td</span><span class="o">.</span><span class="n">auto_full_name</span>
        <span class="n">ctrl_class</span> <span class="o">=</span> <span class="n">td</span><span class="o">.</span><span class="n">ctrl_klass</span>

        <span class="n">full_name</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;full_name&quot;</span><span class="p">,</span> <span class="n">auto_full_name</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">))</span>
        <span class="n">util</span> <span class="o">=</span> <span class="n">PyTango</span><span class="o">.</span><span class="n">Util</span><span class="o">.</span><span class="n">instance</span><span class="p">()</span>

        <span class="c1"># check that element doesn&#39;t exist yet</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check_element</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">full_name</span><span class="p">)</span>

        <span class="c1"># check library exists</span>
        <span class="n">ctrl_manager</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pool</span><span class="o">.</span><span class="n">ctrl_manager</span>
        <span class="n">mod_name</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">splitext</span><span class="p">(</span><span class="n">lib</span><span class="p">)</span>
        <span class="n">ctrl_lib</span> <span class="o">=</span> <span class="n">ctrl_manager</span><span class="o">.</span><span class="n">getControllerLib</span><span class="p">(</span><span class="n">mod_name</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">ctrl_lib</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;Controller library &#39;</span><span class="si">%s</span><span class="s2">&#39; not found&quot;</span> <span class="o">%</span> <span class="n">lib</span><span class="p">)</span>

        <span class="c1"># check class exists</span>
        <span class="n">ctrl_class</span> <span class="o">=</span> <span class="n">ctrl_lib</span><span class="o">.</span><span class="n">get_controller</span><span class="p">(</span><span class="n">class_name</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">ctrl_class</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;Controller class &#39;</span><span class="si">%s</span><span class="s2">&#39; not found in &#39;</span><span class="si">%s</span><span class="s2">&#39;&quot;</span>
                            <span class="o">%</span> <span class="p">(</span><span class="n">class_name</span><span class="p">,</span> <span class="n">lib</span><span class="p">))</span>

        <span class="c1"># check that class type matches the required type</span>
        <span class="k">if</span> <span class="n">elem_type</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">ctrl_class</span><span class="o">.</span><span class="n">types</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;Controller class &#39;</span><span class="si">%s</span><span class="s2">&#39; does not implement &#39;</span><span class="si">%s</span><span class="s2">&#39; &quot;</span>
                            <span class="s2">&quot;interface&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">class_name</span><span class="p">,</span> <span class="n">type_str</span><span class="p">))</span>

        <span class="c1"># check that necessary property values are set</span>
        <span class="k">for</span> <span class="n">prop_name</span><span class="p">,</span> <span class="n">prop_info</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">ctrl_class</span><span class="o">.</span><span class="n">ctrl_properties</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
            <span class="n">prop_value</span> <span class="o">=</span> <span class="n">properties</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">prop_name</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">prop_value</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">prop_info</span><span class="o">.</span><span class="n">default_value</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;Controller class &#39;</span><span class="si">%s</span><span class="s2">&#39; needs property &#39;</span><span class="si">%s</span><span class="s2">&#39;&quot;</span>
                                    <span class="o">%</span> <span class="p">(</span><span class="n">class_name</span><span class="p">,</span> <span class="n">prop_name</span><span class="p">))</span>
                <span class="n">properties</span><span class="p">[</span><span class="n">prop_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">prop_info</span><span class="o">.</span><span class="n">default_value</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">properties</span><span class="p">[</span><span class="n">prop_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">prop_value</span>

        <span class="c1"># for pseudo motor check that motors are given</span>
        <span class="k">if</span> <span class="n">elem_type</span> <span class="o">==</span> <span class="n">ElementType</span><span class="o">.</span><span class="n">PseudoMotor</span><span class="p">:</span>
            <span class="n">klass_roles</span> <span class="o">=</span> <span class="n">ctrl_class</span><span class="o">.</span><span class="n">controller_class</span><span class="o">.</span><span class="n">motor_roles</span>
            <span class="n">klass_pseudo_roles</span> <span class="o">=</span> <span class="n">ctrl_class</span><span class="o">.</span><span class="n">controller_class</span><span class="o">.</span><span class="n">pseudo_motor_roles</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">len</span><span class="p">(</span><span class="n">klass_pseudo_roles</span><span class="p">):</span>
                <span class="n">klass_pseudo_roles</span> <span class="o">=</span> <span class="n">class_name</span><span class="p">,</span>
            <span class="n">roles</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;roles&#39;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">roles</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;Pseudo motor controller class </span><span class="si">%s</span><span class="s2"> needs motors &quot;</span>
                                <span class="s2">&quot;for roles: </span><span class="si">%s</span><span class="s2"> and pseudo roles: </span><span class="si">%s</span><span class="s2">&quot;</span>
                                <span class="o">%</span> <span class="p">(</span><span class="n">class_name</span><span class="p">,</span> <span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">klass_roles</span><span class="p">),</span>
                                   <span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">klass_pseudo_roles</span><span class="p">)))</span>
            <span class="n">motor_ids</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">klass_role</span> <span class="ow">in</span> <span class="n">klass_roles</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">klass_role</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">roles</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;Pseudo motor controller class &#39;</span><span class="si">%s</span><span class="s2">&#39; needs &quot;</span>
                                    <span class="s2">&quot;motor(s) for role(s) </span><span class="si">%s</span><span class="s2">&quot;</span>
                                    <span class="o">%</span> <span class="p">(</span><span class="n">class_name</span><span class="p">,</span> <span class="n">klass_role</span><span class="p">))</span>
                <span class="n">motor_name</span> <span class="o">=</span> <span class="n">roles</span><span class="p">[</span><span class="n">klass_role</span><span class="p">]</span>
                <span class="n">motor_ids</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_get_moveable_ids</span><span class="p">((</span><span class="n">motor_name</span><span class="p">,)))</span>
            <span class="n">properties</span><span class="p">[</span><span class="s1">&#39;motor_role_ids&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">motor_ids</span>

            <span class="n">pseudo_motor_infos</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="n">pseudo_motor_ids</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">klass_pseudo_role</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">klass_pseudo_roles</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">klass_pseudo_role</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">roles</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;Pseudo motor controller class &#39;</span><span class="si">%s</span><span class="s2">&#39; needs &quot;</span>
                                    <span class="s2">&quot;pseudo motor name for role &#39;</span><span class="si">%s</span><span class="s2">&#39;&quot;</span>
                                    <span class="o">%</span> <span class="p">(</span><span class="n">class_name</span><span class="p">,</span> <span class="n">klass_pseudo_role</span><span class="p">))</span>
                <span class="n">pm_id</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pool</span><span class="o">.</span><span class="n">get_new_id</span><span class="p">()</span>
                <span class="n">pm_name</span> <span class="o">=</span> <span class="n">roles</span><span class="p">[</span><span class="n">klass_pseudo_role</span><span class="p">]</span>
                <span class="n">info</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">pm_id</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">pm_name</span><span class="p">,</span> <span class="n">ctrl_name</span><span class="o">=</span><span class="n">name</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span>
                            <span class="nb">type</span><span class="o">=</span><span class="s1">&#39;PseudoMotor&#39;</span><span class="p">,</span> <span class="n">elements</span><span class="o">=</span><span class="n">motor_ids</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">pm_name</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">n</span><span class="p">,</span> <span class="n">fn</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">str</span><span class="o">.</span><span class="n">strip</span><span class="p">,</span> <span class="n">pm_name</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)))</span>
                    <span class="n">info</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">],</span> <span class="n">info</span><span class="p">[</span><span class="s1">&#39;full_name&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">n</span><span class="p">,</span> <span class="n">fn</span>
                <span class="n">pseudo_motor_infos</span><span class="p">[</span><span class="n">klass_pseudo_role</span><span class="p">]</span> <span class="o">=</span> <span class="n">info</span>
                <span class="n">pseudo_motor_ids</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pm_id</span><span class="p">)</span>
            <span class="n">properties</span><span class="p">[</span><span class="s1">&#39;pseudo_motor_role_ids&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pseudo_motor_ids</span>
        <span class="c1"># for pseudo counter check counters are given</span>
        <span class="k">elif</span> <span class="n">elem_type</span> <span class="o">==</span> <span class="n">ElementType</span><span class="o">.</span><span class="n">PseudoCounter</span><span class="p">:</span>
            <span class="n">klass_roles</span> <span class="o">=</span> <span class="n">ctrl_class</span><span class="o">.</span><span class="n">controller_class</span><span class="o">.</span><span class="n">counter_roles</span>
            <span class="n">klass_pseudo_roles</span> <span class="o">=</span> <span class="n">ctrl_class</span><span class="o">.</span><span class="n">controller_class</span><span class="o">.</span><span class="n">pseudo_counter_roles</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">len</span><span class="p">(</span><span class="n">klass_pseudo_roles</span><span class="p">):</span>
                <span class="n">klass_pseudo_roles</span> <span class="o">=</span> <span class="n">class_name</span><span class="p">,</span>
            <span class="n">roles</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;roles&#39;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">roles</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;Pseudo counter controller class &#39;</span><span class="si">%s</span><span class="s2">&#39; needs &quot;</span>
                                <span class="s2">&quot;counter(s) for role(s): </span><span class="si">%s</span><span class="s2"> and pseudo &quot;</span>
                                <span class="s2">&quot;role(s): </span><span class="si">%s</span><span class="s2">&quot;</span>
                                <span class="o">%</span> <span class="p">(</span><span class="n">class_name</span><span class="p">,</span> <span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">klass_roles</span><span class="p">),</span>
                                   <span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">klass_pseudo_roles</span><span class="p">)))</span>
            <span class="n">counter_ids</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">klass_role</span> <span class="ow">in</span> <span class="n">klass_roles</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">klass_role</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">roles</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;Pseudo counter controller class &#39;</span><span class="si">%s</span><span class="s2">&#39; &quot;</span>
                                    <span class="s2">&quot;needs counter name for role &#39;</span><span class="si">%s</span><span class="s2">&#39;&quot;</span>
                                    <span class="o">%</span> <span class="p">(</span><span class="n">class_name</span><span class="p">,</span> <span class="n">klass_role</span><span class="p">))</span>
                <span class="n">counter_name</span> <span class="o">=</span> <span class="n">roles</span><span class="p">[</span><span class="n">klass_role</span><span class="p">]</span>
                <span class="n">counter_ids</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_get_acquirable_ids</span><span class="p">((</span><span class="n">counter_name</span><span class="p">,)))</span>
            <span class="n">properties</span><span class="p">[</span><span class="s1">&#39;counter_role_ids&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">counter_ids</span>

            <span class="n">pseudo_counter_infos</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="n">pseudo_counter_ids</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">klass_pseudo_role</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">klass_pseudo_roles</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">klass_pseudo_role</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">roles</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;Pseudo counter controller class </span><span class="si">%s</span><span class="s2"> needs &quot;</span>
                                    <span class="s2">&quot;pseudo motor name for role </span><span class="si">%s</span><span class="s2">&quot;</span>
                                    <span class="o">%</span> <span class="p">(</span><span class="n">class_name</span><span class="p">,</span> <span class="n">klass_pseudo_role</span><span class="p">))</span>
                <span class="n">pc_id</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pool</span><span class="o">.</span><span class="n">get_new_id</span><span class="p">()</span>
                <span class="n">pc_name</span> <span class="o">=</span> <span class="n">roles</span><span class="p">[</span><span class="n">klass_pseudo_role</span><span class="p">]</span>
                <span class="n">info</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">pc_id</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">pc_name</span><span class="p">,</span> <span class="n">ctrl_name</span><span class="o">=</span><span class="n">name</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span>
                            <span class="nb">type</span><span class="o">=</span><span class="s1">&#39;PseudoCounter&#39;</span><span class="p">,</span> <span class="n">elements</span><span class="o">=</span><span class="n">counter_ids</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">pc_name</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">n</span><span class="p">,</span> <span class="n">fn</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">str</span><span class="o">.</span><span class="n">strip</span><span class="p">,</span> <span class="n">pc_name</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)))</span>
                    <span class="n">info</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">],</span> <span class="n">info</span><span class="p">[</span><span class="s1">&#39;full_name&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">n</span><span class="p">,</span> <span class="n">fn</span>
                <span class="n">pseudo_counter_infos</span><span class="p">[</span><span class="n">klass_pseudo_role</span><span class="p">]</span> <span class="o">=</span> <span class="n">info</span>
                <span class="n">pseudo_counter_ids</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pc_id</span><span class="p">)</span>
            <span class="n">properties</span><span class="p">[</span><span class="s1">&#39;pseudo_counter_role_ids&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pseudo_counter_ids</span>

        <span class="n">properties</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">type_str</span>
        <span class="n">properties</span><span class="p">[</span><span class="s1">&#39;library&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">lib</span>
        <span class="n">properties</span><span class="p">[</span><span class="s1">&#39;klass&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">class_name</span>

        <span class="k">def</span> <span class="nf">create_controller_cb</span><span class="p">(</span><span class="n">device_name</span><span class="p">):</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">db</span> <span class="o">=</span> <span class="n">util</span><span class="o">.</span><span class="n">get_database</span><span class="p">()</span>
                <span class="c1">#types = [ pool.ElementType.whatis(t) for t in ctrl.get_ctrl_types() ]</span>
                <span class="n">properties</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pool</span><span class="o">.</span><span class="n">get_new_id</span><span class="p">()</span>
                <span class="n">db</span><span class="o">.</span><span class="n">put_device_property</span><span class="p">(</span><span class="n">device_name</span><span class="p">,</span> <span class="n">properties</span><span class="p">)</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;Unexpected error in controller creation callback&quot;</span><span class="p">,</span>
                             <span class="n">exc_info</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
                <span class="k">raise</span>

        <span class="n">util</span><span class="o">.</span><span class="n">create_device</span><span class="p">(</span><span class="s1">&#39;Controller&#39;</span><span class="p">,</span> <span class="n">full_name</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span>
                           <span class="n">cb</span><span class="o">=</span><span class="n">create_controller_cb</span><span class="p">)</span>

        <span class="c1"># Determine which controller writtable attributes have default value</span>
        <span class="c1"># and apply them to the newly created controller</span>
        <span class="n">attrs</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">attr_name</span><span class="p">,</span> <span class="n">attr_info</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">ctrl_class</span><span class="o">.</span><span class="n">ctrl_attributes</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
            <span class="n">default_value</span> <span class="o">=</span> <span class="n">attr_info</span><span class="o">.</span><span class="n">default_value</span>
            <span class="k">if</span> <span class="n">default_value</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">continue</span>
            <span class="n">attrs</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">attr_name</span><span class="p">,</span> <span class="n">default_value</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">attrs</span><span class="p">:</span>
            <span class="n">ctrl_proxy</span> <span class="o">=</span> <span class="n">PyTango</span><span class="o">.</span><span class="n">DeviceProxy</span><span class="p">(</span><span class="n">full_name</span><span class="p">)</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">ctrl_proxy</span><span class="o">.</span><span class="n">write_attributes</span><span class="p">(</span><span class="n">attrs</span><span class="p">)</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;Error trying to write controller default value &quot;</span>
                             <span class="s2">&quot;for attribute(s)&quot;</span><span class="p">,</span> <span class="n">exc_info</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

        <span class="c1"># for pseudo motor/counter controller also create pseudo</span>
        <span class="c1"># motor(s)/counter(s) automatically</span>
        <span class="k">if</span> <span class="n">elem_type</span> <span class="o">==</span> <span class="n">ElementType</span><span class="o">.</span><span class="n">PseudoMotor</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">pseudo_motor_info</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">pseudo_motor_infos</span><span class="o">.</span><span class="n">values</span><span class="p">()):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_create_single_element</span><span class="p">(</span><span class="n">pseudo_motor_info</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">elem_type</span> <span class="o">==</span> <span class="n">ElementType</span><span class="o">.</span><span class="n">PseudoCounter</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">pseudo_counter_info</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">pseudo_counter_infos</span><span class="o">.</span><span class="n">values</span><span class="p">()):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_create_single_element</span><span class="p">(</span><span class="n">pseudo_counter_info</span><span class="p">)</span></div>

    <span class="c1">#@DebugIt()</span>
<div class="viewcode-block" id="Pool.CreateInstrument"><a class="viewcode-back" href="../../../../devel/api/sardana/tango/pool/Pool.html#sardana.tango.pool.Pool.Pool.CreateInstrument">[docs]</a>    <span class="k">def</span> <span class="nf">CreateInstrument</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">argin</span><span class="p">):</span>
        <span class="n">instrument</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pool</span><span class="o">.</span><span class="n">create_instrument</span><span class="p">(</span><span class="o">*</span><span class="n">argin</span><span class="p">)</span>
        <span class="n">instrument_list</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">InstrumentList</span>
        <span class="c1"># update database property</span>
        <span class="n">instrument_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">instrument</span><span class="o">.</span><span class="n">instrument_class</span><span class="p">)</span>
        <span class="n">instrument_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">instrument</span><span class="o">.</span><span class="n">full_name</span><span class="p">)</span>
        <span class="n">instrument_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">instrument</span><span class="o">.</span><span class="n">id</span><span class="p">)</span>
        <span class="n">db</span> <span class="o">=</span> <span class="n">PyTango</span><span class="o">.</span><span class="n">Util</span><span class="o">.</span><span class="n">instance</span><span class="p">()</span><span class="o">.</span><span class="n">get_database</span><span class="p">()</span>
        <span class="n">props</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;InstrumentList&#39;</span><span class="p">:</span> <span class="n">instrument_list</span><span class="p">}</span>
        <span class="n">db</span><span class="o">.</span><span class="n">put_device_property</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_name</span><span class="p">(),</span> <span class="n">props</span><span class="p">)</span></div>

    <span class="c1">#@DebugIt()</span>
<div class="viewcode-block" id="Pool.CreateElement"><a class="viewcode-back" href="../../../../devel/api/sardana/tango/pool/Pool.html#sardana.tango.pool.Pool.Pool.CreateElement">[docs]</a>    <span class="k">def</span> <span class="nf">CreateElement</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">argin</span><span class="p">):</span>
        <span class="n">kwargs_seq</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_format_CreateElement_arguments</span><span class="p">(</span><span class="n">argin</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">kwargs</span> <span class="ow">in</span> <span class="n">kwargs_seq</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_create_single_element</span><span class="p">(</span><span class="n">kwargs</span><span class="p">)</span></div>

<div class="viewcode-block" id="Pool.RenameElement"><a class="viewcode-back" href="../../../../devel/api/sardana/tango/pool/Pool.html#sardana.tango.pool.Pool.Pool.RenameElement">[docs]</a>    <span class="k">def</span> <span class="nf">RenameElement</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">argin</span><span class="p">):</span>
        <span class="n">old_name</span> <span class="o">=</span> <span class="n">argin</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">new_name</span> <span class="o">=</span> <span class="n">argin</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pool</span><span class="o">.</span><span class="n">rename_element</span><span class="p">(</span><span class="n">old_name</span><span class="p">,</span> <span class="n">new_name</span><span class="p">)</span>
        <span class="c1"># obtain normal name (without database) and apply new alias</span>
        <span class="n">element</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pool</span><span class="o">.</span><span class="n">get_element_by_name</span><span class="p">(</span><span class="n">new_name</span><span class="p">)</span>
        <span class="n">db</span> <span class="o">=</span> <span class="n">PyTango</span><span class="o">.</span><span class="n">Util</span><span class="o">.</span><span class="n">instance</span><span class="p">()</span><span class="o">.</span><span class="n">get_database</span><span class="p">()</span>
        <span class="n">normal_name</span> <span class="o">=</span> <span class="s1">&#39;/&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">element</span><span class="o">.</span><span class="n">full_name</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">)[</span><span class="o">-</span><span class="mi">3</span><span class="p">:])</span>
        <span class="n">db</span><span class="o">.</span><span class="n">put_device_alias</span><span class="p">(</span><span class="n">normal_name</span><span class="p">,</span> <span class="n">new_name</span><span class="p">)</span></div>

    <span class="k">def</span> <span class="nf">_create_single_element</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">):</span>
        <span class="n">elem_type_str</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]</span>
        <span class="n">ctrl_name</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;ctrl_name&#39;</span><span class="p">]</span>
        <span class="n">axis</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;axis&#39;</span><span class="p">]</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">elem_type</span> <span class="o">=</span> <span class="n">ElementType</span><span class="p">[</span><span class="n">elem_type_str</span><span class="p">]</span>
        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;Unknown element type &#39;</span><span class="si">%s</span><span class="s2">&#39;&quot;</span> <span class="o">%</span> <span class="n">elem_type_str</span><span class="p">)</span>
        <span class="n">name</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span>

        <span class="n">td</span> <span class="o">=</span> <span class="n">TYPE_MAP_OBJ</span><span class="p">[</span><span class="n">elem_type</span><span class="p">]</span>
        <span class="n">auto_full_name</span> <span class="o">=</span> <span class="n">td</span><span class="o">.</span><span class="n">auto_full_name</span>

        <span class="n">full_name</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;full_name&quot;</span><span class="p">,</span> <span class="n">auto_full_name</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">))</span>

        <span class="n">ctrl</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pool</span><span class="o">.</span><span class="n">get_element</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">ctrl_name</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">ctrl</span><span class="o">.</span><span class="n">get_type</span><span class="p">()</span> <span class="o">!=</span> <span class="n">ElementType</span><span class="o">.</span><span class="n">Controller</span><span class="p">:</span>
            <span class="n">type_str</span> <span class="o">=</span> <span class="n">ElementType</span><span class="o">.</span><span class="n">whatis</span><span class="p">(</span><span class="n">ctrl</span><span class="o">.</span><span class="n">get_type</span><span class="p">())</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;&#39;</span><span class="si">%s</span><span class="s2">&#39; is not a controller (It is a </span><span class="si">%s</span><span class="s2">)&quot;</span> <span class="o">%</span>
                            <span class="p">(</span><span class="n">ctrl_name</span><span class="p">,</span> <span class="n">type_str</span><span class="p">))</span>

        <span class="n">ctrl_types</span> <span class="o">=</span> <span class="n">ctrl</span><span class="o">.</span><span class="n">get_ctrl_types</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">elem_type</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">ctrl_types</span><span class="p">:</span>
            <span class="n">ctrl_type_str</span> <span class="o">=</span> <span class="n">ElementType</span><span class="o">.</span><span class="n">whatis</span><span class="p">(</span><span class="n">ctrl_types</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;Cannot create </span><span class="si">%s</span><span class="s2"> in </span><span class="si">%s</span><span class="s2"> controller&quot;</span> <span class="o">%</span>
                            <span class="p">(</span><span class="nb">type</span><span class="p">,</span> <span class="n">ctrl_type_str</span><span class="p">))</span>

        <span class="n">elem_axis</span> <span class="o">=</span> <span class="n">ctrl</span><span class="o">.</span><span class="n">get_element</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="n">axis</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">elem_axis</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;Controller already contains axis </span><span class="si">%d</span><span class="s2"> (</span><span class="si">%s</span><span class="s2">)&quot;</span> <span class="o">%</span>
                            <span class="p">(</span><span class="n">axis</span><span class="p">,</span> <span class="n">elem_axis</span><span class="o">.</span><span class="n">get_name</span><span class="p">()))</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_check_element</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">full_name</span><span class="p">)</span>

        <span class="n">util</span> <span class="o">=</span> <span class="n">PyTango</span><span class="o">.</span><span class="n">Util</span><span class="o">.</span><span class="n">instance</span><span class="p">()</span>

        <span class="k">def</span> <span class="nf">create_element_cb</span><span class="p">(</span><span class="n">device_name</span><span class="p">):</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">db</span> <span class="o">=</span> <span class="n">util</span><span class="o">.</span><span class="n">get_database</span><span class="p">()</span>
                <span class="n">data</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">pool</span><span class="o">.</span><span class="n">get_new_id</span><span class="p">(),</span>
                        <span class="s2">&quot;ctrl_id&quot;</span><span class="p">:</span> <span class="n">ctrl</span><span class="o">.</span><span class="n">get_id</span><span class="p">(),</span> <span class="s2">&quot;axis&quot;</span><span class="p">:</span> <span class="n">axis</span><span class="p">,</span> <span class="p">}</span>
                <span class="k">if</span> <span class="n">elem_type</span> <span class="ow">in</span> <span class="n">TYPE_PSEUDO_ELEMENTS</span><span class="p">:</span>
                    <span class="n">data</span><span class="p">[</span><span class="s1">&#39;elements&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;elements&#39;</span><span class="p">]</span>

                <span class="n">db</span><span class="o">.</span><span class="n">put_device_property</span><span class="p">(</span><span class="n">device_name</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>

                <span class="n">data</span> <span class="o">=</span> <span class="p">{}</span>
                <span class="k">if</span> <span class="n">elem_type</span> <span class="o">==</span> <span class="n">ElementType</span><span class="o">.</span><span class="n">Motor</span><span class="p">:</span>
                    <span class="n">data</span><span class="p">[</span><span class="s2">&quot;position&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;abs_change&quot;</span><span class="p">:</span> <span class="s2">&quot;1.0&quot;</span><span class="p">}</span>
                    <span class="n">data</span><span class="p">[</span><span class="s2">&quot;dialposition&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;abs_change&quot;</span><span class="p">:</span> <span class="s2">&quot;5.0&quot;</span><span class="p">}</span>
                <span class="k">elif</span> <span class="n">elem_type</span> <span class="o">==</span> <span class="n">ElementType</span><span class="o">.</span><span class="n">CTExpChannel</span><span class="p">:</span>
                    <span class="n">data</span><span class="p">[</span><span class="s2">&quot;value&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;abs_change&quot;</span><span class="p">:</span> <span class="s2">&quot;1.0&quot;</span><span class="p">}</span>
                <span class="k">elif</span> <span class="n">elem_type</span> <span class="o">==</span> <span class="n">ElementType</span><span class="o">.</span><span class="n">PseudoMotor</span><span class="p">:</span>
                    <span class="n">data</span><span class="p">[</span><span class="s2">&quot;position&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;abs_change&quot;</span><span class="p">:</span> <span class="s2">&quot;1.0&quot;</span><span class="p">}</span>
                <span class="k">elif</span> <span class="n">elem_type</span> <span class="o">==</span> <span class="n">ElementType</span><span class="o">.</span><span class="n">PseudoCounter</span><span class="p">:</span>
                    <span class="n">data</span><span class="p">[</span><span class="s2">&quot;value&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;abs_change&quot;</span><span class="p">:</span> <span class="s2">&quot;1.0&quot;</span><span class="p">}</span>
                <span class="k">elif</span> <span class="n">elem_type</span> <span class="o">==</span> <span class="n">ElementType</span><span class="o">.</span><span class="n">IORegister</span><span class="p">:</span>
                    <span class="c1"># this may be not correct when Value is of type bool or str</span>
                    <span class="c1"># but apparently this callback nevers sets a value in the</span>
                    <span class="c1"># database at the time of adding the #458 (github)</span>
                    <span class="n">data</span><span class="p">[</span><span class="s2">&quot;value&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;abs_change&quot;</span><span class="p">:</span> <span class="s2">&quot;1&quot;</span><span class="p">}</span>
                <span class="n">db</span><span class="o">.</span><span class="n">put_device_attribute_property</span><span class="p">(</span><span class="n">device_name</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="kn">import</span> <span class="nn">traceback</span>
                <span class="n">traceback</span><span class="o">.</span><span class="n">print_exc</span><span class="p">()</span>

        <span class="n">util</span><span class="o">.</span><span class="n">create_device</span><span class="p">(</span><span class="n">elem_type_str</span><span class="p">,</span> <span class="n">full_name</span><span class="p">,</span>
                           <span class="n">name</span><span class="p">,</span> <span class="n">cb</span><span class="o">=</span><span class="n">create_element_cb</span><span class="p">)</span>

        <span class="c1"># Hack to register event abs change until tango bug #3151801 is solved</span>
        <span class="n">elem_proxy</span> <span class="o">=</span> <span class="n">PyTango</span><span class="o">.</span><span class="n">DeviceProxy</span><span class="p">(</span><span class="n">full_name</span><span class="p">)</span>
        <span class="n">cfg</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="n">elem_type</span> <span class="o">==</span> <span class="n">ElementType</span><span class="o">.</span><span class="n">Motor</span><span class="p">:</span>
            <span class="n">attr</span> <span class="o">=</span> <span class="n">elem_proxy</span><span class="o">.</span><span class="n">get_attribute_config_ex</span><span class="p">(</span><span class="s2">&quot;position&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">attr</span><span class="o">.</span><span class="n">events</span><span class="o">.</span><span class="n">ch_event</span><span class="o">.</span><span class="n">abs_change</span> <span class="o">=</span> <span class="s2">&quot;1&quot;</span>
            <span class="n">cfg</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">attr</span><span class="p">)</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">attr</span> <span class="o">=</span> <span class="n">elem_proxy</span><span class="o">.</span><span class="n">get_attribute_config_ex</span><span class="p">(</span><span class="s2">&quot;dialposition&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
                <span class="n">attr</span><span class="o">.</span><span class="n">events</span><span class="o">.</span><span class="n">ch_event</span><span class="o">.</span><span class="n">abs_change</span> <span class="o">=</span> <span class="s2">&quot;5.0&quot;</span>
                <span class="n">cfg</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">attr</span><span class="p">)</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="k">pass</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">get_tango_version_number</span><span class="p">()</span> <span class="o">&lt;</span> <span class="mi">80000</span><span class="p">:</span>
                    <span class="n">attr</span> <span class="o">=</span> <span class="n">elem_proxy</span><span class="o">.</span><span class="n">get_attribute_config_ex</span><span class="p">(</span><span class="s2">&quot;limit_switches&quot;</span><span class="p">)[</span>
                        <span class="mi">0</span><span class="p">]</span>
                    <span class="n">attr</span><span class="o">.</span><span class="n">events</span><span class="o">.</span><span class="n">ch_event</span><span class="o">.</span><span class="n">abs_change</span> <span class="o">=</span> <span class="s2">&quot;1&quot;</span>
                    <span class="n">cfg</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">attr</span><span class="p">)</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="k">pass</span>
        <span class="k">elif</span> <span class="n">elem_type</span> <span class="o">==</span> <span class="n">ElementType</span><span class="o">.</span><span class="n">CTExpChannel</span><span class="p">:</span>
            <span class="n">attr</span> <span class="o">=</span> <span class="n">elem_proxy</span><span class="o">.</span><span class="n">get_attribute_config_ex</span><span class="p">(</span><span class="s2">&quot;value&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">attr</span><span class="o">.</span><span class="n">events</span><span class="o">.</span><span class="n">ch_event</span><span class="o">.</span><span class="n">abs_change</span> <span class="o">=</span> <span class="s2">&quot;1.0&quot;</span>
            <span class="n">cfg</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">attr</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">elem_type</span> <span class="o">==</span> <span class="n">ElementType</span><span class="o">.</span><span class="n">ZeroDExpChannel</span><span class="p">:</span>
            <span class="n">attr</span> <span class="o">=</span> <span class="n">elem_proxy</span><span class="o">.</span><span class="n">get_attribute_config_ex</span><span class="p">(</span><span class="s2">&quot;value&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">attr</span><span class="o">.</span><span class="n">events</span><span class="o">.</span><span class="n">ch_event</span><span class="o">.</span><span class="n">abs_change</span> <span class="o">=</span> <span class="s2">&quot;1.0&quot;</span>
            <span class="n">cfg</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">attr</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">elem_type</span> <span class="o">==</span> <span class="n">ElementType</span><span class="o">.</span><span class="n">PseudoMotor</span><span class="p">:</span>
            <span class="n">attr</span> <span class="o">=</span> <span class="n">elem_proxy</span><span class="o">.</span><span class="n">get_attribute_config_ex</span><span class="p">(</span><span class="s2">&quot;position&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">attr</span><span class="o">.</span><span class="n">events</span><span class="o">.</span><span class="n">ch_event</span><span class="o">.</span><span class="n">abs_change</span> <span class="o">=</span> <span class="s2">&quot;1&quot;</span>
            <span class="n">cfg</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">attr</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">elem_type</span> <span class="o">==</span> <span class="n">ElementType</span><span class="o">.</span><span class="n">PseudoCounter</span><span class="p">:</span>
            <span class="n">attr</span> <span class="o">=</span> <span class="n">elem_proxy</span><span class="o">.</span><span class="n">get_attribute_config_ex</span><span class="p">(</span><span class="s2">&quot;value&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">attr</span><span class="o">.</span><span class="n">events</span><span class="o">.</span><span class="n">ch_event</span><span class="o">.</span><span class="n">abs_change</span> <span class="o">=</span> <span class="s2">&quot;1&quot;</span>
            <span class="n">cfg</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">attr</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">elem_type</span> <span class="o">==</span> <span class="n">ElementType</span><span class="o">.</span><span class="n">IORegister</span><span class="p">:</span>
            <span class="n">attr</span> <span class="o">=</span> <span class="n">elem_proxy</span><span class="o">.</span><span class="n">get_attribute_config_ex</span><span class="p">(</span><span class="s2">&quot;value&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">attr</span><span class="o">.</span><span class="n">data_type</span> <span class="o">!=</span> <span class="n">PyTango</span><span class="o">.</span><span class="n">DevBoolean</span><span class="p">:</span>
                <span class="n">attr</span><span class="o">.</span><span class="n">events</span><span class="o">.</span><span class="n">ch_event</span><span class="o">.</span><span class="n">abs_change</span> <span class="o">=</span> <span class="s2">&quot;1&quot;</span>
            <span class="n">cfg</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">attr</span><span class="p">)</span>
        <span class="n">elem_proxy</span><span class="o">.</span><span class="n">set_attribute_config</span><span class="p">(</span><span class="n">cfg</span><span class="p">)</span>

        <span class="k">return</span>

        <span class="c1"># Determine which writtable attributes have default value and apply</span>
        <span class="c1"># them to the newly created element</span>
        <span class="n">ctrl_class_info</span> <span class="o">=</span> <span class="n">ctrl</span><span class="o">.</span><span class="n">get_ctrl_info</span><span class="p">()</span>
        <span class="n">attrs</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">attr_name</span><span class="p">,</span> <span class="n">attr_info</span> <span class="ow">in</span> \
                <span class="nb">list</span><span class="p">(</span><span class="n">ctrl_class_info</span><span class="o">.</span><span class="n">getAxisAttributes</span><span class="p">()</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
            <span class="n">default_value</span> <span class="o">=</span> <span class="n">attr_info</span><span class="o">.</span><span class="n">default_value</span>
            <span class="k">if</span> <span class="n">default_value</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">continue</span>
            <span class="n">attrs</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">attr_name</span><span class="p">,</span> <span class="n">default_value</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">attrs</span><span class="p">:</span>
            <span class="n">elem_proxy</span> <span class="o">=</span> <span class="n">PyTango</span><span class="o">.</span><span class="n">DeviceProxy</span><span class="p">(</span><span class="n">full_name</span><span class="p">)</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">elem_proxy</span><span class="o">.</span><span class="n">write_attributes</span><span class="p">(</span><span class="n">attrs</span><span class="p">)</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;Error trying to write default value for &quot;</span>
                             <span class="s2">&quot;attribute(s)&quot;</span><span class="p">,</span> <span class="n">exc_info</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

    <span class="c1">#@DebugIt()</span>
<div class="viewcode-block" id="Pool.CreateMotorGroup"><a class="viewcode-back" href="../../../../devel/api/sardana/tango/pool/Pool.html#sardana.tango.pool.Pool.Pool.CreateMotorGroup">[docs]</a>    <span class="k">def</span> <span class="nf">CreateMotorGroup</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">argin</span><span class="p">):</span>
        <span class="n">kwargs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_format_CreateMotorGroup_arguments</span><span class="p">(</span><span class="n">argin</span><span class="p">)</span>
        <span class="c1"># TODO: Support in future sequence of elements</span>
        <span class="n">kwargs</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

        <span class="n">util</span> <span class="o">=</span> <span class="n">PyTango</span><span class="o">.</span><span class="n">Util</span><span class="o">.</span><span class="n">instance</span><span class="p">()</span>

        <span class="n">name</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span>
        <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;pool_name&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pool</span><span class="o">.</span><span class="n">name</span>

        <span class="n">td</span> <span class="o">=</span> <span class="n">TYPE_MAP_OBJ</span><span class="p">[</span><span class="n">ElementType</span><span class="o">.</span><span class="n">MotorGroup</span><span class="p">]</span>
        <span class="n">auto_full_name</span> <span class="o">=</span> <span class="n">td</span><span class="o">.</span><span class="n">auto_full_name</span>

        <span class="n">full_name</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;full_name&quot;</span><span class="p">,</span> <span class="n">auto_full_name</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">))</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_check_element</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">full_name</span><span class="p">)</span>

        <span class="n">elem_ids</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_moveable_ids</span><span class="p">(</span><span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;elements&quot;</span><span class="p">])</span>

        <span class="k">def</span> <span class="nf">create_motgrp_cb</span><span class="p">(</span><span class="n">device_name</span><span class="p">):</span>
            <span class="n">db</span> <span class="o">=</span> <span class="n">util</span><span class="o">.</span><span class="n">get_database</span><span class="p">()</span>
            <span class="n">data</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">pool</span><span class="o">.</span><span class="n">get_new_id</span><span class="p">(),</span>
                    <span class="s2">&quot;elements&quot;</span><span class="p">:</span> <span class="n">elem_ids</span><span class="p">}</span>
            <span class="n">db</span><span class="o">.</span><span class="n">put_device_property</span><span class="p">(</span><span class="n">device_name</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>

            <span class="n">data</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="n">data</span><span class="p">[</span><span class="s2">&quot;position&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;abs_change&quot;</span><span class="p">:</span> <span class="s2">&quot;1.0&quot;</span><span class="p">}</span>

            <span class="n">db</span><span class="o">.</span><span class="n">put_device_attribute_property</span><span class="p">(</span><span class="n">device_name</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>

        <span class="n">util</span><span class="o">.</span><span class="n">create_device</span><span class="p">(</span><span class="s2">&quot;MotorGroup&quot;</span><span class="p">,</span> <span class="n">full_name</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">cb</span><span class="o">=</span><span class="n">create_motgrp_cb</span><span class="p">)</span></div>

    <span class="c1">#@DebugIt()</span>
<div class="viewcode-block" id="Pool.CreateMeasurementGroup"><a class="viewcode-back" href="../../../../devel/api/sardana/tango/pool/Pool.html#sardana.tango.pool.Pool.Pool.CreateMeasurementGroup">[docs]</a>    <span class="k">def</span> <span class="nf">CreateMeasurementGroup</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">argin</span><span class="p">):</span>
        <span class="n">kwargs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_format_CreateMeasurementGroup_arguments</span><span class="p">(</span><span class="n">argin</span><span class="p">)</span>
        <span class="c1"># TODO: Support in future sequence of elements</span>
        <span class="n">kwargs</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

        <span class="n">util</span> <span class="o">=</span> <span class="n">PyTango</span><span class="o">.</span><span class="n">Util</span><span class="o">.</span><span class="n">instance</span><span class="p">()</span>

        <span class="n">name</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span>
        <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;pool_name&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pool</span><span class="o">.</span><span class="n">name</span>

        <span class="n">td</span> <span class="o">=</span> <span class="n">TYPE_MAP_OBJ</span><span class="p">[</span><span class="n">ElementType</span><span class="o">.</span><span class="n">MeasurementGroup</span><span class="p">]</span>
        <span class="n">auto_full_name</span> <span class="o">=</span> <span class="n">td</span><span class="o">.</span><span class="n">auto_full_name</span>

        <span class="n">full_name</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;full_name&quot;</span><span class="p">,</span> <span class="n">auto_full_name</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">))</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_check_element</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">full_name</span><span class="p">)</span>

        <span class="n">elem_ids</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">elem_name</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;elements&quot;</span><span class="p">]:</span>
            <span class="c1"># if internal pool element (channel, motor, ioregister, etc) store</span>
            <span class="c1"># it&#39;s id</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">elem</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pool</span><span class="o">.</span><span class="n">get_element</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">elem_name</span><span class="p">)</span>
                <span class="n">elem_ids</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">elem</span><span class="o">.</span><span class="n">id</span><span class="p">)</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="c1"># otherwise assume a tango attribute/command</span>
                <span class="n">elem_ids</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">elem_name</span><span class="p">)</span>

        <span class="k">def</span> <span class="nf">create_mntgrp_cb</span><span class="p">(</span><span class="n">device_name</span><span class="p">):</span>
            <span class="n">db</span> <span class="o">=</span> <span class="n">util</span><span class="o">.</span><span class="n">get_database</span><span class="p">()</span>
            <span class="n">data</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">pool</span><span class="o">.</span><span class="n">get_new_id</span><span class="p">(),</span>
                    <span class="s2">&quot;elements&quot;</span><span class="p">:</span> <span class="n">elem_ids</span><span class="p">}</span>
            <span class="n">db</span><span class="o">.</span><span class="n">put_device_property</span><span class="p">(</span><span class="n">device_name</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>

            <span class="n">data</span> <span class="o">=</span> <span class="p">{}</span>

            <span class="n">db</span><span class="o">.</span><span class="n">put_device_attribute_property</span><span class="p">(</span><span class="n">device_name</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>

        <span class="n">util</span><span class="o">.</span><span class="n">create_device</span><span class="p">(</span><span class="s2">&quot;MeasurementGroup&quot;</span><span class="p">,</span> <span class="n">full_name</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span>
                           <span class="n">cb</span><span class="o">=</span><span class="n">create_mntgrp_cb</span><span class="p">)</span></div>

    <span class="k">def</span> <span class="nf">_check_element</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">full_name</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pool</span><span class="o">.</span><span class="n">check_element</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">full_name</span><span class="p">)</span>
        <span class="n">db</span> <span class="o">=</span> <span class="n">PyTango</span><span class="o">.</span><span class="n">Util</span><span class="o">.</span><span class="n">instance</span><span class="p">()</span><span class="o">.</span><span class="n">get_database</span><span class="p">()</span>
        <span class="n">e</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">db</span><span class="o">.</span><span class="n">import_device</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
            <span class="n">e</span> <span class="o">=</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;The tango alias &#39;</span><span class="si">%s</span><span class="s2">&#39; already exists&quot;</span> <span class="o">%</span> <span class="n">name</span><span class="p">)</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="k">pass</span>
        <span class="k">if</span> <span class="n">e</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">e</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">db</span><span class="o">.</span><span class="n">import_device</span><span class="p">(</span><span class="n">full_name</span><span class="p">)</span>
            <span class="n">e</span> <span class="o">=</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;The tango device &#39;</span><span class="si">%s</span><span class="s2">&#39; already exists&quot;</span> <span class="o">%</span> <span class="n">full_name</span><span class="p">)</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="k">pass</span>
        <span class="k">if</span> <span class="n">e</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">e</span>

<div class="viewcode-block" id="Pool.on_pool_changed"><a class="viewcode-back" href="../../../../devel/api/sardana/tango/pool/Pool.html#sardana.tango.pool.Pool.Pool.on_pool_changed">[docs]</a>    <span class="k">def</span> <span class="nf">on_pool_changed</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">evt_src</span><span class="p">,</span> <span class="n">evt_type</span><span class="p">,</span> <span class="n">evt_value</span><span class="p">):</span>
        <span class="c1"># during server startup and shutdown avoid processing element</span>
        <span class="c1"># creation events</span>
        <span class="k">if</span> <span class="n">SardanaServer</span><span class="o">.</span><span class="n">server_state</span> <span class="o">!=</span> <span class="n">State</span><span class="o">.</span><span class="n">Running</span><span class="p">:</span>
            <span class="k">return</span>

        <span class="n">evt_name</span> <span class="o">=</span> <span class="n">evt_type</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">evt_name</span> <span class="ow">in</span> <span class="p">(</span><span class="s2">&quot;elementcreated&quot;</span><span class="p">,</span> <span class="s2">&quot;elementdeleted&quot;</span><span class="p">,</span> <span class="s2">&quot;elementchanged&quot;</span><span class="p">):</span>
            <span class="n">elem</span> <span class="o">=</span> <span class="n">evt_value</span>
            <span class="n">elem_type</span> <span class="o">=</span> <span class="n">elem</span><span class="o">.</span><span class="n">get_type</span><span class="p">()</span>
            <span class="n">td</span> <span class="o">=</span> <span class="n">TYPE_MAP_OBJ</span><span class="p">[</span><span class="n">elem_type</span><span class="p">]</span>
            <span class="n">attribute_list_name</span> <span class="o">=</span> <span class="n">td</span><span class="o">.</span><span class="n">family</span> <span class="o">+</span> <span class="s2">&quot;List&quot;</span>
            <span class="n">info</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pool</span><span class="o">.</span><span class="n">get_elements_str_info</span><span class="p">(</span><span class="n">elem_type</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">push_change_event</span><span class="p">(</span><span class="n">attribute_list_name</span><span class="p">,</span> <span class="n">info</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">elem_type</span> <span class="ow">in</span> <span class="n">TYPE_ACQUIRABLE_ELEMENTS</span><span class="p">:</span>
                <span class="n">info</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pool</span><span class="o">.</span><span class="n">get_acquisition_elements_str_info</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">push_change_event</span><span class="p">(</span><span class="s1">&#39;AcqChannelList&#39;</span><span class="p">,</span> <span class="n">info</span><span class="p">)</span>

            <span class="c1"># force the element list cache to be rebuild next time someone reads</span>
            <span class="c1"># the element list</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ElementsCache</span> <span class="o">=</span> <span class="kc">None</span>

            <span class="n">value</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="k">if</span> <span class="n">evt_name</span> <span class="o">==</span> <span class="s2">&quot;elementcreated&quot;</span><span class="p">:</span>
                <span class="n">key</span> <span class="o">=</span> <span class="s1">&#39;new&#39;</span>
            <span class="k">elif</span> <span class="n">evt_name</span> <span class="o">==</span> <span class="s2">&quot;elementdeleted&quot;</span><span class="p">:</span>
                <span class="n">key</span> <span class="o">=</span> <span class="s1">&#39;del&#39;</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">key</span> <span class="o">=</span> <span class="s1">&#39;change&#39;</span>
            <span class="n">json_elem</span> <span class="o">=</span> <span class="n">elem</span><span class="o">.</span><span class="n">serialize</span><span class="p">(</span><span class="n">pool</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">pool</span><span class="o">.</span><span class="n">full_name</span><span class="p">)</span>
            <span class="n">value</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">json_elem</span><span class="p">,</span>
            <span class="n">value</span> <span class="o">=</span> <span class="n">CodecFactory</span><span class="p">()</span><span class="o">.</span><span class="n">getCodec</span><span class="p">(</span><span class="s1">&#39;utf8_json&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">encode</span><span class="p">((</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">value</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">push_change_event</span><span class="p">(</span><span class="s1">&#39;Elements&#39;</span><span class="p">,</span> <span class="o">*</span><span class="n">value</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">evt_name</span> <span class="o">==</span> <span class="s2">&quot;elementschanged&quot;</span><span class="p">:</span>
            <span class="c1"># force the element list cache to be rebuild next time someone reads</span>
            <span class="c1"># the element list</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ElementsCache</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="n">pool_name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pool</span><span class="o">.</span><span class="n">full_name</span>
            <span class="n">new_values</span><span class="p">,</span> <span class="n">changed_values</span><span class="p">,</span> <span class="n">deleted_values</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">elem</span> <span class="ow">in</span> <span class="n">evt_value</span><span class="p">[</span><span class="s1">&#39;new&#39;</span><span class="p">]:</span>
                <span class="n">json_elem</span> <span class="o">=</span> <span class="n">elem</span><span class="o">.</span><span class="n">serialize</span><span class="p">(</span><span class="n">pool</span><span class="o">=</span><span class="n">pool_name</span><span class="p">)</span>
                <span class="n">new_values</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">json_elem</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">elem</span> <span class="ow">in</span> <span class="n">evt_value</span><span class="p">[</span><span class="s1">&#39;change&#39;</span><span class="p">]:</span>
                <span class="n">json_elem</span> <span class="o">=</span> <span class="n">elem</span><span class="o">.</span><span class="n">serialize</span><span class="p">(</span><span class="n">pool</span><span class="o">=</span><span class="n">pool_name</span><span class="p">)</span>
                <span class="n">changed_values</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">json_elem</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">elem</span> <span class="ow">in</span> <span class="n">evt_value</span><span class="p">[</span><span class="s1">&#39;del&#39;</span><span class="p">]:</span>
                <span class="n">json_elem</span> <span class="o">=</span> <span class="n">elem</span><span class="o">.</span><span class="n">serialize</span><span class="p">(</span><span class="n">pool</span><span class="o">=</span><span class="n">pool_name</span><span class="p">)</span>
                <span class="n">deleted_values</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">json_elem</span><span class="p">)</span>
            <span class="n">value</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;new&quot;</span><span class="p">:</span> <span class="n">new_values</span><span class="p">,</span> <span class="s2">&quot;change&quot;</span><span class="p">:</span> <span class="n">changed_values</span><span class="p">,</span>
                     <span class="s2">&quot;del&quot;</span><span class="p">:</span> <span class="n">deleted_values</span><span class="p">}</span>
            <span class="n">value</span> <span class="o">=</span> <span class="n">CodecFactory</span><span class="p">()</span><span class="o">.</span><span class="n">getCodec</span><span class="p">(</span><span class="s1">&#39;utf8_json&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">encode</span><span class="p">((</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">value</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">push_change_event</span><span class="p">(</span><span class="s1">&#39;Elements&#39;</span><span class="p">,</span> <span class="o">*</span><span class="n">value</span><span class="p">)</span></div>

    <span class="k">def</span> <span class="nf">_format_create_json_arguments</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">argin</span><span class="p">):</span>
        <span class="n">elems</span><span class="p">,</span> <span class="n">ret</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">argin</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">elems</span><span class="p">,</span> <span class="n">collections</span><span class="o">.</span><span class="n">Mapping</span><span class="p">):</span>
            <span class="n">elems</span> <span class="o">=</span> <span class="p">[</span><span class="n">elems</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">elem</span> <span class="ow">in</span> <span class="n">elems</span><span class="p">:</span>
            <span class="n">d</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">elem</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
                <span class="n">d</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">)]</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
            <span class="n">ret</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">ret</span>

    <span class="k">def</span> <span class="nf">_format_CreateElement_arguments</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">argin</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">argin</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">msg</span> <span class="o">=</span> <span class="n">PoolClass</span><span class="o">.</span><span class="n">cmd_list</span><span class="p">[</span><span class="s2">&quot;CreateElement&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">argin</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_format_create_json_arguments</span><span class="p">(</span><span class="n">argin</span><span class="p">)</span>

        <span class="n">ret</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="n">argin</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;ctrl_name&#39;</span><span class="p">:</span> <span class="n">argin</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;axis&#39;</span><span class="p">:</span> <span class="nb">int</span><span class="p">(</span><span class="n">argin</span><span class="p">[</span><span class="mi">2</span><span class="p">]),</span>
               <span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="n">argin</span><span class="p">[</span><span class="mi">3</span><span class="p">]}</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">argin</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">4</span><span class="p">:</span>
            <span class="n">ret</span><span class="p">[</span><span class="s1">&#39;full_name&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">argin</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">ret</span><span class="p">]</span>

    <span class="k">def</span> <span class="nf">_format_CreateController_arguments</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">argin</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">argin</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">msg</span> <span class="o">=</span> <span class="n">PoolClass</span><span class="o">.</span><span class="n">cmd_list</span><span class="p">[</span><span class="s2">&quot;CreateController&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">argin</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">ret</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_format_create_json_arguments</span><span class="p">(</span><span class="n">argin</span><span class="p">)</span>
            <span class="k">if</span> <span class="s1">&#39;type&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">ret</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">KeyError</span><span class="p">(</span><span class="s2">&quot;Missing key &#39;type&#39;&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="s1">&#39;library&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">ret</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">KeyError</span><span class="p">(</span><span class="s2">&quot;Missing key &#39;library&#39;&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="s1">&#39;klass&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">ret</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">KeyError</span><span class="p">(</span><span class="s2">&quot;Missing key &#39;klass&#39;&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="s1">&#39;name&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">ret</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">KeyError</span><span class="p">(</span><span class="s2">&quot;Missing key &#39;name&#39;&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="s1">&#39;properties&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">ret</span><span class="p">:</span>
                <span class="n">ret</span><span class="p">[</span><span class="s1">&#39;properties&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">CaselessDict</span><span class="p">()</span>
            <span class="k">return</span> <span class="n">ret</span>

        <span class="n">ret</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="n">argin</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;library&#39;</span><span class="p">:</span> <span class="n">argin</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;klass&#39;</span><span class="p">:</span> <span class="n">argin</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span>
               <span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="n">argin</span><span class="p">[</span><span class="mi">3</span><span class="p">]}</span>

        <span class="n">i</span> <span class="o">=</span> <span class="mi">4</span>
        <span class="n">roles</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">arg</span> <span class="ow">in</span> <span class="n">argin</span><span class="p">[</span><span class="mi">4</span><span class="p">:]:</span>
            <span class="n">role_data</span> <span class="o">=</span> <span class="n">arg</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;=&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">role_data</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">:</span>
                <span class="k">break</span>
            <span class="n">role_name</span><span class="p">,</span> <span class="n">role_element</span> <span class="o">=</span> <span class="n">role_data</span>
            <span class="n">roles</span><span class="p">[</span><span class="n">role_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">role_element</span>
            <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">roles</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">ret</span><span class="p">[</span><span class="s1">&#39;roles&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">roles</span>

        <span class="n">p</span> <span class="o">=</span> <span class="n">argin</span><span class="p">[</span><span class="n">i</span><span class="p">:]</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">p</span><span class="p">)</span> <span class="o">%</span> <span class="mi">2</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;must give pair of property name, property value&quot;</span><span class="p">)</span>
        <span class="n">props</span> <span class="o">=</span> <span class="n">CaselessDict</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">::</span><span class="mi">2</span><span class="p">],</span> <span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">::</span><span class="mi">2</span><span class="p">]):</span>
            <span class="n">props</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
        <span class="n">ret</span><span class="p">[</span><span class="s1">&#39;properties&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">props</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">ret</span><span class="p">]</span>

    <span class="k">def</span> <span class="nf">_format_CreateMotorGroup_arguments</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">argin</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">argin</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">msg</span> <span class="o">=</span> <span class="n">PoolClass</span><span class="o">.</span><span class="n">cmd_list</span><span class="p">[</span><span class="s2">&quot;CreateMotorGroup&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">argin</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">ret</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">elems</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">argin</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="n">elems</span> <span class="o">=</span> <span class="n">argin</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">elems</span><span class="p">,</span> <span class="n">collections</span><span class="o">.</span><span class="n">Mapping</span><span class="p">):</span>
                <span class="n">elems</span> <span class="o">=</span> <span class="p">[</span><span class="n">elems</span><span class="p">]</span>
            <span class="k">for</span> <span class="n">elem</span> <span class="ow">in</span> <span class="n">elems</span><span class="p">:</span>
                <span class="n">d</span> <span class="o">=</span> <span class="p">{}</span>
                <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">elem</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
                    <span class="n">d</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">)]</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
                <span class="n">ret</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">ret</span>
        <span class="n">ret</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="n">argin</span><span class="p">[</span><span class="mi">0</span><span class="p">]}</span>
        <span class="k">if</span> <span class="n">argin</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
            <span class="n">ret</span><span class="p">[</span><span class="s1">&#39;full_name&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">argin</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
            <span class="k">del</span> <span class="n">argin</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">ret</span><span class="p">[</span><span class="s1">&#39;elements&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">argin</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">ret</span><span class="p">]</span>

    <span class="k">def</span> <span class="nf">_format_CreateMeasurementGroup_arguments</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">argin</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">argin</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">msg</span> <span class="o">=</span> <span class="n">PoolClass</span><span class="o">.</span><span class="n">cmd_list</span><span class="p">[</span><span class="s2">&quot;CreateMeasurementGroup&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">argin</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">ret</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">elems</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">argin</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="n">elems</span> <span class="o">=</span> <span class="n">argin</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">elems</span><span class="p">,</span> <span class="n">collections</span><span class="o">.</span><span class="n">Mapping</span><span class="p">):</span>
                <span class="n">elems</span> <span class="o">=</span> <span class="p">[</span><span class="n">elems</span><span class="p">]</span>
            <span class="k">for</span> <span class="n">elem</span> <span class="ow">in</span> <span class="n">elems</span><span class="p">:</span>
                <span class="n">d</span> <span class="o">=</span> <span class="p">{}</span>
                <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">elem</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
                    <span class="n">d</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">)]</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
                <span class="n">ret</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">ret</span>
        <span class="n">ret</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="n">argin</span><span class="p">[</span><span class="mi">0</span><span class="p">]}</span>
        <span class="c1"># if argin[-1].count(&#39;/&#39;) == 2:</span>
        <span class="c1">#    ret[&#39;full_name&#39;] = argin[-1]</span>
        <span class="c1">#    del argin[-1]</span>
        <span class="n">channels</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">arg</span> <span class="ow">in</span> <span class="n">argin</span><span class="p">[</span><span class="mi">1</span><span class="p">:]:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">channel</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pool</span><span class="o">.</span><span class="n">get_element_by_full_name</span><span class="p">(</span><span class="n">arg</span><span class="p">)</span>
                <span class="n">channels</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">channel</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">channel</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pool</span><span class="o">.</span><span class="n">get_element_by_name</span><span class="p">(</span><span class="n">arg</span><span class="p">)</span>
                    <span class="n">channels</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">channel</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
                <span class="k">except</span><span class="p">:</span>
                    <span class="n">channels</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">arg</span><span class="p">)</span>
        <span class="n">ret</span><span class="p">[</span><span class="s1">&#39;elements&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">channels</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">ret</span><span class="p">]</span>

    <span class="c1">#@DebugIt()</span>
<div class="viewcode-block" id="Pool.DeleteElement"><a class="viewcode-back" href="../../../../devel/api/sardana/tango/pool/Pool.html#sardana.tango.pool.Pool.Pool.DeleteElement">[docs]</a>    <span class="k">def</span> <span class="nf">DeleteElement</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">elem</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pool</span><span class="o">.</span><span class="n">get_element</span><span class="p">(</span><span class="n">full_name</span><span class="o">=</span><span class="n">name</span><span class="p">)</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="n">elem</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pool</span><span class="o">.</span><span class="n">get_element</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">)</span>

        <span class="n">elem_type</span> <span class="o">=</span> <span class="n">elem</span><span class="o">.</span><span class="n">get_type</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">elem_type</span> <span class="o">==</span> <span class="n">ElementType</span><span class="o">.</span><span class="n">Controller</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">elem</span><span class="o">.</span><span class="n">get_elements</span><span class="p">())</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;Cannot delete controller with elements. &quot;</span>
                                <span class="s2">&quot;Delete elements first&quot;</span><span class="p">)</span>

        <span class="n">td</span> <span class="o">=</span> <span class="n">TYPE_MAP_OBJ</span><span class="p">[</span><span class="n">elem_type</span><span class="p">]</span>
        <span class="n">type_name</span> <span class="o">=</span> <span class="n">td</span><span class="o">.</span><span class="n">name</span>

        <span class="n">full_name</span> <span class="o">=</span> <span class="n">elem</span><span class="o">.</span><span class="n">get_full_name</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">pool</span><span class="o">.</span><span class="n">delete_element</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">elem_type</span> <span class="o">==</span> <span class="n">ElementType</span><span class="o">.</span><span class="n">Instrument</span><span class="p">:</span>
            <span class="c1"># update database property</span>
            <span class="n">il</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">InstrumentList</span>
            <span class="n">idx</span> <span class="o">=</span> <span class="n">il</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">full_name</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">InstrumentList</span> <span class="o">=</span> <span class="n">il</span><span class="p">[:</span><span class="n">idx</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">il</span><span class="p">[</span><span class="n">idx</span> <span class="o">+</span> <span class="mi">2</span><span class="p">:]</span>
            <span class="n">db</span> <span class="o">=</span> <span class="n">PyTango</span><span class="o">.</span><span class="n">Util</span><span class="o">.</span><span class="n">instance</span><span class="p">()</span><span class="o">.</span><span class="n">get_database</span><span class="p">()</span>
            <span class="n">props</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;InstrumentList&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">InstrumentList</span><span class="p">}</span>
            <span class="n">db</span><span class="o">.</span><span class="n">put_device_property</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_name</span><span class="p">(),</span> <span class="n">props</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">util</span> <span class="o">=</span> <span class="n">PyTango</span><span class="o">.</span><span class="n">Util</span><span class="o">.</span><span class="n">instance</span><span class="p">()</span>
            <span class="n">util</span><span class="o">.</span><span class="n">delete_device</span><span class="p">(</span><span class="n">type_name</span><span class="p">,</span> <span class="n">full_name</span><span class="p">)</span></div>

    <span class="c1">#@DebugIt()</span>
<div class="viewcode-block" id="Pool.GetControllerClassInfo"><a class="viewcode-back" href="../../../../devel/api/sardana/tango/pool/Pool.html#sardana.tango.pool.Pool.Pool.GetControllerClassInfo">[docs]</a>    <span class="k">def</span> <span class="nf">GetControllerClassInfo</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">names</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">names</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;[&#39;</span><span class="p">):</span>
            <span class="n">names</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">names</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">names</span> <span class="o">=</span> <span class="p">(</span><span class="n">names</span><span class="p">,)</span>
        <span class="n">ctrl_classes</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pool</span><span class="o">.</span><span class="n">get_controller_classes_info</span><span class="p">(</span><span class="n">names</span><span class="p">)</span>
        <span class="n">ret</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">names</span><span class="p">:</span>
            <span class="n">ctrl_class</span> <span class="o">=</span> <span class="n">ctrl_classes</span><span class="p">[</span><span class="n">name</span><span class="p">]</span>
            <span class="n">data</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="k">if</span> <span class="n">ctrl_class</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">data</span> <span class="o">=</span> <span class="n">ctrl_class</span><span class="o">.</span><span class="n">serialize</span><span class="p">()</span>
            <span class="n">ret</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">ret</span><span class="p">)</span></div>

    <span class="c1">#@DebugIt()</span>
<div class="viewcode-block" id="Pool.ReloadControllerLib"><a class="viewcode-back" href="../../../../devel/api/sardana/tango/pool/Pool.html#sardana.tango.pool.Pool.Pool.ReloadControllerLib">[docs]</a>    <span class="k">def</span> <span class="nf">ReloadControllerLib</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">lib_name</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pool</span><span class="o">.</span><span class="n">reload_controller_lib</span><span class="p">(</span><span class="n">lib_name</span><span class="p">)</span></div>

    <span class="c1">#@DebugIt()</span>
<div class="viewcode-block" id="Pool.ReloadControllerClass"><a class="viewcode-back" href="../../../../devel/api/sardana/tango/pool/Pool.html#sardana.tango.pool.Pool.Pool.ReloadControllerClass">[docs]</a>    <span class="k">def</span> <span class="nf">ReloadControllerClass</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">class_name</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pool</span><span class="o">.</span><span class="n">reload_controller_class</span><span class="p">(</span><span class="n">class_name</span><span class="p">)</span></div>

<div class="viewcode-block" id="Pool.Stop"><a class="viewcode-back" href="../../../../devel/api/sardana/tango/pool/Pool.html#sardana.tango.pool.Pool.Pool.Stop">[docs]</a>    <span class="k">def</span> <span class="nf">Stop</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pool</span><span class="o">.</span><span class="n">stop</span><span class="p">()</span></div>

<div class="viewcode-block" id="Pool.Abort"><a class="viewcode-back" href="../../../../devel/api/sardana/tango/pool/Pool.html#sardana.tango.pool.Pool.Pool.Abort">[docs]</a>    <span class="k">def</span> <span class="nf">Abort</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pool</span><span class="o">.</span><span class="n">abort</span><span class="p">()</span></div>

<div class="viewcode-block" id="Pool.SendToController"><a class="viewcode-back" href="../../../../devel/api/sardana/tango/pool/Pool.html#sardana.tango.pool.Pool.Pool.SendToController">[docs]</a>    <span class="k">def</span> <span class="nf">SendToController</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">stream</span><span class="p">):</span>
        <span class="n">ctrl_name</span><span class="p">,</span> <span class="n">stream</span> <span class="o">=</span> <span class="n">stream</span><span class="p">[:</span><span class="mi">2</span><span class="p">]</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">ctrl</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pool</span><span class="o">.</span><span class="n">get_element_by_name</span><span class="p">(</span><span class="n">ctrl_name</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
            <span class="n">ctrl</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pool</span><span class="o">.</span><span class="n">get_element_by_full_name</span><span class="p">(</span><span class="n">ctrl_name</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">ctrl</span><span class="o">.</span><span class="n">send_to_controller</span><span class="p">(</span><span class="n">stream</span><span class="p">)</span></div>

<div class="viewcode-block" id="Pool.GetFile"><a class="viewcode-back" href="../../../../devel/api/sardana/tango/pool/Pool.html#sardana.tango.pool.Pool.Pool.GetFile">[docs]</a>    <span class="k">def</span> <span class="nf">GetFile</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
        <span class="n">p</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pool</span>
        <span class="n">manager</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">ctrl_manager</span>
        <span class="n">lib</span> <span class="o">=</span> <span class="n">manager</span><span class="o">.</span><span class="n">getControllerLib</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">lib</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;Unknown controller file &#39;</span><span class="si">%s</span><span class="s2">&#39;&quot;</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">lib</span><span class="o">.</span><span class="n">f_path</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">lib</span><span class="o">.</span><span class="n">getCode</span><span class="p">())</span></div>

<div class="viewcode-block" id="Pool.PutFile"><a class="viewcode-back" href="../../../../devel/api/sardana/tango/pool/Pool.html#sardana.tango.pool.Pool.Pool.PutFile">[docs]</a>    <span class="k">def</span> <span class="nf">PutFile</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">file_data</span><span class="p">):</span>
        <span class="n">p</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pool</span>
        <span class="n">manager</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">ctrl_manager</span>
        <span class="n">manager</span><span class="o">.</span><span class="n">setControllerLib</span><span class="p">(</span><span class="o">*</span><span class="n">file_data</span><span class="p">)</span></div>

<div class="viewcode-block" id="Pool.GetControllerCode"><a class="viewcode-back" href="../../../../devel/api/sardana/tango/pool/Pool.html#sardana.tango.pool.Pool.Pool.GetControllerCode">[docs]</a>    <span class="k">def</span> <span class="nf">GetControllerCode</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">argin</span><span class="p">):</span>
        <span class="k">pass</span></div>

<div class="viewcode-block" id="Pool.SetControllerCode"><a class="viewcode-back" href="../../../../devel/api/sardana/tango/pool/Pool.html#sardana.tango.pool.Pool.Pool.SetControllerCode">[docs]</a>    <span class="k">def</span> <span class="nf">SetControllerCode</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">argin</span><span class="p">):</span>
        <span class="k">pass</span></div></div>


<span class="n">CREATE_CONTROLLER_PAR_IN_DOC</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span><span class="se">\</span>
<span class="s2">Must give either:</span>

<span class="s2">        * A JSON encoded dict as first string with:</span>
<span class="s2">            * mandatory keys: &#39;type&#39;, &#39;library&#39;, &#39;klass&#39; and &#39;name&#39; (values are</span>
<span class="s2">              strings).</span>
<span class="s2">            * optional keys:</span>
<span class="s2">                * &#39;properties&#39;: a dict with keys being property names and values</span>
<span class="s2">                  the property values</span>
<span class="s2">                * &#39;roles&#39;: a dict with keys being controller roles and values being</span>
<span class="s2">                  element names. (example: { &#39;gap&#39; : &#39;motor21&#39;, &#39;offset&#39; : &#39;motor55&#39; }).</span>
<span class="s2">                  Only applicable of pseudo controllers</span>
<span class="s2">        * a sequence of strings: &lt;type&gt;, &lt;library&gt;, &lt;class&gt;, &lt;name&gt;</span>
<span class="s2">          [, &lt;role_name&gt;&#39;=&#39;&lt;element name&gt;] [, &lt;property name&gt;, &lt;property value&gt;]</span>

<span class="s2">    Examples::</span>

<span class="s2">        data = dict(type=&#39;Motor&#39;, library=&#39;DummyMotorController&#39;,</span>
<span class="s2">                    klass=&#39;DummyMotorController&#39;,</span>
<span class="s2">                    name=&#39;my_motor_ctrl_1&#39;)</span>
<span class="s2">        pool.CreateController([json.dumps(data)])</span>

<span class="s2">        pool.CreateController([&#39;Motor&#39;, &#39;DummyMotorController&#39;, &#39;DummyMotorController&#39;,</span>
<span class="s2">                               &#39;my_motor_ctrl_2&#39;])</span>
<span class="s2">&quot;&quot;&quot;</span>

<span class="n">CREATE_CONTROLLER_PAR_OUT_DOC</span> <span class="o">=</span> <span class="s2">&quot;None&quot;</span>

<span class="n">CREATE_CONTROLLER_DOC</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span><span class="se">\</span>
<span class="s2">Tango command to create controller.</span>

<span class="s2">:param argin:</span>
<span class="s2">    </span><span class="si">{0}</span><span class="s2"></span>
<span class="s2">:type argin: list&lt;str&gt;</span>
<span class="s2">:return:</span>
<span class="s2">    </span><span class="si">{1}</span><span class="s2"></span>
<span class="s2">&quot;&quot;&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">CREATE_CONTROLLER_PAR_IN_DOC</span><span class="p">,</span> <span class="n">CREATE_CONTROLLER_PAR_OUT_DOC</span><span class="p">)</span>

<span class="n">CREATE_ELEMENT_PAR_IN_DOC</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span><span class="se">\</span>
<span class="s2">Must give either:</span>

<span class="s2">        * A JSON encoded dict as first string with:</span>
<span class="s2">            * mandatory keys: &#39;type&#39;, &#39;ctrl_name&#39;, &#39;axis&#39;, &#39;name&#39; (values are</span>
<span class="s2">              strings).</span>
<span class="s2">            * optional keys:</span>
<span class="s2">                * &#39;full_name&#39; : a string representing the full tango device name</span>

<span class="s2">        * a sequence of strings: &lt;type&gt;, &lt;ctrl_name&gt;, &lt;axis&gt;, &lt;name&gt; [, &lt;full_name&gt;]</span>

<span class="s2">    Examples::</span>

<span class="s2">        data = dict(type=&#39;Motor&#39;, ctrl_name=&#39;my_motor_ctrl_1&#39;, axis=&#39;4&#39;, name=&#39;theta&#39;,</span>
<span class="s2">                    full_name=&#39;BL99/EH/THETA&#39;)</span>
<span class="s2">        pool.CreateElement([json.dumps(data)])</span>

<span class="s2">        pool.CreateElement([&#39;Motor&#39;, &#39;my_motor_ctrl_1&#39;, &#39;1&#39;, &#39;phi&#39;, &#39;BL99/EH/PHI&#39;])</span>
<span class="s2">&quot;&quot;&quot;</span>

<span class="n">CREATE_ELEMENT_PAR_OUT_DOC</span> <span class="o">=</span> <span class="s2">&quot;None&quot;</span>

<span class="n">CREATE_ELEMENT_DOC</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span><span class="se">\</span>
<span class="s2">Tango command to create element (motor, counter/timer, 0D, 1D, 2D, IORegister).</span>

<span class="s2">:param argin:</span>
<span class="s2">    </span><span class="si">{0}</span><span class="s2"></span>
<span class="s2">:type argin: list&lt;str&gt;</span>
<span class="s2">:return:</span>
<span class="s2">    </span><span class="si">{1}</span><span class="s2"></span>
<span class="s2">&quot;&quot;&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">CREATE_ELEMENT_PAR_IN_DOC</span><span class="p">,</span> <span class="n">CREATE_ELEMENT_PAR_OUT_DOC</span><span class="p">)</span>

<span class="n">CREATE_INSTRUMENT_PAR_IN_DOC</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span><span class="se">\</span>
<span class="s2">Must give either:</span>

<span class="s2">        * A JSON encoded dict as first string with:</span>
<span class="s2">            * mandatory keys: &#39;full_name&#39;, &#39;klass&#39; (values are strings).</span>
<span class="s2">        * a sequence of strings: &lt;full_name&gt;, &lt;class&gt;</span>

<span class="s2">    Examples::</span>

<span class="s2">        pool.CreateInstrument([&#39;/OH&#39;, &#39;NXhutch&#39;])</span>
<span class="s2">        pool.CreateInstrument([&#39;/OH/Mono&#39;, &#39;NXmonochromator&#39;])</span>
<span class="s2">        pool.CreateInstrument([&#39;/EH&#39;, &#39;NXhutch&#39;])</span>
<span class="s2">        pool.CreateInstrument([&#39;/EH/Pilatus&#39;, &#39;NXdetector&#39;])</span>
<span class="s2">&quot;&quot;&quot;</span>

<span class="n">CREATE_INSTRUMENT_PAR_OUT_DOC</span> <span class="o">=</span> <span class="s2">&quot;None&quot;</span>

<span class="n">CREATE_INSTRUMENT_DOC</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span><span class="se">\</span>
<span class="s2">Tango command to create instrument.</span>

<span class="s2">:param argin:</span>
<span class="s2">    </span><span class="si">{0}</span><span class="s2"></span>
<span class="s2">:type argin: list&lt;str&gt;</span>
<span class="s2">:return:</span>
<span class="s2">    </span><span class="si">{1}</span><span class="s2"></span>
<span class="s2">&quot;&quot;&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">CREATE_INSTRUMENT_PAR_IN_DOC</span><span class="p">,</span> <span class="n">CREATE_INSTRUMENT_PAR_OUT_DOC</span><span class="p">)</span>

<span class="n">CREATE_MOTOR_GROUP_PAR_IN_DOC</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span><span class="se">\</span>
<span class="s2">Must give either:</span>

<span class="s2">        * A JSON encoded dict as first string with:</span>
<span class="s2">            * mandatory keys: &#39;name&#39;, &#39;elements&#39; (with value being a list of moveables)</span>
<span class="s2">            * optional keys:</span>
<span class="s2">                * &#39;full_name&#39;: with value being a full tango device name</span>

<span class="s2">        * a sequence of strings: &lt;motor group name&gt; [, &lt;element&gt; ]&quot;</span>

<span class="s2">    Examples::</span>

<span class="s2">        data = dict(name=&#39;diffrac_motor_group&#39;, elements=[&#39;theta&#39;, &#39;theta2&#39;, &#39;phi&#39;])</span>
<span class="s2">        pool.CreateMotorGroup([json.dumps(data)])</span>

<span class="s2">        pool.CreateMotorGroup([&#39;diffrac_mg&#39;, &#39;theta&#39;, &#39;theta2&#39; ])</span>
<span class="s2">&quot;&quot;&quot;</span>

<span class="n">CREATE_MOTOR_GROUP_PAR_OUT_DOC</span> <span class="o">=</span> <span class="s2">&quot;None&quot;</span>

<span class="n">CREATE_MOTOR_GROUP_DOC</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span><span class="se">\</span>
<span class="s2">Tango command to create motor group.</span>

<span class="s2">:param argin:</span>
<span class="s2">    </span><span class="si">{0}</span><span class="s2"></span>
<span class="s2">:type argin: list&lt;str&gt;</span>
<span class="s2">:return:</span>
<span class="s2">    </span><span class="si">{1}</span><span class="s2"></span>
<span class="s2">&quot;&quot;&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">CREATE_MOTOR_GROUP_PAR_IN_DOC</span><span class="p">,</span> <span class="n">CREATE_MOTOR_GROUP_PAR_OUT_DOC</span><span class="p">)</span>

<span class="n">Pool</span><span class="o">.</span><span class="n">CreateMotorGroup</span><span class="o">.</span><span class="vm">__doc__</span> <span class="o">=</span> <span class="n">CREATE_MOTOR_GROUP_DOC</span>

<span class="n">CREATE_MEASUREMENT_GROUP_PAR_IN_DOC</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span><span class="se">\</span>
<span class="s2">Must give either:</span>

<span class="s2">        * A JSON encoded dict as first string with:</span>
<span class="s2">            * mandatory keys: &#39;name&#39;, &#39;elements&#39; (with value being a list of acquirables)&quot;</span>
<span class="s2">            * optional keys:</span>
<span class="s2">                * &#39;full_name&#39;: with value being a full tango device name</span>

<span class="s2">        * a sequence of strings: &lt;motor group name&gt; [, &lt;element&gt; ]&quot;</span>

<span class="s2">    An acquirable is either a sardana element (counter/timer, 0D, 1D, 2D, motor) or</span>
<span class="s2">    a tango attribute (ex: sys/tg_test/1/short_spectrum_ro)</span>

<span class="s2">    Examples::</span>

<span class="s2">        data = dict(name=&#39;my_exp_01&#39;, elements=[&#39;timer&#39;, &#39;C1&#39;, &#39;sys/tg_test/1/double_scalar&#39;])</span>
<span class="s2">        pool.CreateMeasurementGroup([json.dumps(data)])</span>

<span class="s2">        pool.CreateMeasurementGroup([&#39;my_exp_02&#39;, &#39;timer&#39;, &#39;CCD1&#39;, &#39;sys/tg_test/1/short_spectrum_ro&#39;])</span>
<span class="s2">&quot;&quot;&quot;</span>

<span class="n">CREATE_MEASUREMENT_GROUP_PAR_OUT_DOC</span> <span class="o">=</span> <span class="s2">&quot;None&quot;</span>

<span class="n">CREATE_MEASUREMENT_GROUP_DOC</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span><span class="se">\</span>
<span class="s2">Tango command to create measurement group.</span>

<span class="s2">:param argin:</span>
<span class="s2">    </span><span class="si">{0}</span><span class="s2"></span>
<span class="s2">:type argin: list&lt;str&gt;</span>
<span class="s2">:return:</span>
<span class="s2">    </span><span class="si">{1}</span><span class="s2"></span>
<span class="s2">&quot;&quot;&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">CREATE_MEASUREMENT_GROUP_PAR_IN_DOC</span><span class="p">,</span> <span class="n">CREATE_MEASUREMENT_GROUP_PAR_OUT_DOC</span><span class="p">)</span>

<span class="n">DELETE_ELEMENT_PAR_IN_DOC</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span><span class="se">\</span>
<span class="s2">name of element to be deleted</span>
<span class="s2">&quot;&quot;&quot;</span>

<span class="n">DELETE_ELEMENT_PAR_OUT_DOC</span> <span class="o">=</span> <span class="s2">&quot;None&quot;</span>

<span class="n">DELETE_ELEMENT_DOC</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span><span class="se">\</span>
<span class="s2">Tango command to delete element.</span>

<span class="s2">:param argin:</span>
<span class="s2">    </span><span class="si">{0}</span><span class="s2"></span>
<span class="s2">:type argin: :obj:`str`</span>
<span class="s2">:return:</span>
<span class="s2">    </span><span class="si">{1}</span><span class="s2"></span>
<span class="s2">&quot;&quot;&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">DELETE_ELEMENT_PAR_IN_DOC</span><span class="p">,</span> <span class="n">DELETE_ELEMENT_PAR_OUT_DOC</span><span class="p">)</span>

<span class="n">GET_CONTROLLER_CLASS_INFO_PAR_IN_DOC</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span><span class="se">\</span>
<span class="s2">Must give either:</span>

<span class="s2">        * A JSON encoded list of controller class names</span>
<span class="s2">        * a controller class name</span>

<span class="s2">    Examples::</span>

<span class="s2">        data = &quot;DummyMotorController&quot;, &quot;DummyCounterTimerController&quot;</span>
<span class="s2">        pool.GetControllerClassInfo(json.dumps(data))</span>
<span class="s2">        pool.GetControllerClassInfo(&quot;DummyMotorController&quot;)</span>

<span class="s2">&quot;&quot;&quot;</span>

<span class="n">GET_CONTROLLER_CLASS_INFO_PAR_OUT_DOC</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">a JSON encoded string describing the controller class</span>
<span class="s2">&quot;&quot;&quot;</span>

<span class="n">GET_CONTROLLER_CLASS_INFO_DOC</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span><span class="se">\</span>
<span class="s2">Tango command to get detailed information about a controller class.</span>

<span class="s2">:param argin:</span>
<span class="s2">    </span><span class="si">{0}</span><span class="s2"></span>
<span class="s2">:type argin: :obj:`str`</span>
<span class="s2">:return:</span>
<span class="s2">    </span><span class="si">{1}</span><span class="s2"></span>
<span class="s2">:rtype: :obj:`str`</span>
<span class="s2">&quot;&quot;&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">GET_CONTROLLER_CLASS_INFO_PAR_IN_DOC</span><span class="p">,</span> <span class="n">GET_CONTROLLER_CLASS_INFO_PAR_OUT_DOC</span><span class="p">)</span>

<span class="n">RELOAD_CONTROLLER_LIB_PAR_IN_DOC</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span><span class="se">\</span>
<span class="s2">the controller library name (without extension)</span>
<span class="s2">&quot;&quot;&quot;</span>

<span class="n">RELOAD_CONTROLLER_LIB_PAR_OUT_DOC</span> <span class="o">=</span> <span class="s2">&quot;None&quot;</span>

<span class="n">RELOAD_CONTROLLER_LIB_INFO_DOC</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span><span class="se">\</span>
<span class="s2">Tango command to reload the controller library code.</span>

<span class="s2">:param argin:</span>
<span class="s2">    </span><span class="si">{0}</span><span class="s2"></span>
<span class="s2">:type argin: :obj:`str`</span>
<span class="s2">:return:</span>
<span class="s2">    </span><span class="si">{1}</span><span class="s2"></span>
<span class="s2">&quot;&quot;&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">RELOAD_CONTROLLER_LIB_PAR_IN_DOC</span><span class="p">,</span> <span class="n">RELOAD_CONTROLLER_LIB_PAR_OUT_DOC</span><span class="p">)</span>

<span class="n">RELOAD_CONTROLLER_CLASS_PAR_IN_DOC</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span><span class="se">\</span>
<span class="s2">the controller class name</span>
<span class="s2">&quot;&quot;&quot;</span>

<span class="n">RELOAD_CONTROLLER_CLASS_PAR_OUT_DOC</span> <span class="o">=</span> <span class="s2">&quot;None&quot;</span>

<span class="n">RELOAD_CONTROLLER_CLASS_INFO_DOC</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span><span class="se">\</span>
<span class="s2">Tango command to reload the controller class code (reloads the entire library</span>
<span class="s2">where the class is described).</span>

<span class="s2">:param argin:</span>
<span class="s2">    </span><span class="si">{0}</span><span class="s2"></span>
<span class="s2">:type argin: :obj:`str`</span>
<span class="s2">:return:</span>
<span class="s2">    </span><span class="si">{1}</span><span class="s2"></span>
<span class="s2">&quot;&quot;&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">RELOAD_CONTROLLER_CLASS_PAR_IN_DOC</span><span class="p">,</span> <span class="n">RELOAD_CONTROLLER_CLASS_PAR_OUT_DOC</span><span class="p">)</span>

<span class="n">RENAME_ELEMENT_PAR_IN_DOC</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">Two elements sequence of strings: &lt;old element name&gt;, &lt;new element name&gt;</span>
<span class="s2">&quot;&quot;&quot;</span>

<span class="n">RENAME_ELEMENT_PAR_OUT_DOC</span> <span class="o">=</span> <span class="s2">&quot;None&quot;</span>

<span class="n">RENAME_ELEMENT_CLASS_INFO_DOC</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span><span class="se">\</span>
<span class="s2">Tango command to rename the element (rename Pool element and put new alias in</span>
<span class="s2">the Tango Database).</span>

<span class="s2">:param argin:</span>
<span class="s2">    </span><span class="si">{0}</span><span class="s2"></span>
<span class="s2">:type argin: list&lt;str&gt;</span>
<span class="s2">:return:</span>
<span class="s2">    </span><span class="si">{1}</span><span class="s2"></span>
<span class="s2">&quot;&quot;&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">RENAME_ELEMENT_PAR_IN_DOC</span><span class="p">,</span> <span class="n">RENAME_ELEMENT_PAR_OUT_DOC</span><span class="p">)</span>

<span class="n">STOP_PAR_IN_DOC</span> <span class="o">=</span> <span class="s2">&quot;None&quot;</span>
<span class="n">STOP_PAR_OUT_DOC</span> <span class="o">=</span> <span class="s2">&quot;None&quot;</span>

<span class="n">STOP_DOC</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span><span class="se">\</span>
<span class="s2">Stops all elements managed by this Pool</span>

<span class="s2">:param argin:</span>
<span class="s2">    </span><span class="si">{0}</span><span class="s2"></span>
<span class="s2">:return:</span>
<span class="s2">    </span><span class="si">{1}</span><span class="s2"></span>
<span class="s2">&quot;&quot;&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">STOP_PAR_IN_DOC</span><span class="p">,</span> <span class="n">STOP_PAR_OUT_DOC</span><span class="p">)</span>

<span class="n">ABORT_PAR_IN_DOC</span> <span class="o">=</span> <span class="s2">&quot;None&quot;</span>
<span class="n">ABORT_PAR_OUT_DOC</span> <span class="o">=</span> <span class="s2">&quot;None&quot;</span>

<span class="n">ABORT_DOC</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span><span class="se">\</span>
<span class="s2">Aborts all elements managed by this Pool</span>

<span class="s2">:param argin:</span>
<span class="s2">    </span><span class="si">{0}</span><span class="s2"></span>
<span class="s2">:return:</span>
<span class="s2">    </span><span class="si">{1}</span><span class="s2"></span>
<span class="s2">&quot;&quot;&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">ABORT_PAR_IN_DOC</span><span class="p">,</span> <span class="n">ABORT_PAR_OUT_DOC</span><span class="p">)</span>

<span class="n">SEND_TO_CONTROLLER_PAR_IN_DOC</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span><span class="se">\</span>
<span class="s2">a sequence of two strings: &lt;controller name&gt;, &lt;data&gt;</span>
<span class="s2">&quot;&quot;&quot;</span>

<span class="n">SEND_TO_CONTROLLER_PAR_OUT_DOC</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span><span class="se">\</span>
<span class="s2">the controller response</span>
<span class="s2">&quot;&quot;&quot;</span>

<span class="n">SEND_TO_CONTROLLER_DOC</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span><span class="se">\</span>
<span class="s2">Sends a string to a controller.</span>

<span class="s2">:param argin:</span>
<span class="s2">    </span><span class="si">{0}</span><span class="s2"></span>
<span class="s2">:return:</span>
<span class="s2">    </span><span class="si">{1}</span><span class="s2"></span>
<span class="s2">&quot;&quot;&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">SEND_TO_CONTROLLER_PAR_IN_DOC</span><span class="p">,</span> <span class="n">SEND_TO_CONTROLLER_PAR_OUT_DOC</span><span class="p">)</span>

<span class="n">Pool</span><span class="o">.</span><span class="n">CreateController</span><span class="o">.</span><span class="vm">__doc__</span> <span class="o">=</span> <span class="n">CREATE_CONTROLLER_DOC</span>
<span class="n">Pool</span><span class="o">.</span><span class="n">CreateElement</span><span class="o">.</span><span class="vm">__doc__</span> <span class="o">=</span> <span class="n">CREATE_ELEMENT_DOC</span>
<span class="n">Pool</span><span class="o">.</span><span class="n">CreateInstrument</span><span class="o">.</span><span class="vm">__doc__</span> <span class="o">=</span> <span class="n">CREATE_INSTRUMENT_DOC</span>
<span class="n">Pool</span><span class="o">.</span><span class="n">CreateMotorGroup</span><span class="o">.</span><span class="vm">__doc__</span> <span class="o">=</span> <span class="n">CREATE_MOTOR_GROUP_DOC</span>
<span class="n">Pool</span><span class="o">.</span><span class="n">CreateMeasurementGroup</span><span class="o">.</span><span class="vm">__doc__</span> <span class="o">=</span> <span class="n">CREATE_MEASUREMENT_GROUP_DOC</span>
<span class="n">Pool</span><span class="o">.</span><span class="n">DeleteElement</span><span class="o">.</span><span class="vm">__doc__</span> <span class="o">=</span> <span class="n">DELETE_ELEMENT_DOC</span>
<span class="n">Pool</span><span class="o">.</span><span class="n">GetControllerClassInfo</span><span class="o">.</span><span class="vm">__doc__</span> <span class="o">=</span> <span class="n">GET_CONTROLLER_CLASS_INFO_DOC</span>
<span class="n">Pool</span><span class="o">.</span><span class="n">ReloadControllerLib</span><span class="o">.</span><span class="vm">__doc__</span> <span class="o">=</span> <span class="n">RELOAD_CONTROLLER_LIB_INFO_DOC</span>
<span class="n">Pool</span><span class="o">.</span><span class="n">ReloadControllerClass</span><span class="o">.</span><span class="vm">__doc__</span> <span class="o">=</span> <span class="n">RELOAD_CONTROLLER_CLASS_INFO_DOC</span>
<span class="n">Pool</span><span class="o">.</span><span class="n">RenameElement</span><span class="o">.</span><span class="vm">__doc__</span> <span class="o">=</span> <span class="n">RENAME_ELEMENT_CLASS_INFO_DOC</span>
<span class="n">Pool</span><span class="o">.</span><span class="n">Stop</span><span class="o">.</span><span class="vm">__doc__</span> <span class="o">=</span> <span class="n">STOP_DOC</span>
<span class="n">Pool</span><span class="o">.</span><span class="n">Abort</span><span class="o">.</span><span class="vm">__doc__</span> <span class="o">=</span> <span class="n">ABORT_DOC</span>


<div class="viewcode-block" id="PoolClass"><a class="viewcode-back" href="../../../../devel/api/sardana/tango/pool/Pool.html#sardana.tango.pool.Pool.PoolClass">[docs]</a><span class="k">class</span> <span class="nc">PoolClass</span><span class="p">(</span><span class="n">PyTango</span><span class="o">.</span><span class="n">DeviceClass</span><span class="p">):</span>

    <span class="c1">#    Class Properties</span>
    <span class="n">class_property_list</span> <span class="o">=</span> <span class="p">{</span>
    <span class="p">}</span>

    <span class="c1">#    Device Properties</span>
    <span class="n">device_property_list</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;PoolPath&#39;</span><span class="p">:</span>
            <span class="p">[</span><span class="n">PyTango</span><span class="o">.</span><span class="n">DevVarStringArray</span><span class="p">,</span>
             <span class="s2">&quot;list of directories to search for controllers (path separators &quot;</span>
             <span class="s2">&quot;can be &#39;</span><span class="se">\n</span><span class="s2">&#39; or character conventionally used by the OS to&quot;</span>
             <span class="s2">&quot;separate search path components, such as &#39;:&#39; for POSIX&quot;</span>
             <span class="s2">&quot;or &#39;;&#39; for Windows)&quot;</span><span class="p">,</span>
             <span class="p">[]],</span>
        <span class="s1">&#39;PythonPath&#39;</span><span class="p">:</span>
            <span class="p">[</span><span class="n">PyTango</span><span class="o">.</span><span class="n">DevVarStringArray</span><span class="p">,</span>
             <span class="s2">&quot;list of directories to be appended to sys.path at startup (path &quot;</span>
             <span class="s2">&quot;separators can be &#39;</span><span class="se">\n</span><span class="s2">&#39; or &#39;:&#39;)&quot;</span><span class="p">,</span>
             <span class="p">[]],</span>
        <span class="s1">&#39;MotionLoop_SleepTime&#39;</span><span class="p">:</span>
            <span class="p">[</span><span class="n">PyTango</span><span class="o">.</span><span class="n">DevLong</span><span class="p">,</span>
             <span class="s2">&quot;Sleep time in the motion loop in mS [default: </span><span class="si">%d</span><span class="s2">ms]&quot;</span> <span class="o">%</span>
             <span class="nb">int</span><span class="p">(</span><span class="n">POOL</span><span class="o">.</span><span class="n">Default_MotionLoop_SleepTime</span> <span class="o">*</span> <span class="mi">1000</span><span class="p">),</span>
             <span class="nb">int</span><span class="p">(</span><span class="n">POOL</span><span class="o">.</span><span class="n">Default_MotionLoop_SleepTime</span> <span class="o">*</span> <span class="mi">1000</span><span class="p">)],</span>
        <span class="s1">&#39;MotionLoop_StatesPerPosition&#39;</span><span class="p">:</span>
            <span class="p">[</span><span class="n">PyTango</span><span class="o">.</span><span class="n">DevLong</span><span class="p">,</span>
             <span class="s2">&quot;Number of State reads done before doing a position read in the &quot;</span>
             <span class="s2">&quot;motion loop [default: </span><span class="si">%d</span><span class="s2">]&quot;</span> <span class="o">%</span> <span class="n">POOL</span><span class="o">.</span><span class="n">Default_MotionLoop_StatesPerPosition</span><span class="p">,</span>
             <span class="n">POOL</span><span class="o">.</span><span class="n">Default_MotionLoop_StatesPerPosition</span><span class="p">],</span>
        <span class="s1">&#39;AcqLoop_SleepTime&#39;</span><span class="p">:</span>
            <span class="p">[</span><span class="n">PyTango</span><span class="o">.</span><span class="n">DevLong</span><span class="p">,</span>
             <span class="s2">&quot;Sleep time in the acquisition loop in mS [default: </span><span class="si">%d</span><span class="s2">ms]&quot;</span> <span class="o">%</span>
             <span class="nb">int</span><span class="p">(</span><span class="n">POOL</span><span class="o">.</span><span class="n">Default_AcqLoop_SleepTime</span> <span class="o">*</span> <span class="mi">1000</span><span class="p">),</span>
             <span class="nb">int</span><span class="p">(</span><span class="n">POOL</span><span class="o">.</span><span class="n">Default_AcqLoop_SleepTime</span> <span class="o">*</span> <span class="mi">1000</span><span class="p">)],</span>
        <span class="s1">&#39;AcqLoop_StatesPerValue&#39;</span><span class="p">:</span>
            <span class="p">[</span><span class="n">PyTango</span><span class="o">.</span><span class="n">DevLong</span><span class="p">,</span>
             <span class="s2">&quot;Number of State reads done before doing a value read in the &quot;</span>
             <span class="s2">&quot;acquisition loop [default: </span><span class="si">%d</span><span class="s2">]&quot;</span> <span class="o">%</span> <span class="n">POOL</span><span class="o">.</span><span class="n">Default_AcqLoop_StatesPerValue</span><span class="p">,</span>
             <span class="n">POOL</span><span class="o">.</span><span class="n">Default_AcqLoop_StatesPerValue</span><span class="p">],</span>
        <span class="s1">&#39;RemoteLog&#39;</span><span class="p">:</span>
            <span class="p">[</span><span class="n">PyTango</span><span class="o">.</span><span class="n">DevString</span><span class="p">,</span>
             <span class="s2">&quot;Logging (python logging) host:port [default: None]&quot;</span><span class="p">,</span>
             <span class="kc">None</span><span class="p">],</span>
        <span class="s1">&#39;DriftCorrection&#39;</span><span class="p">:</span>
            <span class="p">[</span><span class="n">PyTango</span><span class="o">.</span><span class="n">DevBoolean</span><span class="p">,</span>
             <span class="s2">&quot;Globally apply drift correction on pseudo motors (can be &quot;</span>
             <span class="s2">&quot;overwritten at PseudoMotor level [default: </span><span class="si">%d</span><span class="s2">].&quot;</span> <span class="o">%</span>
             <span class="n">POOL</span><span class="o">.</span><span class="n">Default_DriftCorrection</span><span class="p">,</span>
             <span class="n">POOL</span><span class="o">.</span><span class="n">Default_DriftCorrection</span><span class="p">],</span>
        <span class="s1">&#39;InstrumentList&#39;</span><span class="p">:</span>
            <span class="p">[</span><span class="n">PyTango</span><span class="o">.</span><span class="n">DevVarStringArray</span><span class="p">,</span>
             <span class="s2">&quot;List of instruments (internal property)&quot;</span><span class="p">,</span>
             <span class="p">[]],</span>
        <span class="s1">&#39;LogstashHost&#39;</span><span class="p">:</span>
            <span class="p">[</span><span class="n">PyTango</span><span class="o">.</span><span class="n">DevString</span><span class="p">,</span>
             <span class="s2">&quot;Hostname where Logstash runs. &quot;</span>
             <span class="s2">&quot;This property has been included in Sardana on a provisional &quot;</span>
             <span class="s2">&quot;basis. Backwards incompatible changes (up to and including &quot;</span>
             <span class="s2">&quot;its removal) may occur if deemed necessary by the &quot;</span>
             <span class="s2">&quot;core developers.&quot;</span><span class="p">,</span>
             <span class="kc">None</span><span class="p">],</span>
        <span class="s1">&#39;LogstashPort&#39;</span><span class="p">:</span>
            <span class="p">[</span><span class="n">PyTango</span><span class="o">.</span><span class="n">DevLong</span><span class="p">,</span>
             <span class="s2">&quot;Port on which Logstash will listen on events [default: 12345]. &quot;</span>
             <span class="s2">&quot;This property has been included in Sardana on a provisional &quot;</span>
             <span class="s2">&quot;basis. Backwards incompatible changes (up to and including &quot;</span>
             <span class="s2">&quot;its removal) may occur if deemed necessary by the &quot;</span>
             <span class="s2">&quot;core developers.&quot;</span><span class="p">,</span>
             <span class="mi">12345</span><span class="p">],</span>
        <span class="s1">&#39;LogstashCacheDbPath&#39;</span><span class="p">:</span>
            <span class="p">[</span><span class="n">PyTango</span><span class="o">.</span><span class="n">DevString</span><span class="p">,</span>
             <span class="s2">&quot;Path to the Logstash cache database [default: None]. &quot;</span>
             <span class="s2">&quot;It is advised not to use the database cache, as it may &quot;</span>
             <span class="s2">&quot;have negative effects on logging performance. See #895. &quot;</span>
             <span class="s2">&quot;This property has been included in Sardana on a provisional &quot;</span>
             <span class="s2">&quot;basis. Backwards incompatible changes (up to and including &quot;</span>
             <span class="s2">&quot;its removal) may occur if deemed necessary by the &quot;</span>
             <span class="s2">&quot;core developers.&quot;</span><span class="p">,</span>
             <span class="kc">None</span><span class="p">]</span>
    <span class="p">}</span>

    <span class="c1">#    Command definitions</span>
    <span class="n">cmd_list</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;CreateController&#39;</span><span class="p">:</span>
            <span class="p">[[</span><span class="n">PyTango</span><span class="o">.</span><span class="n">DevVarStringArray</span><span class="p">,</span> <span class="n">CREATE_CONTROLLER_PAR_IN_DOC</span><span class="p">],</span>
             <span class="p">[</span><span class="n">PyTango</span><span class="o">.</span><span class="n">DevVoid</span><span class="p">,</span> <span class="n">CREATE_CONTROLLER_PAR_OUT_DOC</span><span class="p">]],</span>
        <span class="s1">&#39;CreateElement&#39;</span><span class="p">:</span>
            <span class="p">[[</span><span class="n">PyTango</span><span class="o">.</span><span class="n">DevVarStringArray</span><span class="p">,</span> <span class="n">CREATE_ELEMENT_PAR_IN_DOC</span><span class="p">],</span>
             <span class="p">[</span><span class="n">PyTango</span><span class="o">.</span><span class="n">DevVoid</span><span class="p">,</span> <span class="n">CREATE_ELEMENT_PAR_OUT_DOC</span><span class="p">]],</span>
        <span class="s1">&#39;CreateInstrument&#39;</span><span class="p">:</span>
            <span class="p">[[</span><span class="n">PyTango</span><span class="o">.</span><span class="n">DevVarStringArray</span><span class="p">,</span> <span class="n">CREATE_INSTRUMENT_PAR_IN_DOC</span><span class="p">],</span>
             <span class="p">[</span><span class="n">PyTango</span><span class="o">.</span><span class="n">DevVoid</span><span class="p">,</span> <span class="n">CREATE_INSTRUMENT_PAR_OUT_DOC</span><span class="p">]],</span>
        <span class="s1">&#39;CreateMotorGroup&#39;</span><span class="p">:</span>
            <span class="p">[[</span><span class="n">PyTango</span><span class="o">.</span><span class="n">DevVarStringArray</span><span class="p">,</span> <span class="n">CREATE_MOTOR_GROUP_PAR_IN_DOC</span><span class="p">],</span>
             <span class="p">[</span><span class="n">PyTango</span><span class="o">.</span><span class="n">DevVoid</span><span class="p">,</span> <span class="n">CREATE_MOTOR_GROUP_PAR_OUT_DOC</span><span class="p">]],</span>
        <span class="s1">&#39;CreateMeasurementGroup&#39;</span><span class="p">:</span>
            <span class="p">[[</span><span class="n">PyTango</span><span class="o">.</span><span class="n">DevVarStringArray</span><span class="p">,</span> <span class="n">CREATE_MEASUREMENT_GROUP_PAR_IN_DOC</span><span class="p">],</span>
             <span class="p">[</span><span class="n">PyTango</span><span class="o">.</span><span class="n">DevVoid</span><span class="p">,</span> <span class="n">CREATE_MEASUREMENT_GROUP_PAR_OUT_DOC</span><span class="p">]],</span>
        <span class="s1">&#39;DeleteElement&#39;</span><span class="p">:</span>
            <span class="p">[[</span><span class="n">PyTango</span><span class="o">.</span><span class="n">DevString</span><span class="p">,</span> <span class="n">DELETE_ELEMENT_PAR_IN_DOC</span><span class="p">],</span>
             <span class="p">[</span><span class="n">PyTango</span><span class="o">.</span><span class="n">DevVoid</span><span class="p">,</span> <span class="n">DELETE_ELEMENT_PAR_OUT_DOC</span><span class="p">]],</span>
        <span class="s1">&#39;GetControllerClassInfo&#39;</span><span class="p">:</span>
            <span class="p">[[</span><span class="n">PyTango</span><span class="o">.</span><span class="n">DevString</span><span class="p">,</span> <span class="n">GET_CONTROLLER_CLASS_INFO_PAR_IN_DOC</span><span class="p">],</span>
             <span class="p">[</span><span class="n">PyTango</span><span class="o">.</span><span class="n">DevString</span><span class="p">,</span> <span class="n">GET_CONTROLLER_CLASS_INFO_PAR_OUT_DOC</span><span class="p">]],</span>
        <span class="s1">&#39;ReloadControllerLib&#39;</span><span class="p">:</span>
            <span class="p">[[</span><span class="n">PyTango</span><span class="o">.</span><span class="n">DevString</span><span class="p">,</span> <span class="n">RELOAD_CONTROLLER_LIB_PAR_IN_DOC</span><span class="p">],</span>
             <span class="p">[</span><span class="n">PyTango</span><span class="o">.</span><span class="n">DevVoid</span><span class="p">,</span> <span class="n">RELOAD_CONTROLLER_LIB_PAR_OUT_DOC</span><span class="p">]],</span>
        <span class="s1">&#39;ReloadControllerClass&#39;</span><span class="p">:</span>
            <span class="p">[[</span><span class="n">PyTango</span><span class="o">.</span><span class="n">DevString</span><span class="p">,</span> <span class="n">RELOAD_CONTROLLER_CLASS_PAR_IN_DOC</span><span class="p">],</span>
             <span class="p">[</span><span class="n">PyTango</span><span class="o">.</span><span class="n">DevVoid</span><span class="p">,</span> <span class="n">RELOAD_CONTROLLER_CLASS_PAR_OUT_DOC</span><span class="p">]],</span>
        <span class="s1">&#39;RenameElement&#39;</span><span class="p">:</span>
            <span class="p">[[</span><span class="n">PyTango</span><span class="o">.</span><span class="n">DevVarStringArray</span><span class="p">,</span> <span class="n">RENAME_ELEMENT_PAR_IN_DOC</span><span class="p">],</span>
             <span class="p">[</span><span class="n">PyTango</span><span class="o">.</span><span class="n">DevVoid</span><span class="p">,</span> <span class="n">RENAME_ELEMENT_PAR_OUT_DOC</span><span class="p">]],</span>
        <span class="s1">&#39;GetControllerCode&#39;</span><span class="p">:</span>
            <span class="p">[[</span><span class="n">PyTango</span><span class="o">.</span><span class="n">DevVarStringArray</span><span class="p">,</span> <span class="s2">&quot;&lt;Controller library name&gt; [, &lt;Controller class name&gt;]&quot;</span><span class="p">],</span>
             <span class="p">[</span><span class="n">PyTango</span><span class="o">.</span><span class="n">DevVarStringArray</span><span class="p">,</span> <span class="s2">&quot;result is a sequence of 3 strings:</span><span class="se">\n</span><span class="s2">&quot;</span>
                <span class="s2">&quot;&lt;full path and file name&gt;, &lt;code&gt;, &lt;line number&gt;&quot;</span><span class="p">]],</span>
        <span class="s1">&#39;SetControllerCode&#39;</span><span class="p">:</span>
            <span class="p">[[</span><span class="n">PyTango</span><span class="o">.</span><span class="n">DevVarStringArray</span><span class="p">,</span> <span class="s2">&quot;&lt;Controller library name&gt;, &lt;code&gt; [, &lt;Auto reload&gt;=True]</span><span class="se">\n</span><span class="s2">&quot;</span>
                <span class="s2">&quot;- if controller library is a simple module name:</span><span class="se">\n</span><span class="s2">&quot;</span>
                <span class="s2">&quot;  - if it exists, it is overwritten, otherwise a new python &quot;</span>
                <span class="s2">&quot;file is created in the directory of the first element in &quot;</span>
                <span class="s2">&quot;the PoolPath property&quot;</span>
                <span class="s2">&quot;- if controller library is the full path name:</span><span class="se">\n</span><span class="s2">&quot;</span>
                <span class="s2">&quot;  - if path is not in the PoolPath, an exception is thrown&quot;</span>
                <span class="s2">&quot;  - if file exists it is overwritten otherwise a new file &quot;</span>
                <span class="s2">&quot;is created&quot;</span><span class="p">],</span>
             <span class="p">[</span><span class="n">PyTango</span><span class="o">.</span><span class="n">DevVoid</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">]],</span>
        <span class="s1">&#39;Stop&#39;</span><span class="p">:</span>
            <span class="p">[[</span><span class="n">PyTango</span><span class="o">.</span><span class="n">DevVoid</span><span class="p">,</span> <span class="n">STOP_PAR_IN_DOC</span><span class="p">],</span>
             <span class="p">[</span><span class="n">PyTango</span><span class="o">.</span><span class="n">DevVoid</span><span class="p">,</span> <span class="n">STOP_PAR_OUT_DOC</span><span class="p">]],</span>
        <span class="s1">&#39;Abort&#39;</span><span class="p">:</span>
            <span class="p">[[</span><span class="n">PyTango</span><span class="o">.</span><span class="n">DevVoid</span><span class="p">,</span> <span class="n">ABORT_PAR_IN_DOC</span><span class="p">],</span>
             <span class="p">[</span><span class="n">PyTango</span><span class="o">.</span><span class="n">DevVoid</span><span class="p">,</span> <span class="n">ABORT_PAR_OUT_DOC</span><span class="p">]],</span>
        <span class="s1">&#39;SendToController&#39;</span><span class="p">:</span>
            <span class="p">[[</span><span class="n">PyTango</span><span class="o">.</span><span class="n">DevVarStringArray</span><span class="p">,</span> <span class="n">SEND_TO_CONTROLLER_PAR_IN_DOC</span><span class="p">],</span>
             <span class="p">[</span><span class="n">PyTango</span><span class="o">.</span><span class="n">DevString</span><span class="p">,</span> <span class="n">SEND_TO_CONTROLLER_PAR_OUT_DOC</span><span class="p">]],</span>
        <span class="s1">&#39;GetFile&#39;</span><span class="p">:</span>
            <span class="p">[[</span><span class="n">PyTango</span><span class="o">.</span><span class="n">DevString</span><span class="p">,</span> <span class="s2">&quot;name (may be module name, file name or full (with absolute path) file name&quot;</span><span class="p">],</span>
             <span class="p">[</span><span class="n">PyTango</span><span class="o">.</span><span class="n">DevVarStringArray</span><span class="p">,</span> <span class="s2">&quot;[complete(with absolute path) file name, file contents]&quot;</span><span class="p">]],</span>
        <span class="s1">&#39;PutFile&#39;</span><span class="p">:</span>
            <span class="p">[[</span><span class="n">PyTango</span><span class="o">.</span><span class="n">DevVarStringArray</span><span class="p">,</span> <span class="s2">&quot;[name (may be module name, file name or full (with absolute path) file name, file contents]&quot;</span><span class="p">],</span>
             <span class="p">[</span><span class="n">PyTango</span><span class="o">.</span><span class="n">DevVoid</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">]],</span>
    <span class="p">}</span>

    <span class="c1">#    Attribute definitions</span>
    <span class="n">attr_list</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;InstrumentList&#39;</span><span class="p">:</span>
            <span class="p">[[</span><span class="n">PyTango</span><span class="o">.</span><span class="n">DevString</span><span class="p">,</span>
              <span class="n">PyTango</span><span class="o">.</span><span class="n">SPECTRUM</span><span class="p">,</span>
              <span class="n">PyTango</span><span class="o">.</span><span class="n">READ</span><span class="p">,</span> <span class="mi">4096</span><span class="p">],</span>
             <span class="p">{</span>
                <span class="s1">&#39;label&#39;</span><span class="p">:</span> <span class="s2">&quot;Motor list&quot;</span><span class="p">,</span>
                <span class="s1">&#39;description&#39;</span><span class="p">:</span> <span class="s2">&quot;the list of instruments (a JSON encoded dict)&quot;</span><span class="p">,</span>
            <span class="p">}],</span>
        <span class="s1">&#39;ControllerList&#39;</span><span class="p">:</span>
            <span class="p">[[</span><span class="n">PyTango</span><span class="o">.</span><span class="n">DevString</span><span class="p">,</span>
              <span class="n">PyTango</span><span class="o">.</span><span class="n">SPECTRUM</span><span class="p">,</span>
              <span class="n">PyTango</span><span class="o">.</span><span class="n">READ</span><span class="p">,</span> <span class="mi">4096</span><span class="p">],</span>
             <span class="p">{</span>
                <span class="s1">&#39;label&#39;</span><span class="p">:</span> <span class="s2">&quot;Controller list&quot;</span><span class="p">,</span>
                <span class="s1">&#39;description&#39;</span><span class="p">:</span> <span class="s2">&quot;the list of controllers (a JSON encoded dict)&quot;</span><span class="p">,</span>
            <span class="p">}],</span>
        <span class="s1">&#39;ExpChannelList&#39;</span><span class="p">:</span>
            <span class="p">[[</span><span class="n">PyTango</span><span class="o">.</span><span class="n">DevString</span><span class="p">,</span>
              <span class="n">PyTango</span><span class="o">.</span><span class="n">SPECTRUM</span><span class="p">,</span>
              <span class="n">PyTango</span><span class="o">.</span><span class="n">READ</span><span class="p">,</span> <span class="mi">4096</span><span class="p">],</span>
             <span class="p">{</span>
                <span class="s1">&#39;label&#39;</span><span class="p">:</span> <span class="s2">&quot;Experiment channel list&quot;</span><span class="p">,</span>
                <span class="s1">&#39;description&#39;</span><span class="p">:</span> <span class="s2">&quot;The list of experiment channels (a JSON encoded dict)&quot;</span><span class="p">,</span>
            <span class="p">}],</span>
        <span class="s1">&#39;AcqChannelList&#39;</span><span class="p">:</span>
            <span class="p">[[</span><span class="n">PyTango</span><span class="o">.</span><span class="n">DevString</span><span class="p">,</span>
              <span class="n">PyTango</span><span class="o">.</span><span class="n">SPECTRUM</span><span class="p">,</span>
              <span class="n">PyTango</span><span class="o">.</span><span class="n">READ</span><span class="p">,</span> <span class="mi">4096</span><span class="p">],</span>
             <span class="p">{</span>
                <span class="s1">&#39;label&#39;</span><span class="p">:</span> <span class="s2">&quot;Acquisition channel list&quot;</span><span class="p">,</span>
                <span class="s1">&#39;description&#39;</span><span class="p">:</span> <span class="s2">&quot;The list of all acquisition channels (a JSON encoded dict)&quot;</span><span class="p">,</span>
            <span class="p">}],</span>
        <span class="s1">&#39;MotorGroupList&#39;</span><span class="p">:</span>
            <span class="p">[[</span><span class="n">PyTango</span><span class="o">.</span><span class="n">DevString</span><span class="p">,</span>
              <span class="n">PyTango</span><span class="o">.</span><span class="n">SPECTRUM</span><span class="p">,</span>
              <span class="n">PyTango</span><span class="o">.</span><span class="n">READ</span><span class="p">,</span> <span class="mi">4096</span><span class="p">],</span>
             <span class="p">{</span>
                <span class="s1">&#39;label&#39;</span><span class="p">:</span> <span class="s2">&quot;Motor group list&quot;</span><span class="p">,</span>
                <span class="s1">&#39;description&#39;</span><span class="p">:</span> <span class="s2">&quot;the list of motor groups (a JSON encoded dict)&quot;</span><span class="p">,</span>
            <span class="p">}],</span>
        <span class="s1">&#39;ControllerLibList&#39;</span><span class="p">:</span>
            <span class="p">[[</span><span class="n">PyTango</span><span class="o">.</span><span class="n">DevString</span><span class="p">,</span>
              <span class="n">PyTango</span><span class="o">.</span><span class="n">SPECTRUM</span><span class="p">,</span>
              <span class="n">PyTango</span><span class="o">.</span><span class="n">READ</span><span class="p">,</span> <span class="mi">4096</span><span class="p">],</span>
             <span class="p">{</span>
                <span class="s1">&#39;label&#39;</span><span class="p">:</span> <span class="s2">&quot;Controller library list&quot;</span><span class="p">,</span>
                <span class="s1">&#39;description&#39;</span><span class="p">:</span> <span class="s2">&quot;the list of controller libraries (a JSON encoded dict)&quot;</span><span class="p">,</span>
            <span class="p">}],</span>
        <span class="s1">&#39;ControllerClassList&#39;</span><span class="p">:</span>
            <span class="p">[[</span><span class="n">PyTango</span><span class="o">.</span><span class="n">DevString</span><span class="p">,</span>
              <span class="n">PyTango</span><span class="o">.</span><span class="n">SPECTRUM</span><span class="p">,</span>
              <span class="n">PyTango</span><span class="o">.</span><span class="n">READ</span><span class="p">,</span> <span class="mi">4096</span><span class="p">],</span>
             <span class="p">{</span>
                <span class="s1">&#39;label&#39;</span><span class="p">:</span> <span class="s2">&quot;Controller class list&quot;</span><span class="p">,</span>
                <span class="s1">&#39;description&#39;</span><span class="p">:</span> <span class="s2">&quot;the list of controller classes (a JSON encoded dict)&quot;</span><span class="p">,</span>
            <span class="p">}],</span>
        <span class="s1">&#39;MotorList&#39;</span><span class="p">:</span>
            <span class="p">[[</span><span class="n">PyTango</span><span class="o">.</span><span class="n">DevString</span><span class="p">,</span>
              <span class="n">PyTango</span><span class="o">.</span><span class="n">SPECTRUM</span><span class="p">,</span>
              <span class="n">PyTango</span><span class="o">.</span><span class="n">READ</span><span class="p">,</span> <span class="mi">4096</span><span class="p">],</span>
             <span class="p">{</span>
                <span class="s1">&#39;label&#39;</span><span class="p">:</span> <span class="s2">&quot;Motor list&quot;</span><span class="p">,</span>
                <span class="s1">&#39;description&#39;</span><span class="p">:</span> <span class="s2">&quot;the list of motors (a JSON encoded dict)&quot;</span><span class="p">,</span>
            <span class="p">}],</span>
        <span class="s1">&#39;TriggerGateList&#39;</span><span class="p">:</span>
            <span class="p">[[</span><span class="n">PyTango</span><span class="o">.</span><span class="n">DevString</span><span class="p">,</span>
              <span class="n">PyTango</span><span class="o">.</span><span class="n">SPECTRUM</span><span class="p">,</span>
              <span class="n">PyTango</span><span class="o">.</span><span class="n">READ</span><span class="p">,</span> <span class="mi">4096</span><span class="p">],</span>
             <span class="p">{</span>
                <span class="s1">&#39;label&#39;</span><span class="p">:</span> <span class="s2">&quot;TriggerGate list&quot;</span><span class="p">,</span>
                <span class="s1">&#39;description&#39;</span><span class="p">:</span> <span class="s2">&quot;the list of trigger/gates (a JSON encoded dict)&quot;</span><span class="p">,</span>
            <span class="p">}],</span>
        <span class="s1">&#39;MeasurementGroupList&#39;</span><span class="p">:</span>
            <span class="p">[[</span><span class="n">PyTango</span><span class="o">.</span><span class="n">DevString</span><span class="p">,</span>
              <span class="n">PyTango</span><span class="o">.</span><span class="n">SPECTRUM</span><span class="p">,</span>
              <span class="n">PyTango</span><span class="o">.</span><span class="n">READ</span><span class="p">,</span> <span class="mi">4096</span><span class="p">],</span>
             <span class="p">{</span>
                <span class="s1">&#39;label&#39;</span><span class="p">:</span> <span class="s2">&quot;Measurement group list&quot;</span><span class="p">,</span>
                <span class="s1">&#39;description&#39;</span><span class="p">:</span> <span class="s2">&quot;the list of measurement groups (a JSON encoded dict)&quot;</span><span class="p">,</span>
            <span class="p">}],</span>
        <span class="s1">&#39;IORegisterList&#39;</span><span class="p">:</span>
            <span class="p">[[</span><span class="n">PyTango</span><span class="o">.</span><span class="n">DevString</span><span class="p">,</span>
              <span class="n">PyTango</span><span class="o">.</span><span class="n">SPECTRUM</span><span class="p">,</span>
              <span class="n">PyTango</span><span class="o">.</span><span class="n">READ</span><span class="p">,</span> <span class="mi">4096</span><span class="p">],</span>
             <span class="p">{</span>
                <span class="s1">&#39;label&#39;</span><span class="p">:</span> <span class="s2">&quot;IORegister list&quot;</span><span class="p">,</span>
                <span class="s1">&#39;description&#39;</span><span class="p">:</span> <span class="s2">&quot;the list of IORegisters (a JSON encoded dict)&quot;</span><span class="p">,</span>
            <span class="p">}],</span>
        <span class="s1">&#39;ComChannelList&#39;</span><span class="p">:</span>
            <span class="p">[[</span><span class="n">PyTango</span><span class="o">.</span><span class="n">DevString</span><span class="p">,</span>
              <span class="n">PyTango</span><span class="o">.</span><span class="n">SPECTRUM</span><span class="p">,</span>
              <span class="n">PyTango</span><span class="o">.</span><span class="n">READ</span><span class="p">,</span> <span class="mi">4096</span><span class="p">],</span>
             <span class="p">{</span>
                <span class="s1">&#39;label&#39;</span><span class="p">:</span> <span class="s2">&quot;Communication channel list&quot;</span><span class="p">,</span>
                <span class="s1">&#39;description&#39;</span><span class="p">:</span> <span class="s2">&quot;the list of communication channels (a JSON encoded dict)&quot;</span><span class="p">,</span>
            <span class="p">}],</span>
        <span class="s1">&#39;Elements&#39;</span><span class="p">:</span>
            <span class="p">[[</span><span class="n">PyTango</span><span class="o">.</span><span class="n">DevEncoded</span><span class="p">,</span>
              <span class="n">PyTango</span><span class="o">.</span><span class="n">SCALAR</span><span class="p">,</span>
              <span class="n">PyTango</span><span class="o">.</span><span class="n">READ</span><span class="p">],</span>
             <span class="p">{</span>
                <span class="s1">&#39;label&#39;</span><span class="p">:</span> <span class="s2">&quot;Elements&quot;</span><span class="p">,</span>
                <span class="s1">&#39;description&#39;</span><span class="p">:</span> <span class="s2">&quot;the list of all elements (a JSON encoded dict)&quot;</span><span class="p">,</span>
            <span class="p">}],</span>
    <span class="p">}</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
        <span class="n">PyTango</span><span class="o">.</span><span class="n">DeviceClass</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_type</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_get_class_properties</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">dict</span><span class="p">(</span><span class="n">ProjectTitle</span><span class="o">=</span><span class="s2">&quot;Sardana&quot;</span><span class="p">,</span> <span class="n">Description</span><span class="o">=</span><span class="s2">&quot;Device Pool management class&quot;</span><span class="p">,</span>
                    <span class="n">doc_url</span><span class="o">=</span><span class="s2">&quot;http://sardana-controls.org/&quot;</span><span class="p">,</span>
                    <span class="n">InheritedFrom</span><span class="o">=</span><span class="s2">&quot;Device_4Impl&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">write_class_property</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">util</span> <span class="o">=</span> <span class="n">PyTango</span><span class="o">.</span><span class="n">Util</span><span class="o">.</span><span class="n">instance</span><span class="p">()</span>
        <span class="n">db</span> <span class="o">=</span> <span class="n">util</span><span class="o">.</span><span class="n">get_database</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">db</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="n">db</span><span class="o">.</span><span class="n">put_class_property</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_name</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_class_properties</span><span class="p">())</span></div>
</pre></div>

           </div>
           
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright Except where otherwise noted, content on this site is
licensed under a Creative Commons Attribution 3.0 License

    </p>
  </div>
    
    
    
    Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>